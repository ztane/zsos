<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="CreationDate" content="D:20030117141140"><meta name="Producer" content="Acrobat PDFWriter 4.0 for Windows NT"><title>Working T13 Draft 1510D</title></head><body bgcolor="#ffffff" link="blue" vlink="blue"><table border="1" width="100%"><tbody><tr><td><table color="#ffffff" bgcolor="#ffffff" border="1" cellpadding="10" cellspacing="0" width="100%"><tbody><tr><td><font color="black" face="arial,sans-serif" size="-1">This is the html version of the file <a href="http://www.t13.org/project/d1510r1-Host-Adapter.pdf"><font color="blue">http://www.t13.org/project/d1510r1-Host-Adapter.pdf</font></a>.<br> <b><font color="#0039b6">G</font> <font color="#c41200">o</font> <font color="#f3c518">o</font> <font color="#0039b6">g</font> <font color="#30a72f">l</font> <font color="#c41200">e</font></b> automatically generates html versions of documents as we crawl the web.<br>To link to or bookmark this page, use the following url: <code>http://www.google.com/search?q=cache:4nzmxhKxG30J:www.t13.org/project/d1510r1-Host-Adapter.pdf+d1510r1-Host-Adapter.pdf&amp;hl=en&amp;ct=clnk&amp;cd=1</code></font><br><br><center><font size="-2"><i>Google is neither affiliated with the authors of this page nor responsible for its content.</i></font></center></td></tr>
<tr><td>
<font color="black" face="arial,sans-serif" size="-1">These terms only appear in links pointing to this page: <b>d1510r1 host adapter pdf </b></font>
</td></tr></tbody></table></td></tr></tbody></table>
<hr>







<table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="1"><b>Page 1</b></a></font></td></tr></tbody></table><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 229px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
</span></font>
<font face="Times" size="4"><span style="font-size: 28px; font-family: Times;">
<div style="position: absolute; top: 251px; left: 87px;"><nobr><b>Working</b></nobr></div>
<div style="position: absolute; top: 251px; left: 721px;"><nobr><b>T13</b></nobr></div>
<div style="position: absolute; top: 287px; left: 87px;"><nobr><b>Draft</b></nobr></div>
<div style="position: absolute; top: 287px; left: 685px;"><nobr><b>1510D</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 341px; left: 690px;"><nobr><b>Revision 1.0</b></nobr></div>
<div style="position: absolute; top: 359px; left: 664px;"><nobr>January 17, 2003</nobr></div>
</span></font>
<font face="Times" size="4"><span style="font-size: 25px; font-family: Times;">
<div style="position: absolute; top: 401px; left: 123px;"><nobr><b>ATA/ATAPI Host Adapters Standard (ATA – Adapter)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 553px; left: 87px;"><nobr>This is an internal working document of T13, a Technical Committee of Accredited Standards Committee </nobr></div>
<div style="position: absolute; top: 570px; left: 87px;"><nobr>INCITS.  The T13 Technical Committee may modify the contents. This document is made available for review </nobr></div>
<div style="position: absolute; top: 588px; left: 87px;"><nobr>and comment only.</nobr></div>
<div style="position: absolute; top: 623px; left: 87px;"><nobr>Permission is granted to members of INCITS, its technical committees, and their associated task groups to </nobr></div>
<div style="position: absolute; top: 640px; left: 87px;"><nobr>reproduce this document for the purposes of INCITS standardization activities without further permission, </nobr></div>
<div style="position: absolute; top: 658px; left: 87px;"><nobr>provided this notice is included.  All other rights are reserved. Any commercial or for-profit replication or </nobr></div>
<div style="position: absolute; top: 675px; left: 87px;"><nobr>republication is prohibited.</nobr></div>
<div style="position: absolute; top: 737px; left: 87px;"><nobr>T13 Technical Editor:</nobr></div>
<div style="position: absolute; top: 755px; left: 465px;"><nobr>Tony Goodfellow </nobr></div>
<div style="position: absolute; top: 772px; left: 465px;"><nobr>Pacific Digital Corporation </nobr></div>
<div style="position: absolute; top: 788px; left: 465px;"><nobr>2052 Alton Parkway</nobr></div>
<div style="position: absolute; top: 806px; left: 465px;"><nobr>Irvine, CA92602 </nobr></div>
<div style="position: absolute; top: 823px; left: 465px;"><nobr>USA </nobr></div>
<div style="position: absolute; top: 840px; left: 465px;"><nobr>Tel:     949-252-1111 </nobr></div>
<div style="position: absolute; top: 858px; left: 465px;"><nobr>Fax:    949-252-9397</nobr></div>
<div style="position: absolute; top: 875px; left: 465px;"><nobr>Email: tgoodfellow@pacificdigital.com </nobr></div>
</span></font>

<div style="position: absolute; top: 1363px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="2"><b>Page 2</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 1466px; left: 87px;"><nobr>Other Points of Contact:</nobr></div>
<div style="position: absolute; top: 1493px; left: 87px;"><nobr>T13 Chair</nobr></div>
<div style="position: absolute; top: 1493px; left: 303px;"><nobr>T13 Vicechair</nobr></div>
<div style="position: absolute; top: 1510px; left: 87px;"><nobr>Pete McLean</nobr></div>
<div style="position: absolute; top: 1510px; left: 303px;"><nobr>Dan Colegrove</nobr></div>
<div style="position: absolute; top: 1526px; left: 87px;"><nobr>Maxtor Corporation</nobr></div>
<div style="position: absolute; top: 1526px; left: 303px;"><nobr>IBM Corporation</nobr></div>
<div style="position: absolute; top: 1544px; left: 87px;"><nobr>2452 Clover Basin Drive</nobr></div>
<div style="position: absolute; top: 1544px; left: 303px;"><nobr>2903 Carmelo Drive</nobr></div>
<div style="position: absolute; top: 1561px; left: 87px;"><nobr>Longmont, CO 80501</nobr></div>
<div style="position: absolute; top: 1561px; left: 303px;"><nobr>Henderson, NV 89052</nobr></div>
<div style="position: absolute; top: 1578px; left: 87px;"><nobr>Tel:</nobr></div>
<div style="position: absolute; top: 1578px; left: 129px;"><nobr>303-678-2149</nobr></div>
<div style="position: absolute; top: 1578px; left: 303px;"><nobr>Tel:</nobr></div>
<div style="position: absolute; top: 1578px; left: 345px;"><nobr>702 614-6119</nobr></div>
<div style="position: absolute; top: 1596px; left: 87px;"><nobr>Fax: 303-682-4811</nobr></div>
<div style="position: absolute; top: 1596px; left: 303px;"><nobr>Fax: 702 614-7995</nobr></div>
<div style="position: absolute; top: 1622px; left: 87px;"><nobr>INCITS Secretariat</nobr></div>
<div style="position: absolute; top: 1639px; left: 87px;"><nobr>Administrator Standards Processing</nobr></div>
<div style="position: absolute; top: 1657px; left: 87px;"><nobr>1250 Eye Street, NW Suite 200</nobr></div>
<div style="position: absolute; top: 1674px; left: 87px;"><nobr>Washington, DC 20005</nobr></div>
<div style="position: absolute; top: 1691px; left: 87px;"><nobr>Tel:</nobr></div>
<div style="position: absolute; top: 1691px; left: 129px;"><nobr>202-737-8888</nobr></div>
<div style="position: absolute; top: 1709px; left: 87px;"><nobr>Fax: 202-638-4922</nobr></div>
<div style="position: absolute; top: 1726px; left: 87px;"><nobr>Email:  INCITS@ITIC.ORG</nobr></div>
<div style="position: absolute; top: 1751px; left: 87px;"><nobr>T13 Reflector</nobr></div>
<div style="position: absolute; top: 1769px; left: 87px;"><nobr>Internet address for subscription to the T13 reflector: majordomo@t13.org</nobr></div>
<div style="position: absolute; top: 1786px; left: 87px;"><nobr>Send email to above account and include in BODY of text, on a line by itself the following: </nobr></div>
<div style="position: absolute; top: 1803px; left: 108px;"><nobr>"subscribe T13"</nobr></div>
<div style="position: absolute; top: 1821px; left: 87px;"><nobr>Internet address for unsubscribing to the T13 reflector: majordomo@t13.org</nobr></div>
<div style="position: absolute; top: 1838px; left: 87px;"><nobr>Send email to above account and include in BODY of text, on a line by itself the following: </nobr></div>
<div style="position: absolute; top: 1855px; left: 108px;"><nobr>"unsubscribe T13"</nobr></div>
<div style="position: absolute; top: 1882px; left: 87px;"><nobr>Internet address for distribution via T13 reflector: T13@t13.org</nobr></div>
<div style="position: absolute; top: 1908px; left: 87px;"><nobr>T13 Web Site</nobr></div>
<div style="position: absolute; top: 1934px; left: 87px;"><nobr>http://www.t13.org</nobr></div>
<div style="position: absolute; top: 1961px; left: 87px;"><nobr>T13 Anonymous FTP Site</nobr></div>
<div style="position: absolute; top: 1987px; left: 87px;"><nobr>ftp.t13.org</nobr></div>
<div style="position: absolute; top: 2012px; left: 87px;"><nobr>T13 mailings</nobr></div>
<div style="position: absolute; top: 2038px; left: 87px;"><nobr>Global Engineering</nobr></div>
<div style="position: absolute; top: 2056px; left: 87px;"><nobr>15 Inverness Way East</nobr></div>
<div style="position: absolute; top: 2073px; left: 87px;"><nobr>Englewood, CO   80112-5704</nobr></div>
<div style="position: absolute; top: 2090px; left: 87px;"><nobr>Tel:</nobr></div>
<div style="position: absolute; top: 2090px; left: 129px;"><nobr>303-792-2181 or  800-854-7179</nobr></div>
<div style="position: absolute; top: 2108px; left: 87px;"><nobr>Fax: 303-792-2192</nobr></div>
</span></font>

<div style="position: absolute; top: 2551px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="3"><b>Page 3</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 2605px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 2627px; left: 87px;"><nobr><b>DOCUMENT STATUS</b></nobr></div>
<div style="position: absolute; top: 2663px; left: 87px;"><nobr>Revision 0 – 20 October 2000</nobr></div>
<div style="position: absolute; top: 2680px; left: 87px;"><nobr>Document created.</nobr></div>
<div style="position: absolute; top: 2696px; left: 87px;"><nobr>Revision 0a - 7 August 2001</nobr></div>
<div style="position: absolute; top: 2714px; left: 87px;"><nobr>Added new description of ADMA mode.</nobr></div>
<div style="position: absolute; top: 2731px; left: 87px;"><nobr>Revision 0b – 23 October 2001</nobr></div>
<div style="position: absolute; top: 2748px; left: 87px;"><nobr>Made editorial corrections and removed descriptive elements not compatible with a standard.</nobr></div>
<div style="position: absolute; top: 2766px; left: 87px;"><nobr>Revision 0c – 7 December 2001</nobr></div>
<div style="position: absolute; top: 2783px; left: 87px;"><nobr>Editorial changes from editorial review at October 2001 plenary meeting.</nobr></div>
<div style="position: absolute; top: 2800px; left: 87px;"><nobr>Revision 0d – February 25, 2002</nobr></div>
<div style="position: absolute; top: 2818px; left: 87px;"><nobr>Editorial changes resulting from December 2001 plenary</nobr></div>
<div style="position: absolute; top: 2835px; left: 87px;"><nobr>Revision 0e – June 1, 2002</nobr></div>
<div style="position: absolute; top: 2852px; left: 87px;"><nobr>Editorial changes resulting from February 2002 plenary.</nobr></div>
<div style="position: absolute; top: 2870px; left: 87px;"><nobr>Revision 0f - August 7, 2002</nobr></div>
<div style="position: absolute; top: 2887px; left: 87px;"><nobr>Editorial changes resulting from June plenary meeting</nobr></div>
<div style="position: absolute; top: 2903px; left: 87px;"><nobr>Revision 0g – August 21, 2002</nobr></div>
<div style="position: absolute; top: 2921px; left: 87px;"><nobr>This major revision implements comments from the line by line review conducted at the plenary meeting</nobr></div>
</span></font>

<div style="position: absolute; top: 3739px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="4"><b>Page 4</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 3866px; left: 780px;"><nobr><b>ANSI</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 10px; font-family: Times;">
<div style="position: absolute; top: 3863px; left: 822px;"><nobr><b>®</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 3887px; left: 701px;"><nobr><b>INCITS.***-xxxx</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 19px; font-family: Times;">
<div style="position: absolute; top: 4011px; left: 569px;"><nobr>American National Standard</nobr></div>
<div style="position: absolute; top: 4036px; left: 577px;"><nobr>for Information Systems <font face="Symbol">?</font></nobr></div>
</span></font>
<font face="Times" size="4"><span style="font-size: 25px; font-family: Times;">
<div style="position: absolute; top: 4115px; left: 159px;"><nobr><b>ATA/ATAPI Host Adapters Standard (ATA – Adapter)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 4321px; left: 87px;"><nobr>Secretariat</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 4337px; left: 87px;"><nobr><b>Information Technology Industry Council</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 4458px; left: 87px;"><nobr>Approved mm dd yy</nobr></div>
<div style="position: absolute; top: 4490px; left: 87px;"><nobr><b>American National Standards Institute, Inc.</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 4633px; left: 87px;"><nobr><b>Abstract</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 4675px; left: 87px;"><nobr>This standard specifies the Host System Interface used to control AT Attachment Interface devices.  It provides </nobr></div>
<div style="position: absolute; top: 4692px; left: 87px;"><nobr>a common Programming interface for systems manufacturers, system integrators, software suppliers, and </nobr></div>
<div style="position: absolute; top: 4709px; left: 87px;"><nobr>suppliers of intelligent storage devices. </nobr></div>
</span></font>

<div style="position: absolute; top: 4927px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="5"><b>Page 5</b></a></font></td></tr></tbody></table></div><font face="Times" size="4"><span style="font-size: 21px; font-family: Times;">
<div style="position: absolute; top: 5020px; left: 87px;"><nobr><b>American</b></nobr></div>
<div style="position: absolute; top: 5047px; left: 87px;"><nobr><b>National</b></nobr></div>
<div style="position: absolute; top: 5075px; left: 87px;"><nobr><b>Standard</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 5021px; left: 257px;"><nobr>Approval of an American National Standard requires verification by ANSI that the </nobr></div>
<div style="position: absolute; top: 5038px; left: 257px;"><nobr>requirements for due process, consensus, and other criteria for approval have </nobr></div>
<div style="position: absolute; top: 5054px; left: 257px;"><nobr>been met by the standards developer. Consensus is established when, in the </nobr></div>
<div style="position: absolute; top: 5072px; left: 257px;"><nobr>judgment of the ANSI Board of Standards Review, substantial agreement has been </nobr></div>
<div style="position: absolute; top: 5089px; left: 257px;"><nobr>reached by directly and materially affected interests. Substantial agreement means </nobr></div>
<div style="position: absolute; top: 5106px; left: 257px;"><nobr>much more than a simple majority, but not necessarily unanimity. Consensus </nobr></div>
<div style="position: absolute; top: 5124px; left: 257px;"><nobr>requires that all views and objections be considered, and that effort be made </nobr></div>
<div style="position: absolute; top: 5141px; left: 257px;"><nobr>towards their resolution.</nobr></div>
<div style="position: absolute; top: 5176px; left: 257px;"><nobr>The use of American National Standards is completely voluntary; their existence </nobr></div>
<div style="position: absolute; top: 5193px; left: 257px;"><nobr>does not in any respect preclude anyone, whether he has approved the standards </nobr></div>
<div style="position: absolute; top: 5210px; left: 257px;"><nobr>or not, from manufacturing, marketing, purchasing, or using products, processes, </nobr></div>
<div style="position: absolute; top: 5228px; left: 257px;"><nobr>or procedures not conforming to the standards.</nobr></div>
<div style="position: absolute; top: 5261px; left: 257px;"><nobr>The American National Standards Institute does not develop standards and will in </nobr></div>
<div style="position: absolute; top: 5279px; left: 257px;"><nobr>no circumstances give interpretation on any American National Standard. </nobr></div>
<div style="position: absolute; top: 5296px; left: 257px;"><nobr>Moreover, no person shall have the right or authority to issue an interpretation of </nobr></div>
<div style="position: absolute; top: 5313px; left: 257px;"><nobr>an American National Standard in the name of the American National Standards </nobr></div>
<div style="position: absolute; top: 5331px; left: 257px;"><nobr>Institute. Requests for interpretations should be addressed to the secretariat or </nobr></div>
<div style="position: absolute; top: 5348px; left: 257px;"><nobr>sponsor whose name appears on the title page of this standard.</nobr></div>
<div style="position: absolute; top: 5383px; left: 257px;"><nobr><b>CAUTION NOTICE: </b>This American National Standard may be revised or </nobr></div>
<div style="position: absolute; top: 5400px; left: 257px;"><nobr>withdrawn at any time. The procedures of the American National Standards </nobr></div>
<div style="position: absolute; top: 5417px; left: 257px;"><nobr>Institute require that action be taken periodically to reaffirm, revise, or withdraw this </nobr></div>
<div style="position: absolute; top: 5435px; left: 257px;"><nobr>standard. Purchasers of American National Standards may receive current </nobr></div>
<div style="position: absolute; top: 5452px; left: 257px;"><nobr>information on all standards by calling or writing the American National Standards </nobr></div>
<div style="position: absolute; top: 5468px; left: 257px;"><nobr>Institute.</nobr></div>
<div style="position: absolute; top: 5533px; left: 135px;"><nobr>CAUTION: The developers of this standard have requested that holders of patents that may be </nobr></div>
<div style="position: absolute; top: 5550px; left: 135px;"><nobr>required for the implementation of the standard, disclose such patents to the publisher.  However, </nobr></div>
<div style="position: absolute; top: 5567px; left: 135px;"><nobr>neither  the  developers  nor  the  publisher  have  undertaken  a  patent search in order to identify </nobr></div>
<div style="position: absolute; top: 5584px; left: 135px;"><nobr>which, if any, patents may apply to this standard.</nobr></div>
<div style="position: absolute; top: 5619px; left: 135px;"><nobr>As of the date of publication of this standard and following calls for the identification of patents that </nobr></div>
<div style="position: absolute; top: 5636px; left: 135px;"><nobr>may be required for the implementation of the standard, notice of  one or more such claims has </nobr></div>
<div style="position: absolute; top: 5653px; left: 135px;"><nobr>been received.</nobr></div>
<div style="position: absolute; top: 5686px; left: 135px;"><nobr>By publication of this standard, no position is taken with respect to the validity of this claim or of </nobr></div>
<div style="position: absolute; top: 5704px; left: 135px;"><nobr>any  rights  in  connection  therewith.  The  patent  holders  have,  however,  filed  a  statement  of </nobr></div>
<div style="position: absolute; top: 5721px; left: 135px;"><nobr>willingness to grant a license under these rights on reasonable and nondiscriminatory terms and </nobr></div>
<div style="position: absolute; top: 5738px; left: 135px;"><nobr>conditions  to  applicants  desiring  to  obtain  such  a  license.  Details  may  be  obtained  from  the </nobr></div>
<div style="position: absolute; top: 5755px; left: 135px;"><nobr>publisher.</nobr></div>
<div style="position: absolute; top: 5789px; left: 135px;"><nobr>No further patent search is conducted by the developer or the publisher in respect to any standard </nobr></div>
<div style="position: absolute; top: 5807px; left: 135px;"><nobr>it  processes.  No  representation  is  made  or  implied  that  licenses  are  not  required  to  avoid </nobr></div>
<div style="position: absolute; top: 5824px; left: 135px;"><nobr>infringement in the use of this standard.</nobr></div>
<div style="position: absolute; top: 5886px; left: 87px;"><nobr>Published by</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 5903px; left: 87px;"><nobr><b>American National Standards Institute</b></nobr></div>
<div style="position: absolute; top: 5923px; left: 87px;"><nobr><b>11 West 42nd Street, New York, New York  10036</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 5962px; left: 87px;"><nobr>Copyright nnnn by American National Standards Institute</nobr></div>
<div style="position: absolute; top: 5979px; left: 87px;"><nobr>All rights reserved.</nobr></div>
</span></font>

<div style="position: absolute; top: 6115px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="6"><b>Page 6</b></a></font></td></tr></tbody></table></div>
<div style="position: absolute; top: 6115px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="7"><b>Page 7</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 7254px; left: 87px;"><nobr>Page i</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 6190px; left: 420px;"><nobr><b>Contents</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 6217px; left: 87px;"><nobr>Introduction.................................................................................................................................................vii</nobr></div>
<div style="position: absolute; top: 6242px; left: 87px;"><nobr>1 Scope
.......................................................................................................................................................1</nobr></div>
<div style="position: absolute; top: 6268px; left: 87px;"><nobr>2
Normative References
...............................................................................................................................1</nobr></div>
<div style="position: absolute; top: 6291px; left: 87px;"><nobr>2.1
Content Imported from Normative Standards
............................................................................................1</nobr></div>
<div style="position: absolute; top: 6308px; left: 87px;"><nobr>2.2
Industry Standard
References..................................................................................................................1</nobr></div>
<div style="position: absolute; top: 6329px; left: 87px;"><nobr>3
Definitions, Abbreviations, and Conventions
................................................................................................2</nobr></div>
<div style="position: absolute; top: 6352px; left: 87px;"><nobr>3.1
Definitions and
Abbreviations...................................................................................................................2</nobr></div>
<div style="position: absolute; top: 6368px; left: 87px;"><nobr>3.2
Conventions
...........................................................................................................................................5</nobr></div>
<div style="position: absolute; top: 6390px; left: 87px;"><nobr>4 ATA
Host Adapters
....................................................................................................................................7</nobr></div>
<div style="position: absolute; top: 6412px; left: 87px;"><nobr>4.1
Adapter Types
........................................................................................................................................7</nobr></div>
<div style="position: absolute; top: 6429px; left: 87px;"><nobr>4.2
Adapter Modes
.......................................................................................................................................7</nobr></div>
<div style="position: absolute; top: 6451px; left: 87px;"><nobr>5 ISA
Bus
Adapter........................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6473px; left: 87px;"><nobr>5.1
Mode of
Operation..................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6490px; left: 87px;"><nobr>5.2
Detection................................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6507px; left: 87px;"><nobr>5.3
Adapter Set Up
.......................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6525px; left: 87px;"><nobr>5.4 ATA
Bus Timings
....................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6542px; left: 87px;"><nobr>5.5
Electrical and Physical
............................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6559px; left: 87px;"><nobr>5.6
Registers................................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6581px; left: 87px;"><nobr>6 PCI
Compatibility and PCI-Native Mode Bus Master Adapters
......................................................................8</nobr></div>
<div style="position: absolute; top: 6602px; left: 87px;"><nobr>6.1
Mode of
Operation..................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6619px; left: 87px;"><nobr>6.2
Detection................................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6637px; left: 87px;"><nobr>6.3
Adapter Set Up
.......................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6654px; left: 87px;"><nobr>6.4 ATA
Bus Timings
....................................................................................................................................8</nobr></div>
<div style="position: absolute; top: 6671px; left: 87px;"><nobr>6.5
Electrical and Physical
............................................................................................................................9</nobr></div>
<div style="position: absolute; top: 6689px; left: 87px;"><nobr>6.6 PCI
Registers
.........................................................................................................................................9</nobr></div>
<div style="position: absolute; top: 6706px; left: 87px;"><nobr>6.7 ATA
Bus Master
Registers.....................................................................................................................11</nobr></div>
<div style="position: absolute; top: 6723px; left: 87px;"><nobr>6.8
Interrupt Line Considerations
.................................................................................................................14</nobr></div>
<div style="position: absolute; top: 6741px; left: 87px;"><nobr>6.9 Bus
Master Operation
...........................................................................................................................15</nobr></div>
<div style="position: absolute; top: 6762px; left: 87px;"><nobr>7 Automatic Direct Memory Access (ADMA) Adaptors - General Description..................................................16</nobr></div>
<div style="position: absolute; top: 6784px; left: 87px;"><nobr>7.1
Background
..........................................................................................................................................16</nobr></div>
<div style="position: absolute; top: 6802px; left: 87px;"><nobr>7.2 The
ADMA Engine
................................................................................................................................16</nobr></div>
<div style="position: absolute; top: 6818px; left: 87px;"><nobr>7.3
ADMA Overview
...................................................................................................................................18</nobr></div>
<div style="position: absolute; top: 6835px; left: 87px;"><nobr>7.4
ADMA PCI
Registers.............................................................................................................................22</nobr></div>
<div style="position: absolute; top: 6853px; left: 87px;"><nobr>7.5
ADMA Registers
...................................................................................................................................31</nobr></div>
<div style="position: absolute; top: 6870px; left: 87px;"><nobr>7.6
Auto DMA Mode Data Structures
...........................................................................................................37</nobr></div>
<div style="position: absolute; top: 6887px; left: 87px;"><nobr>7.7
ADMA
Operation...................................................................................................................................44</nobr></div>
<div style="position: absolute; top: 6905px; left: 87px;"><nobr>7.8
Host Operation
.....................................................................................................................................48</nobr></div>
<div style="position: absolute; top: 6922px; left: 87px;"><nobr>7.9
Resets
.................................................................................................................................................50</nobr></div>
</span></font>

<div style="position: absolute; top: 7303px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="8"><b>Page 8</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 8442px; left: 690px;"><nobr>Page ii</nobr></div>
<div style="position: absolute; top: 7388px; left: 435px;"><nobr><b>Tables</b></nobr></div>
<div style="position: absolute; top: 7415px; left: 87px;"><nobr>Table 1
– Compatibility Mode Standard I/O Register Addresses
......................................................................7</nobr></div>
<div style="position: absolute; top: 7432px; left: 87px;"><nobr>Table 2 – PCI Compatibility and PCI-Native Mode Bus Master Adapters Configuration Registers ......................9</nobr></div>
<div style="position: absolute; top: 7448px; left: 87px;"><nobr>Table 3 – PCI Compatibility and PCI-Native Mode Bus Master Adapters Class Code Registers .........................9</nobr></div>
<div style="position: absolute; top: 7466px; left: 87px;"><nobr>Table 4
– PCI Adapter bit definitions in Programming Interface
Byte..............................................................10</nobr></div>
<div style="position: absolute; top: 7483px; left: 87px;"><nobr>Table 5
– ATA Bus Master Register Offsets
.................................................................................................12</nobr></div>
<div style="position: absolute; top: 7500px; left: 87px;"><nobr>Table 6
– ATA Bus Master Command
Register.............................................................................................13</nobr></div>
<div style="position: absolute; top: 7518px; left: 87px;"><nobr>Table 7
– Bus Master ATA Status
Register...................................................................................................13</nobr></div>
<div style="position: absolute; top: 7535px; left: 87px;"><nobr>Table 8
– PRD Table Pointer Register
.........................................................................................................14</nobr></div>
<div style="position: absolute; top: 7552px; left: 87px;"><nobr>Table 9
– Physical Region Descriptor Table
Entry.........................................................................................15</nobr></div>
<div style="position: absolute; top: 7570px; left: 87px;"><nobr>Table
10 – Adapter Bus Master Status Register bits
.....................................................................................16</nobr></div>
<div style="position: absolute; top: 7587px; left: 87px;"><nobr>Table
11 – ADMA PCI Configuration Space Header
Registers.......................................................................22</nobr></div>
<div style="position: absolute; top: 7604px; left: 87px;"><nobr>Table
12 – ADMA PCI Command
Register...................................................................................................23</nobr></div>
<div style="position: absolute; top: 7622px; left: 87px;"><nobr>Table
13 – ADMA PCI Status
Register.........................................................................................................24</nobr></div>
<div style="position: absolute; top: 7639px; left: 87px;"><nobr>Table
14 – ADMA PCI Class Code
..............................................................................................................24</nobr></div>
<div style="position: absolute; top: 7655px; left: 87px;"><nobr>Table
15 – ADMA Power Management Registers
.........................................................................................28</nobr></div>
<div style="position: absolute; top: 7673px; left: 87px;"><nobr>Table
16 – ADMA Power Management Capability Register
...........................................................................29</nobr></div>
<div style="position: absolute; top: 7690px; left: 87px;"><nobr>Table 17 – ADMA Power Management Control/Status Register .....................................................................29</nobr></div>
<div style="position: absolute; top: 7707px; left: 87px;"><nobr>Table
18 – ADMA Power Management State Control
bits..............................................................................29</nobr></div>
<div style="position: absolute; top: 7725px; left: 87px;"><nobr>Table
19 – ADMA Memory Mapped Registers
..............................................................................................32</nobr></div>
<div style="position: absolute; top: 7742px; left: 87px;"><nobr>Table
20 – ADMA Control Register
..............................................................................................................34</nobr></div>
<div style="position: absolute; top: 7759px; left: 87px;"><nobr>Table
21 – ADMA Status Register
...............................................................................................................35</nobr></div>
<div style="position: absolute; top: 7777px; left: 87px;"><nobr>Table
22 – CPB Structure
...........................................................................................................................38</nobr></div>
<div style="position: absolute; top: 7794px; left: 87px;"><nobr>Table
23 – ATA Register
Field.....................................................................................................................41</nobr></div>
<div style="position: absolute; top: 7811px; left: 87px;"><nobr>Table
24 – APRD Data
Structure.................................................................................................................42</nobr></div>
<div style="position: absolute; top: 7829px; left: 87px;"><nobr>Table
25 – PCI Configuration Registers
.......................................................................................................54</nobr></div>
<div style="position: absolute; top: 7846px; left: 87px;"><nobr>Table
26 – ATA Timing
Register..................................................................................................................55</nobr></div>
<div style="position: absolute; top: 7862px; left: 87px;"><nobr>Table
27 – Device 1 ATA Timing Register
....................................................................................................56</nobr></div>
<div style="position: absolute; top: 7879px; left: 87px;"><nobr>Table
28 – UDMA Control
Register..............................................................................................................57</nobr></div>
<div style="position: absolute; top: 7897px; left: 87px;"><nobr>Table
29 – UDMA Timing
Register...............................................................................................................58</nobr></div>
<div style="position: absolute; top: 7914px; left: 87px;"><nobr>Table
30 – UDMA Control
Register..............................................................................................................59</nobr></div>
<div style="position: absolute; top: 7976px; left: 432px;"><nobr><b>Figures</b></nobr></div>
<div style="position: absolute; top: 8003px; left: 87px;"><nobr>Figure 1 <font face="Symbol">? </font>State
diagram
convention..............................................................................................................6</nobr></div>
<div style="position: absolute; top: 8020px; left: 87px;"><nobr>Figure
2 – ADMA Data
Structures................................................................................................................20</nobr></div>
<div style="position: absolute; top: 8038px; left: 87px;"><nobr>Figure
3 – Power Management State
Transitions..........................................................................................30</nobr></div>
<div style="position: absolute; top: 8055px; left: 87px;"><nobr>Figure
4 – CPB States
................................................................................................................................43</nobr></div>
<div style="position: absolute; top: 8072px; left: 87px;"><nobr>Figure
5 – ADMA State Transitions
..............................................................................................................45</nobr></div>
<div style="position: absolute; top: 8090px; left: 87px;"><nobr>Figure
6 – Host Software States
..................................................................................................................48</nobr></div>
</span></font>

<div style="position: absolute; top: 8491px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="9"><b>Page 9</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 8545px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 9630px; left: 87px;"><nobr>Page iii</nobr></div>
<div style="position: absolute; top: 8567px; left: 428px;"><nobr><b>Annexes</b></nobr></div>
<div style="position: absolute; top: 8589px; left: 87px;"><nobr>Annex A
Programming Guidelines (Informative)
...........................................................................................51</nobr></div>
<div style="position: absolute; top: 8611px; left: 87px;"><nobr>A.1
Introduction
..........................................................................................................................................51</nobr></div>
<div style="position: absolute; top: 8627px; left: 87px;"><nobr>A.2
Programming the ADMA
.......................................................................................................................51</nobr></div>
<div style="position: absolute; top: 8645px; left: 87px;"><nobr>A.3
Asynchronous
Operation.......................................................................................................................51</nobr></div>
<div style="position: absolute; top: 8662px; left: 87px;"><nobr>A.4
Memory
Alignment................................................................................................................................52</nobr></div>
<div style="position: absolute; top: 8679px; left: 87px;"><nobr>A.5
Register Usage
....................................................................................................................................52</nobr></div>
<div style="position: absolute; top: 8697px; left: 87px;"><nobr>A.6 Use
of
aGO..........................................................................................................................................52</nobr></div>
<div style="position: absolute; top: 8714px; left: 87px;"><nobr>A.7
Execute Single CPB
.............................................................................................................................52</nobr></div>
<div style="position: absolute; top: 8731px; left: 87px;"><nobr>A.8
Determining the Current Status of the
ADMA..........................................................................................52</nobr></div>
<div style="position: absolute; top: 8749px; left: 87px;"><nobr>A.9
Host Pausing of the ADMA Engine
........................................................................................................52</nobr></div>
<div style="position: absolute; top: 8766px; left: 87px;"><nobr>A.10
Host Stopping or Terminating an Active
CPB........................................................................................52</nobr></div>
<div style="position: absolute; top: 8783px; left: 87px;"><nobr>A.11
ADMA
Interrupts.................................................................................................................................53</nobr></div>
<div style="position: absolute; top: 8801px; left: 87px;"><nobr>A.12
Chain Management
............................................................................................................................53</nobr></div>
<div style="position: absolute; top: 8818px; left: 87px;"><nobr>A.13
Error Handling
....................................................................................................................................53</nobr></div>
<div style="position: absolute; top: 8834px; left: 87px;"><nobr>A.14
ATAPI Data Transfers
.........................................................................................................................53</nobr></div>
<div style="position: absolute; top: 8852px; left: 87px;"><nobr>A.15
Queued Operation
..............................................................................................................................53</nobr></div>
<div style="position: absolute; top: 8874px; left: 87px;"><nobr>Annex B PCI Compatibility and PCI-Native Mode Bus Master Adapter Configuration (Informative)...................54</nobr></div>
<div style="position: absolute; top: 8895px; left: 87px;"><nobr>B.1
Introduction
..........................................................................................................................................54</nobr></div>
<div style="position: absolute; top: 8913px; left: 87px;"><nobr>B.2 ATA
Controller PCI Configuration Registers
...........................................................................................54</nobr></div>
<div style="position: absolute; top: 8930px; left: 87px;"><nobr>B.3 ATA
PIO and DMA Mode Timing and Control Registers
..........................................................................54</nobr></div>
<div style="position: absolute; top: 8947px; left: 87px;"><nobr>B.4
Ultra DMA Configuration of Timing and Control Registers
.......................................................................56</nobr></div>
</span></font>

<div style="position: absolute; top: 9679px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="10"><b>Page 10</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 10818px; left: 687px;"><nobr>Page iv</nobr></div>
</span></font>

<div style="position: absolute; top: 10867px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="11"><b>Page 11</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 10921px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 12006px; left: 87px;"><nobr>Page v</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 10942px; left: 92px;"><nobr><b>Foreword </b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 10964px; left: 87px;"><nobr>(This foreword is not part of American National Standard ***-****.)</nobr></div>
<div style="position: absolute; top: 10990px; left: 87px;"><nobr>This standard was developed by the ATA ad hoc working group of Accredited Standards Committee INCITS </nobr></div>
<div style="position: absolute; top: 11007px; left: 87px;"><nobr>starting in 2001. This document includes annexes that are informative and are not considered part of the </nobr></div>
<div style="position: absolute; top: 11025px; left: 87px;"><nobr>standard.</nobr></div>
<div style="position: absolute; top: 11051px; left: 87px;"><nobr>Requests for interpretation, suggestions for improvement and addenda, or defect reports are welcome. They </nobr></div>
<div style="position: absolute; top: 11068px; left: 87px;"><nobr>should be sent to the INCITS Secretariat, Information Technology Industry Council, 1250 Eye Street, NW, Suite </nobr></div>
<div style="position: absolute; top: 11086px; left: 87px;"><nobr>200, Washington, DC 20005-3922.</nobr></div>
<div style="position: absolute; top: 11111px; left: 87px;"><nobr>This standard was processed and approved for submittal to ANSI by Accredited Standards Committee on </nobr></div>
<div style="position: absolute; top: 11128px; left: 87px;"><nobr>Information Processing Systems, INCITS. Committee approval of the standard does not necessarily imply that </nobr></div>
<div style="position: absolute; top: 11146px; left: 87px;"><nobr>all committee members voted for approval. At the time it approved this standard, the INCITS Committee had the </nobr></div>
<div style="position: absolute; top: 11163px; left: 87px;"><nobr>Karen Higginbottom, Chair</nobr></div>
<div style="position: absolute; top: 11189px; left: 87px;"><nobr>(Vacant), Vice-Chair</nobr></div>
<div style="position: absolute; top: 11216px; left: 87px;"><nobr>Monica Vago, Secretary</nobr></div>
<div style="position: absolute; top: 11242px; left: 87px;"><nobr>Organization Represented</nobr></div>
<div style="position: absolute; top: 11242px; left: 281px;"><nobr>Name of Representative</nobr></div>
<div style="position: absolute; top: 11263px; left: 87px;"><nobr>AMP, Inc John Hill, Charles Brill (Alt.)</nobr></div>
<div style="position: absolute; top: 11286px; left: 87px;"><nobr>Apple Computer</nobr></div>
<div style="position: absolute; top: 11286px; left: 216px;"><nobr>David Michael, Jerry Kellenbenz (Alt.)</nobr></div>
<div style="position: absolute; top: 11307px; left: 87px;"><nobr>AT&amp;T Thomas Frost, Paul Bartoli (Alt.)</nobr></div>
<div style="position: absolute; top: 11329px; left: 87px;"><nobr>Bull HN Information Systems, Inc. Patrick L. Harris</nobr></div>
<div style="position: absolute; top: 11351px; left: 87px;"><nobr>Compaq Computer Corporation Steven Heil, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11352px; left: 385px;"><nobr>Seve Park (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11372px; left: 87px;"><nobr>Eastman Kodak Michael Nier</nobr></div>
<div style="position: absolute; top: 11394px; left: 87px;"><nobr>Hewlett-Packard</nobr></div>
<div style="position: absolute; top: 11394px; left: 216px;"><nobr>Karen Higginbottom,</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11395px; left: 368px;"><nobr>Donald Loughry (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11416px; left: 87px;"><nobr>Hitachi America, Ltd. John Neumann, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11417px; left: 343px;"><nobr>Kei Yamashita (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11438px; left: 87px;"><nobr>Hughes Aircraft Company Harold L. Zebrack</nobr></div>
<div style="position: absolute; top: 11459px; left: 87px;"><nobr>IBM Corporation</nobr></div>
<div style="position: absolute; top: 11459px; left: 216px;"><nobr>Ron Silletti, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11460px; left: 296px;"><nobr>Joel Urman (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11482px; left: 87px;"><nobr>Institute for Certification of Computer Professionals Kenneth M. Zemrowski, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11483px; left: 605px;"><nobr>Tom Kurihara (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11503px; left: 87px;"><nobr>Lucent Technologies, Inc. Herbert Bertine, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11504px; left: 367px;"><nobr>Tom Rutt (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11524px; left: 87px;"><nobr>National Communications Systems Dennis Bodson, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11525px; left: 432px;"><nobr>Frack McClelland (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11547px; left: 87px;"><nobr>National Institute of Standards and Technology</nobr></div>
<div style="position: absolute; top: 11547px; left: 411px;"><nobr>Michael Hogan, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11548px; left: 516px;"><nobr>Bruce K. Rosen (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11568px; left: 87px;"><nobr>Panasonic Technologies, Inc..</nobr></div>
<div style="position: absolute; top: 11568px; left: 303px;"><nobr>Judson Hofmann, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11569px; left: 420px;"><nobr>Terry J. Nelson (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11590px; left: 87px;"><nobr>Share, Inc. David Thewlis, Gary Ainsworth (Alt.)</nobr></div>
<div style="position: absolute; top: 11612px; left: 87px;"><nobr>Sony Electronics, Inc. Masataka Ogawa, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11613px; left: 360px;"><nobr>Michael Deese (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11633px; left: 87px;"><nobr>Storage Technology Corporation</nobr></div>
<div style="position: absolute; top: 11633px; left: 324px;"><nobr>Joseph S. Zajaczkowski</nobr></div>
<div style="position: absolute; top: 11655px; left: 87px;"><nobr>Sun Microsystems, Inc.</nobr></div>
<div style="position: absolute; top: 11655px; left: 260px;"><nobr>Gary Robinson</nobr></div>
<div style="position: absolute; top: 11677px; left: 87px;"><nobr>Sybase, Inc. Donald Deutsch,  Andrew Eisenberg (Alt.)</nobr></div>
<div style="position: absolute; top: 11699px; left: 87px;"><nobr>Texas Instruments, Inc.</nobr></div>
<div style="position: absolute; top: 11699px; left: 260px;"><nobr>Clyde Camp, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11700px; left: 349px;"><nobr>Fritz Whittington (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11720px; left: 87px;"><nobr>Unisys Corporation Arnold F. Winkler, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11721px; left: 339px;"><nobr>Stephen P. Oksala (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11743px; left: 87px;"><nobr>U.S. Department of Defense/DISA Jerry L. Smith, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11744px; left: 424px;"><nobr>C. J. Pasquariello (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11764px; left: 87px;"><nobr>U.S. Department of Energy</nobr></div>
<div style="position: absolute; top: 11764px; left: 281px;"><nobr>Carol Blackston, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11765px; left: 411px;"><nobr>Bruce R. White (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11785px; left: 87px;"><nobr>Xerox Corporation John B. Flannery, </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 11786px; left: 335px;"><nobr>Jean Baroness (Alt.)</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 11826px; left: 87px;"><nobr>Subcommittee T13 on ATA Interfaces, that reviewed this standard, had the following members:</nobr></div>
<div style="position: absolute; top: 11852px; left: 87px;"><nobr>Pete McLean, Chairman</nobr></div>
<div style="position: absolute; top: 11878px; left: 87px;"><nobr>Dan Colegrove, Vice Chairman</nobr></div>
<div style="position: absolute; top: 11905px; left: 87px;"><nobr>ATA/ATAPI ad hoc Working Group, that developed this standard, had the following additional participants:</nobr></div>
</span></font>

<div style="position: absolute; top: 12055px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="12"><b>Page 12</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 13194px; left: 687px;"><nobr>Page vi</nobr></div>
</span></font>

<div style="position: absolute; top: 13243px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="13"><b>Page 13</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 13297px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 14382px; left: 87px;"><nobr>Page vii</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 13318px; left: 54px;"><nobr><b>Introduction</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 13340px; left: 87px;"><nobr>This standard encompasses the following:</nobr></div>
<div style="position: absolute; top: 13374px; left: 141px;"><nobr>Clause 1 describes the scope.</nobr></div>
<div style="position: absolute; top: 13401px; left: 141px;"><nobr>Clause 2 provides normative references.</nobr></div>
<div style="position: absolute; top: 13427px; left: 141px;"><nobr>Clause 3 provides definitions, abbreviations, and conventions.</nobr></div>
<div style="position: absolute; top: 13453px; left: 141px;"><nobr>Clause 4 describes ATA host adapters.</nobr></div>
<div style="position: absolute; top: 13480px; left: 141px;"><nobr>Clause 5 describes an ISA Address Decoder Adapter.</nobr></div>
<div style="position: absolute; top: 13505px; left: 141px;"><nobr>Clause 6 describes PCI compatibility and PCI-Native Mode Bus Master Adapters.</nobr></div>
<div style="position: absolute; top: 13531px; left: 141px;"><nobr>Clause 7 Provides requirements for Automatic Direct Memory Access (ADMA) Adapters</nobr></div>
</span></font>

<div style="position: absolute; top: 14431px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="14"><b>Page 14</b></a></font></td></tr></tbody></table></div>
<div style="position: absolute; top: 14431px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="15"><b>Page 15</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 14485px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 15570px; left: 87px;"><nobr>Page 1</nobr></div>
<div style="position: absolute; top: 14511px; left: 87px;"><nobr><b>AMERICAN NATIONAL STANDARD                                                          NCITS.***-200x</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 19px; font-family: Times;">
<div style="position: absolute; top: 14592px; left: 87px;"><nobr>American National Standard</nobr></div>
<div style="position: absolute; top: 14616px; left: 87px;"><nobr>for Information Systems -</nobr></div>
<div style="position: absolute; top: 14685px; left: 87px;"><nobr><b>Information Technology -</b></nobr></div>
</span></font>
<font face="Times" size="4"><span style="font-size: 25px; font-family: Times;">
<div style="position: absolute; top: 14709px; left: 87px;"><nobr><b>ATA/ATAPI Host Adapters Standard (ATA – Adapter)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 14785px; left: 54px;"><nobr><b>1 Scope</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 14833px; left: 87px;"><nobr>This standard specifies the AT Attachment Interface between host systems using Automatic Direct Memory </nobr></div>
<div style="position: absolute; top: 14851px; left: 87px;"><nobr>Access (ADMA) and storage devices. It provides a common link layer interface for systems manufacturers, </nobr></div>
<div style="position: absolute; top: 14868px; left: 87px;"><nobr>system integrators, and software suppliers.</nobr></div>
<div style="position: absolute; top: 14903px; left: 87px;"><nobr>The application environment for the AT Attachment Interface is any host system that has a PCI bus and storage </nobr></div>
<div style="position: absolute; top: 14920px; left: 87px;"><nobr>devices contained within the processor enclosure.</nobr></div>
<div style="position: absolute; top: 14963px; left: 87px;"><nobr>This standard maintains a high degree of compatibility with the AT Attachment with Packet Interface – 6 </nobr></div>
<div style="position: absolute; top: 14980px; left: 87px;"><nobr>standard (ATA/ATAPI-6), INCITS 361-2002, and while specifying link-layer register definitions and usage </nobr></div>
<div style="position: absolute; top: 14997px; left: 87px;"><nobr>information, is not intended to require changes to presently installed devices.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 15040px; left: 54px;"><nobr><b>2 Normative References</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 15099px; left: 65px;"><nobr><b>2.1 Content Imported from Normative Standards</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 15124px; left: 87px;"><nobr>Where material within this standard has been imported from another, normative standard, in whole or in part, it </nobr></div>
<div style="position: absolute; top: 15142px; left: 87px;"><nobr>is done so for the sake of readability of this document and the normative source document is identified.  The </nobr></div>
<div style="position: absolute; top: 15159px; left: 87px;"><nobr>source standard has precedence where there is a difference of definition.  References are listed in this section.  </nobr></div>
<div style="position: absolute; top: 15176px; left: 87px;"><nobr>Each reference has an abbreviated reference form, enclosed within braces '{}'.  This abbreviation, braces </nobr></div>
<div style="position: absolute; top: 15194px; left: 87px;"><nobr>included, is used in the body of this document.  Where the reference cites a standard and working drafts, the </nobr></div>
<div style="position: absolute; top: 15211px; left: 87px;"><nobr>cross-reference is to the standard that was current at the time when this document was written.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 15238px; left: 65px;"><nobr><b>2.2 Industry Standard References </b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 15264px; left: 75px;"><nobr><b>2.2.1 ANSI Information Technology – AT Attachment with Packet Interface  (ATA/ATAPI-5)</b></nobr></div>
<div style="position: absolute; top: 15294px; left: 87px;"><nobr>Abbreviation: {ATA Standard}</nobr></div>
<div style="position: absolute; top: 15321px; left: 87px;"><nobr>Published standard: Information Technology - AT Attachment with Packet Interface - 5 (ATA/ATAPI-5), ANSI </nobr></div>
<div style="position: absolute; top: 15338px; left: 87px;"><nobr>National Standard for Information Systems, # ANSI INCITS 340-2000.</nobr></div>
<div style="position: absolute; top: 15364px; left: 87px;"><nobr>Standard: Information Technology - AT Attachment Interface with Packet Interface Extensions - 6 (ATA/ATAPI-</nobr></div>
<div style="position: absolute; top: 15382px; left: 87px;"><nobr>6), INCITS 361-2002</nobr></div>
<div style="position: absolute; top: 15403px; left: 75px;"><nobr><b>2.2.2 PCI Local Bus Specification</b></nobr></div>
<div style="position: absolute; top: 15434px; left: 87px;"><nobr>Abbreviation: {PCI Spec}</nobr></div>
<div style="position: absolute; top: 15461px; left: 87px;"><nobr>Standard for the PCI Local Bus, Revision 2.3, published October 19, 2001, by the PCI Special Interest Group </nobr></div>
<div style="position: absolute; top: 15478px; left: 87px;"><nobr>(PCI SIG). </nobr></div>
<div style="position: absolute; top: 15503px; left: 87px;"><nobr>This standard is freely available and can be downloaded from www.pcisig.org </nobr></div>
</span></font>

<div style="position: absolute; top: 15619px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="16"><b>Page 16</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 16758px; left: 689px;"><nobr>Page 2</nobr></div>
<div style="position: absolute; top: 15695px; left: 75px;"><nobr><b>2.2.3 PCI Hot-Plug Specification</b></nobr></div>
<div style="position: absolute; top: 15726px; left: 87px;"><nobr>Abbreviation: {PCI Hot Plug}</nobr></div>
<div style="position: absolute; top: 15752px; left: 87px;"><nobr>Standard for the PCI Local Bus, Revision 1.0, published October 6, 1997, by the PCI Special Interest Group </nobr></div>
<div style="position: absolute; top: 15769px; left: 87px;"><nobr>(PCI SIG).</nobr></div>
<div style="position: absolute; top: 15796px; left: 87px;"><nobr>This standard is freely available and can be downloaded from <font color="#0000ff" face="Times">www.pcisig.org</font></nobr></div>
<div style="position: absolute; top: 15817px; left: 75px;"><nobr><b>2.2.4 PCI Bus Power Management Specification</b></nobr></div>
<div style="position: absolute; top: 15848px; left: 87px;"><nobr>Abbreviation: {PCI PMS}</nobr></div>
<div style="position: absolute; top: 15875px; left: 87px;"><nobr>Standard for the PCI Local Bus – Revision 1.1, published December 18, 1998, by the PCI Special Interest </nobr></div>
<div style="position: absolute; top: 15892px; left: 87px;"><nobr>Group (PCI SIG).</nobr></div>
<div style="position: absolute; top: 15917px; left: 87px;"><nobr>This standard is freely available and can be downloaded from <font color="#0000ff" face="Times">www.pcisig.org</font></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 15960px; left: 54px;"><nobr><b>3 Definitions, Abbreviations, and Conventions</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 15992px; left: 65px;"><nobr><b>3.1 Definitions and Abbreviations</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 16018px; left: 75px;"><nobr><b>3.1.1 ADMA</b></nobr></div>
<div style="position: absolute; top: 16048px; left: 87px;"><nobr>Automatic Direct Memory Access</nobr></div>
<div style="position: absolute; top: 16069px; left: 75px;"><nobr><b>3.1.2 Adapter</b></nobr></div>
<div style="position: absolute; top: 16101px; left: 87px;"><nobr>Within the bounds of this standard the term Adapter represents the hardware that is the interface between the </nobr></div>
<div style="position: absolute; top: 16118px; left: 87px;"><nobr>ATA host and the ATA Channel.  The embodiment of this includes Integrated Circuits, and plug-in adapters.</nobr></div>
<div style="position: absolute; top: 16139px; left: 75px;"><nobr><b>3.1.3 ADMA Command Chaining</b></nobr></div>
<div style="position: absolute; top: 16171px; left: 87px;"><nobr>The principle objective of implementing command chaining in the ADMA hardware is to allow the host software </nobr></div>
<div style="position: absolute; top: 16187px; left: 87px;"><nobr>and the ADMA hardware to be loosely coupled.  To do this, the software can build up a list of tasks (a command </nobr></div>
<div style="position: absolute; top: 16204px; left: 87px;"><nobr>chain) for the hardware to execute.  The hardware independently reads these requests from host memory and </nobr></div>
<div style="position: absolute; top: 16222px; left: 87px;"><nobr>executes the tasks.  When the hardware completes a task, it interrupts the host to inform the host that the task </nobr></div>
<div style="position: absolute; top: 16239px; left: 87px;"><nobr>is complete, but immediately proceeds to the next task without waiting.</nobr></div>
<div style="position: absolute; top: 16261px; left: 75px;"><nobr><b>3.1.4 ADMA Mode</b></nobr></div>
<div style="position: absolute; top: 16292px; left: 87px;"><nobr>An operating mode of the ADMA engine which uses ADMA command chaining.</nobr></div>
<div style="position: absolute; top: 16313px; left: 75px;"><nobr><b>3.1.5 ADMA Physical Region Descriptor (APRD)</b></nobr></div>
<div style="position: absolute; top: 16344px; left: 87px;"><nobr>An APRD is an automatic DMA mode data structure that describes areas of host memory that are used during </nobr></div>
<div style="position: absolute; top: 16362px; left: 87px;"><nobr>data transfer. (see Clause 7.6.1.8)</nobr></div>
<div style="position: absolute; top: 16383px; left: 75px;"><nobr><b>3.1.6 ATA Bus</b></nobr></div>
<div style="position: absolute; top: 16414px; left: 87px;"><nobr>The physical connection between an ATA adapter and an ATA device, that consists of conductors carrying </nobr></div>
<div style="position: absolute; top: 16432px; left: 87px;"><nobr>signals.</nobr></div>
<div style="position: absolute; top: 16453px; left: 75px;"><nobr><b>3.1.7 ATA Bus Release</b></nobr></div>
<div style="position: absolute; top: 16483px; left: 87px;"><nobr>{ATA Standard}  The act of clearing both DRQ and BSY to zero, and setting ATA REL to one, before the action </nobr></div>
<div style="position: absolute; top: 16501px; left: 87px;"><nobr>requested by a command is completed.  This allows the host to select the other device on the channel.  (Applies </nobr></div>
<div style="position: absolute; top: 16518px; left: 87px;"><nobr>only to ATA devices that implement Overlap Protocol, by releasing the bus.)</nobr></div>
<div style="position: absolute; top: 16540px; left: 75px;"><nobr><b>3.1.8 ATA Channel</b></nobr></div>
<div style="position: absolute; top: 16571px; left: 87px;"><nobr>The ATA Channel is the logical transport mechanism between the ATA host and the ATA devices on an ATA </nobr></div>
<div style="position: absolute; top: 16588px; left: 87px;"><nobr>Bus.  Each ATA Channel may have up to two ATA devices connected to it. </nobr></div>
<div style="position: absolute; top: 16609px; left: 75px;"><nobr><b>3.1.9 ATA Command Acceptance</b></nobr></div>
<div style="position: absolute; top: 16641px; left: 87px;"><nobr>{ATA Standard} Section 3.1.15 “A command is considered accepted whenever the currently selected device has </nobr></div>
<div style="position: absolute; top: 16658px; left: 87px;"><nobr>the BSY bit cleared to zero in the Status register and the host writes to the Command register.  An exception </nobr></div>
<div style="position: absolute; top: 16675px; left: 87px;"><nobr>exists for the EXECUTE DEVICE DIAGNOSTIC and DEVICE RESET commands.”</nobr></div>
</span></font>

<div style="position: absolute; top: 16807px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="17"><b>Page 17</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 16861px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 17946px; left: 87px;"><nobr>Page 3</nobr></div>
<div style="position: absolute; top: 16883px; left: 75px;"><nobr><b>3.1.10 ATA Command Queue (in the device)</b></nobr></div>
<div style="position: absolute; top: 16914px; left: 87px;"><nobr>{ATA Standard}  The ATA Command Queue in the device is the set of all commands that an ATA device has </nobr></div>
<div style="position: absolute; top: 16931px; left: 87px;"><nobr>accepted and is currently processing.</nobr></div>
<div style="position: absolute; top: 16952px; left: 75px;"><nobr><b>3.1.11 ATA device</b></nobr></div>
<div style="position: absolute; top: 16984px; left: 87px;"><nobr>{ATA Standard}  An ATA device is a data storage device.  Traditionally, a device on the ATA interface has been </nobr></div>
<div style="position: absolute; top: 17001px; left: 87px;"><nobr>a hard drive, but any form of storage device may be placed on the interface, provided that the device adheres to </nobr></div>
<div style="position: absolute; top: 17018px; left: 87px;"><nobr>the ATA standard.</nobr></div>
<div style="position: absolute; top: 17040px; left: 75px;"><nobr><b>3.1.12 ATA DMA</b></nobr></div>
<div style="position: absolute; top: 17071px; left: 87px;"><nobr>The transfer of data between an ATA device and an ATA adapter under the control of the DMARQ and DMACK </nobr></div>
<div style="position: absolute; top: 17087px; left: 87px;"><nobr>signals on the ATA bus.  There are two methods of DMA defined:  Multiword DMA, where the adapter controls </nobr></div>
<div style="position: absolute; top: 17105px; left: 87px;"><nobr>timings, and Ultra DMA, where the sender controls timings.</nobr></div>
<div style="position: absolute; top: 17127px; left: 75px;"><nobr><b>3.1.13 ATA Host</b></nobr></div>
<div style="position: absolute; top: 17157px; left: 87px;"><nobr>The ATA host is the host system in which the software that controls the functions of the ATA Subsystem is </nobr></div>
<div style="position: absolute; top: 17175px; left: 87px;"><nobr>executed.</nobr></div>
<div style="position: absolute; top: 17197px; left: 75px;"><nobr><b>3.1.14 ATA Multiword DMA</b></nobr></div>
<div style="position: absolute; top: 17227px; left: 87px;"><nobr>ATA Multiword DMA is defined to transfer data at up to 16 MB/s.  This protocol has traditionally been used in </nobr></div>
<div style="position: absolute; top: 17245px; left: 87px;"><nobr>conjunction with the PCI DMA protocol to provide a more efficient means of transferring data through the </nobr></div>
<div style="position: absolute; top: 17262px; left: 87px;"><nobr>system. </nobr></div>
<div style="position: absolute; top: 17283px; left: 75px;"><nobr><b>3.1.15 ATA-n</b></nobr></div>
<div style="position: absolute; top: 17315px; left: 87px;"><nobr>A shorthand reference to the standard specified in the ATA-n (or ATA/ATAPI-n, as applicable) standards </nobr></div>
<div style="position: absolute; top: 17332px; left: 87px;"><nobr>document, whether published as final, circulated in draft form, or only in the planning stage.</nobr></div>
<div style="position: absolute; top: 17353px; left: 75px;"><nobr><b>3.1.16 ATA Register Mode</b></nobr></div>
<div style="position: absolute; top: 17384px; left: 87px;"><nobr>ATA Register Mode is an operating mode of the ADMA engine where accesses to the ATA device uses host </nobr></div>
<div style="position: absolute; top: 17401px; left: 87px;"><nobr>memory or I/O instructions to access the device registers directly using ATA PIO protocols.</nobr></div>
<div style="position: absolute; top: 17423px; left: 75px;"><nobr><b>3.1.17 ATA Subsystem</b></nobr></div>
<div style="position: absolute; top: 17454px; left: 87px;"><nobr>The ATA subsystem includes the ATA hardware elements, which consist of an ATA adapter, an ATA channel, </nobr></div>
<div style="position: absolute; top: 17471px; left: 87px;"><nobr>and ATA/ATAPI device(s).</nobr></div>
<div style="position: absolute; top: 17492px; left: 75px;"><nobr><b>3.1.18 ATA Overlap Protocol</b></nobr></div>
<div style="position: absolute; top: 17523px; left: 87px;"><nobr>{ATA Standard}  The ATA overlap protocol allows an ATA device to perform an ATA Bus Release, so that </nobr></div>
<div style="position: absolute; top: 17541px; left: 87px;"><nobr>commands may be executed by another device on the same bus.</nobr></div>
<div style="position: absolute; top: 17562px; left: 75px;"><nobr><b>3.1.19 ATA Overlapped Command</b></nobr></div>
<div style="position: absolute; top: 17593px; left: 87px;"><nobr>{ATA Standard}  A command is an overlapped command if it is listed as part of the Overlapped or Queued </nobr></div>
<div style="position: absolute; top: 17611px; left: 87px;"><nobr>Feature Set.</nobr></div>
<div style="position: absolute; top: 17632px; left: 75px;"><nobr><b>3.1.20 ATA PIO</b></nobr></div>
<div style="position: absolute; top: 17662px; left: 87px;"><nobr>{ATA Standard}  For the ATA bus, PIO means that data is transferred between the device and the adapter by </nobr></div>
<div style="position: absolute; top: 17680px; left: 87px;"><nobr>reading or writing a register in the device.  The address of the register and the timing of the transfers are under </nobr></div>
<div style="position: absolute; top: 17697px; left: 87px;"><nobr>the control of the adapter.</nobr></div>
<div style="position: absolute; top: 17719px; left: 75px;"><nobr><b>3.1.21 ATA Ultra DMA</b></nobr></div>
<div style="position: absolute; top: 17750px; left: 87px;"><nobr>{ATA Standard}  ATA Ultra DMA is a high-speed mode of data transfer. The Ultra protocol also defines the use </nobr></div>
<div style="position: absolute; top: 17767px; left: 87px;"><nobr>of a CRC to validate that data has been correctly transferred.</nobr></div>
<div style="position: absolute; top: 17788px; left: 75px;"><nobr><b>3.1.22 ATAPI (AT Attachment Packet Interface) Device</b></nobr></div>
<div style="position: absolute; top: 17820px; left: 87px;"><nobr>{ATA Standard}  An ATA device that implements the Packet Command feature set.</nobr></div>
<div style="position: absolute; top: 17841px; left: 75px;"><nobr><b>3.1.23 BAR</b></nobr></div>
<div style="position: absolute; top: 17872px; left: 87px;"><nobr>The Base Address Register (BAR) contains the base addresses of sets of registers accessible through the PCI </nobr></div>
<div style="position: absolute; top: 17890px; left: 87px;"><nobr>bus.</nobr></div>
</span></font>

<div style="position: absolute; top: 17995px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="18"><b>Page 18</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 19134px; left: 689px;"><nobr>Page 4</nobr></div>
<div style="position: absolute; top: 18071px; left: 75px;"><nobr><b>3.1.24 Bus Protocol</b></nobr></div>
<div style="position: absolute; top: 18102px; left: 87px;"><nobr>A bus protocol consists of the sequence of bus signal states, and their timings, which are required in order to </nobr></div>
<div style="position: absolute; top: 18119px; left: 87px;"><nobr>transfer commands and data along a bus.  There may be more than one protocol available on any one bus.</nobr></div>
<div style="position: absolute; top: 18140px; left: 75px;"><nobr><b>3.1.25 Byte</b></nobr></div>
<div style="position: absolute; top: 18172px; left: 87px;"><nobr>A Byte is a unit of data that consists of eight bits of data as described below:</nobr></div>
<div style="position: absolute; top: 18203px; left: 177px;"><nobr>bit 7</nobr></div>
<div style="position: absolute; top: 18203px; left: 252px;"><nobr>bit 6</nobr></div>
<div style="position: absolute; top: 18203px; left: 327px;"><nobr>bit 5</nobr></div>
<div style="position: absolute; top: 18203px; left: 403px;"><nobr>bit 4</nobr></div>
<div style="position: absolute; top: 18203px; left: 478px;"><nobr>bit 3</nobr></div>
<div style="position: absolute; top: 18203px; left: 552px;"><nobr>bit 2</nobr></div>
<div style="position: absolute; top: 18203px; left: 628px;"><nobr>bit 1</nobr></div>
<div style="position: absolute; top: 18203px; left: 703px;"><nobr>bit 0</nobr></div>
<div style="position: absolute; top: 18230px; left: 75px;"><nobr><b>3.1.26 Command Complete</b></nobr></div>
<div style="position: absolute; top: 18261px; left: 87px;"><nobr>Command completion is the completion by the device of the action requested by the command or the </nobr></div>
<div style="position: absolute; top: 18278px; left: 87px;"><nobr>termination of the command with an error, the placing of the appropriate error bits in the Error register, the </nobr></div>
<div style="position: absolute; top: 18296px; left: 87px;"><nobr>placing of the appropriate status bits in the Status register, the clearing of both BSY and DRQ to zero, and the </nobr></div>
<div style="position: absolute; top: 18313px; left: 87px;"><nobr>asserting of INTRQ if nIEN is cleared to zero and the command protocol specifies that INTRQ be asserted.</nobr></div>
<div style="position: absolute; top: 18334px; left: 75px;"><nobr><b>3.1.27 Command Parameter Block (CPB)</b></nobr></div>
<div style="position: absolute; top: 18365px; left: 87px;"><nobr>A Command Parameter Block (CPB) is an automatic DMA mode data structure that describes a command to be </nobr></div>
<div style="position: absolute; top: 18382px; left: 87px;"><nobr>executed by the ADMA engine. (see clause 7.6.1)</nobr></div>
<div style="position: absolute; top: 18404px; left: 75px;"><nobr><b>3.1.28 Cyclic Redundancy Check (CRC)</b></nobr></div>
<div style="position: absolute; top: 18435px; left: 87px;"><nobr>{ATA Standard}  Used for the Ultra DMA protocol to check the validity of the data that has been transferred </nobr></div>
<div style="position: absolute; top: 18452px; left: 87px;"><nobr>during the last Ultra DMA burst.</nobr></div>
<div style="position: absolute; top: 18473px; left: 75px;"><nobr><b>3.1.29 DMA</b></nobr></div>
<div style="position: absolute; top: 18505px; left: 87px;"><nobr>Direct Memory Access.  A means of data transfer, between device and host memory, such that host processor </nobr></div>
<div style="position: absolute; top: 18522px; left: 87px;"><nobr>intervention is not needed to accomplish the data transfer after initiation of the transfer activity.</nobr></div>
<div style="position: absolute; top: 18543px; left: 75px;"><nobr><b>3.1.30 DWord</b></nobr></div>
<div style="position: absolute; top: 18575px; left: 87px;"><nobr>A DWord (Double Word) is a unit of data that consists of four Bytes as represented below:</nobr></div>
<div style="position: absolute; top: 18610px; left: 162px;"><nobr>bit 31</nobr></div>
<div style="position: absolute; top: 18610px; left: 719px;"><nobr>bit 0</nobr></div>
<div style="position: absolute; top: 18632px; left: 207px;"><nobr>Byte 3</nobr></div>
<div style="position: absolute; top: 18632px; left: 358px;"><nobr>Byte 2</nobr></div>
<div style="position: absolute; top: 18632px; left: 507px;"><nobr>Byte 1</nobr></div>
<div style="position: absolute; top: 18632px; left: 658px;"><nobr>Byte 0</nobr></div>
<div style="position: absolute; top: 18659px; left: 75px;"><nobr><b>3.1.31 Host DMA</b></nobr></div>
<div style="position: absolute; top: 18689px; left: 87px;"><nobr>{PCI Spec}  Host DMA means that data is transferred between the host and the ATA adapter over the PCI bus, </nobr></div>
<div style="position: absolute; top: 18706px; left: 87px;"><nobr>using the PCI Burst mode protocol with the adapter as master and the PCI host as target.  Once initiated, the </nobr></div>
<div style="position: absolute; top: 18724px; left: 87px;"><nobr>transfer requires no host Processor involvement.</nobr></div>
<div style="position: absolute; top: 18746px; left: 75px;"><nobr><b>3.1.32 PCI</b></nobr></div>
<div style="position: absolute; top: 18776px; left: 87px;"><nobr>PCI is an acronym for Peripheral Component Interconnect.</nobr></div>
<div style="position: absolute; top: 18799px; left: 75px;"><nobr><b>3.1.33 Physical Region Descriptor (PRD)</b></nobr></div>
<div style="position: absolute; top: 18829px; left: 87px;"><nobr>A Physical Region Descriptor (PRD) is a native mode PCI DMA data structure that describes areas of host </nobr></div>
<div style="position: absolute; top: 18846px; left: 87px;"><nobr>memory that are used during data transfer.  (see Clause 6.7.3)</nobr></div>
<div style="position: absolute; top: 18868px; left: 75px;"><nobr><b>3.1.34 QWord</b></nobr></div>
<div style="position: absolute; top: 18899px; left: 87px;"><nobr>A QWord (Quad Word) is a unit of data that consists of eight Bytes as represented below:</nobr></div>
<div style="position: absolute; top: 18934px; left: 179px;"><nobr>bit 63</nobr></div>
<div style="position: absolute; top: 18934px; left: 804px;"><nobr>bit 0</nobr></div>
<div style="position: absolute; top: 18957px; left: 178px;"><nobr>Byte7</nobr></div>
<div style="position: absolute; top: 18957px; left: 261px;"><nobr>Byte 6</nobr></div>
<div style="position: absolute; top: 18957px; left: 348px;"><nobr>Byte 5</nobr></div>
<div style="position: absolute; top: 18957px; left: 433px;"><nobr>Byte 4</nobr></div>
<div style="position: absolute; top: 18957px; left: 519px;"><nobr>Byte 3</nobr></div>
<div style="position: absolute; top: 18957px; left: 604px;"><nobr>Byte 2</nobr></div>
<div style="position: absolute; top: 18957px; left: 690px;"><nobr>Byte 1</nobr></div>
<div style="position: absolute; top: 18957px; left: 776px;"><nobr>Byte 0</nobr></div>
<div style="position: absolute; top: 18983px; left: 75px;"><nobr><b>3.1.35 Word</b></nobr></div>
<div style="position: absolute; top: 19015px; left: 87px;"><nobr>A Word is a unit of data that consists of two Bytes as represented below:</nobr></div>
<div style="position: absolute; top: 19049px; left: 277px;"><nobr>bit 15</nobr></div>
<div style="position: absolute; top: 19049px; left: 533px;"><nobr>bit 0</nobr></div>
<div style="position: absolute; top: 19072px; left: 322px;"><nobr>Byte 1</nobr></div>
<div style="position: absolute; top: 19072px; left: 473px;"><nobr>Byte 0</nobr></div>
</span></font>

<div style="position: absolute; top: 19183px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="19"><b>Page 19</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 19237px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 20322px; left: 87px;"><nobr>Page 5</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 19258px; left: 65px;"><nobr><b>3.2 Conventions</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 19282px; left: 75px;"><nobr><b>3.2.1 Keywords</b></nobr></div>
<div style="position: absolute; top: 19308px; left: 87px;"><nobr><b>3.2.1.1 expected: </b>A keyword used to describe the behavior of the hardware or software in the design models </nobr></div>
<div style="position: absolute; top: 19326px; left: 119px;"><nobr>assumed by this standard. Other hardware and software design models may also be implemented.</nobr></div>
<div style="position: absolute; top: 19348px; left: 87px;"><nobr><b>3.2.1.2 mandatory: </b>A keyword indicating items to be implemented as defined by this standard.</nobr></div>
<div style="position: absolute; top: 19369px; left: 87px;"><nobr><b>3.2.1.3 may: </b>A keyword that indicates flexibility of choice with no implied preference.</nobr></div>
<div style="position: absolute; top: 19391px; left: 87px;"><nobr><b>3.2.1.4 obsolete: </b>A keyword used to describe bits, bytes, fields, and code values that no longer have consistent </nobr></div>
<div style="position: absolute; top: 19408px; left: 119px;"><nobr>meaning or functionality from one implementation to another.  However, some degree of functionality may </nobr></div>
<div style="position: absolute; top: 19425px; left: 119px;"><nobr>be required for items designated as “obsolete” to provide for backward compatibility.  An obsolete bit, byte, </nobr></div>
<div style="position: absolute; top: 19443px; left: 119px;"><nobr>field, or command shall never be reclaimed for any other use in any future standard.</nobr></div>
<div style="position: absolute; top: 19477px; left: 120px;"><nobr>Obsolete commands should not be used by the host.  Commands defined as obsolete in previous </nobr></div>
<div style="position: absolute; top: 19495px; left: 120px;"><nobr>standards may be command aborted by devices conforming to this standard.  However, if a device does </nobr></div>
<div style="position: absolute; top: 19512px; left: 120px;"><nobr>not command abort an obsolete command, the minimum that is required by the device in response to the </nobr></div>
<div style="position: absolute; top: 19529px; left: 120px;"><nobr>command is command completion. </nobr></div>
<div style="position: absolute; top: 19551px; left: 87px;"><nobr><b>3.2.1.5 optional: </b>A keyword that describes features that are not required by this standard.  However, if any </nobr></div>
<div style="position: absolute; top: 19568px; left: 119px;"><nobr>optional feature defined by the standard is implemented, the feature shall be implemented in the way </nobr></div>
<div style="position: absolute; top: 19585px; left: 119px;"><nobr>defined by the standard.</nobr></div>
<div style="position: absolute; top: 19607px; left: 87px;"><nobr><b>3.2.1.6 retired: </b>A keyword indicating that the designated bits, bytes, fields, and code values that had been </nobr></div>
<div style="position: absolute; top: 19624px; left: 119px;"><nobr>defined in previous standards are not defined in this standard and may be reclaimed for other uses in future </nobr></div>
<div style="position: absolute; top: 19641px; left: 119px;"><nobr>standards.  If retired bits, bytes, fields, or code values are utilized before they are reclaimed, they shall </nobr></div>
<div style="position: absolute; top: 19659px; left: 119px;"><nobr>have the meaning or functionality as described in previous standards.</nobr></div>
<div style="position: absolute; top: 19681px; left: 87px;"><nobr><b>3.2.1.7 reserved: </b>A keyword indicating reserved  bits, bytes, words, fields, and code values that are set aside </nobr></div>
<div style="position: absolute; top: 19697px; left: 119px;"><nobr>for future standardization.  Their use and interpretation may be specified by future extensions to this or </nobr></div>
<div style="position: absolute; top: 19715px; left: 119px;"><nobr>other standards.  A reserved bit, byte, word, or field shall be set to zero, or in accordance with a future </nobr></div>
<div style="position: absolute; top: 19732px; left: 119px;"><nobr>extension to this standard.  The recipient shall not check reserved bits, bytes, words, or fields. Receipt of </nobr></div>
<div style="position: absolute; top: 19749px; left: 119px;"><nobr>reserved code values in defined fields shall be treated as a command parameter error and reported by </nobr></div>
<div style="position: absolute; top: 19767px; left: 119px;"><nobr>returning command aborted.</nobr></div>
<div style="position: absolute; top: 19789px; left: 87px;"><nobr><b>3.2.1.8 shall: </b>A keyword indicating a mandatory requirement. Designers are required to implement all such </nobr></div>
<div style="position: absolute; top: 19805px; left: 119px;"><nobr>mandatory requirements to ensure interoperability with other standard conformant products.</nobr></div>
<div style="position: absolute; top: 19828px; left: 87px;"><nobr><b>3.2.1.9 should: </b>A keyword indicating flexibility of choice with a strongly preferred alternative. Equivalent to the </nobr></div>
<div style="position: absolute; top: 19845px; left: 119px;"><nobr>phrase “it is recommended”.</nobr></div>
<div style="position: absolute; top: 19866px; left: 75px;"><nobr><b>3.2.2 Precedence</b></nobr></div>
<div style="position: absolute; top: 19898px; left: 87px;"><nobr>If there is a conflict among text, figures, and tables, the precedence shall be: tables, then figures, and then text.</nobr></div>
<div style="position: absolute; top: 19919px; left: 75px;"><nobr><b>3.2.3 Names of Registers, Words, Bytes, Bits, Etcetera</b></nobr></div>
<div style="position: absolute; top: 19949px; left: 87px;"><nobr>The names of registers, words, bytes, bits, and modes begin with uppercase letters.  In addition, register names </nobr></div>
<div style="position: absolute; top: 19967px; left: 87px;"><nobr>are prefixed with the acronyms PCI, ADMA, or ATA, to indicate which of these register sets they belong to.  For </nobr></div>
<div style="position: absolute; top: 19984px; left: 87px;"><nobr>example:  ATA Status Register, Status Word, Bytes 0-3, and Error Bit.</nobr></div>
<div style="position: absolute; top: 20010px; left: 87px;"><nobr>The names of fields within registers or data structures begin with a lower-case letter followed by upper case </nobr></div>
<div style="position: absolute; top: 20028px; left: 87px;"><nobr>letters.  The lower case letter allows the reader to identify the structure or register where the field is defined.  For </nobr></div>
<div style="position: absolute; top: 20045px; left: 87px;"><nobr>example: “aGO” is bit field defined in the ADMA Control Register</nobr></div>
<div style="position: absolute; top: 20066px; left: 75px;"><nobr><b>3.2.4 Numbers</b></nobr></div>
<div style="position: absolute; top: 20098px; left: 87px;"><nobr>Numbers are decimal, unless specified otherwise.</nobr></div>
<div style="position: absolute; top: 20124px; left: 87px;"><nobr>Hexadecimal numbers are shown as a string of digits, 0 through 9 or A through F, followed by 'h': e.g., '1AB7h.'</nobr></div>
<div style="position: absolute; top: 20150px; left: 87px;"><nobr>Binary numbers are shown as a string of digits, 0 or 1, followed by 'b': e.g., '10110111b'.'</nobr></div>
<div style="position: absolute; top: 20172px; left: 75px;"><nobr><b>3.2.5 Nomenclature</b></nobr></div>
<div style="position: absolute; top: 20194px; left: 87px;"><nobr>b - bits</nobr></div>
<div style="position: absolute; top: 20210px; left: 87px;"><nobr>B - Bytes</nobr></div>
<div style="position: absolute; top: 20228px; left: 87px;"><nobr>G – Giga (10</nobr></div>
</span></font>
<font face="Times" size="2"><span style="font-size: 8px; font-family: Times;">
<div style="position: absolute; top: 20225px; left: 170px;"><nobr>9</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 20228px; left: 176px;"><nobr>)</nobr></div>
<div style="position: absolute; top: 20245px; left: 87px;"><nobr>M – Mega (10</nobr></div>
</span></font>
<font face="Times" size="2"><span style="font-size: 8px; font-family: Times;">
<div style="position: absolute; top: 20241px; left: 177px;"><nobr>6</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 20245px; left: 182px;"><nobr>)</nobr></div>
<div style="position: absolute; top: 20262px; left: 87px;"><nobr>n – nano (10</nobr></div>
</span></font>
<font face="Times" size="2"><span style="font-size: 8px; font-family: Times;">
<div style="position: absolute; top: 20258px; left: 168px;"><nobr>-9</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 20262px; left: 177px;"><nobr>)</nobr></div>
<div style="position: absolute; top: 20280px; left: 87px;"><nobr>m – milli (10</nobr></div>
</span></font>
<font face="Times" size="2"><span style="font-size: 8px; font-family: Times;">
<div style="position: absolute; top: 20276px; left: 167px;"><nobr>-3</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 20280px; left: 176px;"><nobr>)</nobr></div>
<div style="position: absolute; top: 20297px; left: 87px;"><nobr>s - second</nobr></div>
</span></font>

<div style="position: absolute; top: 20371px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="20"><b>Page 20</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 21510px; left: 689px;"><nobr>Page 6</nobr></div>
<div style="position: absolute; top: 20447px; left: 75px;"><nobr><b>3.2.6 Signal Names</b></nobr></div>
<div style="position: absolute; top: 20478px; left: 87px;"><nobr>Signal functional names are shown in all uppercase letters.  For example:  'CLKRUN'.</nobr></div>
<div style="position: absolute; top: 20500px; left: 75px;"><nobr><b>3.2.7 Signal States</b></nobr></div>
<div style="position: absolute; top: 20530px; left: 87px;"><nobr>A signal is 'asserted' when it is driven by an active circuit to the true state.  A signal is 'de-asserted' when an </nobr></div>
<div style="position: absolute; top: 20548px; left: 87px;"><nobr>active circuit drives it to the false state.  A signal is 'released' when it is not actively driven to any state.  Some </nobr></div>
<div style="position: absolute; top: 20565px; left: 87px;"><nobr>signals have bias circuitry that pulls the signal to either a true state or a false state when no signal driver is </nobr></div>
<div style="position: absolute; top: 20582px; left: 87px;"><nobr>actively asserting or de-asserting the signal.</nobr></div>
<div style="position: absolute; top: 20604px; left: 75px;"><nobr><b>3.2.8 State Diagram Conventions</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 20685px; left: 440px;"><nobr><b>State designator: State_name</b></nobr></div>
<div style="position: absolute; top: 20685px; left: 182px;"><nobr><b>State designator: State_name</b></nobr></div>
<div style="position: absolute; top: 20731px; left: 151px;"><nobr>Transition label</nobr></div>
<div style="position: absolute; top: 20710px; left: 293px;"><nobr>Transition condition</nobr></div>
<div style="position: absolute; top: 20729px; left: 311px;"><nobr>Transition label</nobr></div>
<div style="position: absolute; top: 20817px; left: 390px;"><nobr>Transition label</nobr></div>
<div style="position: absolute; top: 20710px; left: 162px;"><nobr>Entry condition</nobr></div>
<div style="position: absolute; top: 20712px; left: 552px;"><nobr>Exit condition</nobr></div>
<div style="position: absolute; top: 20730px; left: 554px;"><nobr>Transition label</nobr></div>
<div style="position: absolute; top: 20729px; left: 695px;"><nobr>State_name</nobr></div>
<div style="position: absolute; top: 20874px; left: 209px;"><nobr>State re-entry</nobr></div>
<div style="position: absolute; top: 20798px; left: 393px;"><nobr>Transition condition</nobr></div>
<div style="position: absolute; top: 20750px; left: 158px;"><nobr><i>Transition action</i></nobr></div>
<div style="position: absolute; top: 20750px; left: 293px;"><nobr><i>Transition action</i></nobr></div>
<div style="position: absolute; top: 20754px; left: 546px;"><nobr><i>Transition action</i></nobr></div>
<div style="position: absolute; top: 20838px; left: 405px;"><nobr><i>Transition action</i></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 20987px; left: 329px;"><nobr><b>Figure 1 </b><font face="Symbol">? </font><b>State diagram convention</b></nobr></div>
<div style="position: absolute; top: 21023px; left: 87px;"><nobr>Each state is identified by a state designator and a state name. The state designator is unique among all states </nobr></div>
<div style="position: absolute; top: 21040px; left: 87px;"><nobr>in all state diagrams in this document. The state designator consists of a set of letters that are capitalized in the </nobr></div>
<div style="position: absolute; top: 21056px; left: 87px;"><nobr>title of the figure containing the state diagram followed by a unique number. The state name is a brief </nobr></div>
<div style="position: absolute; top: 21074px; left: 87px;"><nobr>description of the primary action taken during the state, and the same state name may appear in other state </nobr></div>
<div style="position: absolute; top: 21091px; left: 87px;"><nobr>diagrams. If the same primary function occurs in other states in the same state diagram, they are designated </nobr></div>
<div style="position: absolute; top: 21108px; left: 87px;"><nobr>with a unique letter at the end of the name. Additional actions may be taken while in a state and these actions </nobr></div>
<div style="position: absolute; top: 21126px; left: 87px;"><nobr>are described in the state description text.</nobr></div>
<div style="position: absolute; top: 21152px; left: 87px;"><nobr>In device command protocol state diagrams, the state of bits and signals that change state during the execution </nobr></div>
<div style="position: absolute; top: 21169px; left: 87px;"><nobr>of this state diagram are shown under the state designator:state_name, and a table is included that shows the </nobr></div>
<div style="position: absolute; top: 21187px; left: 87px;"><nobr>state of all bits and signals throughout the state diagram as follows:</nobr></div>
<div style="position: absolute; top: 21204px; left: 141px;"><nobr>v = bit value changes.</nobr></div>
<div style="position: absolute; top: 21221px; left: 141px;"><nobr>1 = bit set to one.</nobr></div>
<div style="position: absolute; top: 21239px; left: 141px;"><nobr>0 = bit cleared to zero.</nobr></div>
<div style="position: absolute; top: 21256px; left: 141px;"><nobr>x = bit is don’t care.</nobr></div>
<div style="position: absolute; top: 21272px; left: 141px;"><nobr>V = signal changes.</nobr></div>
<div style="position: absolute; top: 21290px; left: 141px;"><nobr>A = signal is asserted.</nobr></div>
<div style="position: absolute; top: 21307px; left: 141px;"><nobr>N = signal is negated.</nobr></div>
<div style="position: absolute; top: 21324px; left: 141px;"><nobr>R = signal is released.</nobr></div>
<div style="position: absolute; top: 21342px; left: 141px;"><nobr>X = signal is don’t care.</nobr></div>
<div style="position: absolute; top: 21368px; left: 87px;"><nobr>Each transition is identified by a transition label and a transition condition. The transition label consists of the </nobr></div>
<div style="position: absolute; top: 21385px; left: 87px;"><nobr>state designator of the state from which the transition is being made followed by the state designator of the state </nobr></div>
<div style="position: absolute; top: 21403px; left: 87px;"><nobr>to which the transition is being made. In some cases, the transition to enter or exit a state diagram may come </nobr></div>
<div style="position: absolute; top: 21420px; left: 87px;"><nobr>from or go to a number of state diagrams, depending on the command being executed. In this case, the state </nobr></div>
<div style="position: absolute; top: 21437px; left: 87px;"><nobr>designator is labeled xx. The transition condition is a brief description of the event or condition that causes the </nobr></div>
<div style="position: absolute; top: 21455px; left: 87px;"><nobr>transition to occur and may include a transition action, indicated in italics, that is taken when the transition </nobr></div>
<div style="position: absolute; top: 21472px; left: 87px;"><nobr>occurs. This action is described fully in the transition description text.</nobr></div>
</span></font>

<div style="position: absolute; top: 21559px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="21"><b>Page 21</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 21613px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 22698px; left: 87px;"><nobr>Page 7</nobr></div>
<div style="position: absolute; top: 21635px; left: 87px;"><nobr>Upon entry to a state, all actions to be executed in that state are executed. If a state is re-entered from itself, all </nobr></div>
<div style="position: absolute; top: 21653px; left: 87px;"><nobr>actions to be executed in the state are executed again.</nobr></div>
<div style="position: absolute; top: 21679px; left: 87px;"><nobr>It is assumed that all actions defined in a state are executed within the state and that transitions from state to </nobr></div>
<div style="position: absolute; top: 21695px; left: 87px;"><nobr>state are instantaneous.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 21713px; left: 54px;"><nobr><b>4 ATA Host Adapters</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 21743px; left: 87px;"><nobr>The ATA interface as defined in {ATA Standard} describes the physical, electrical, timing, protocol and </nobr></div>
<div style="position: absolute; top: 21760px; left: 87px;"><nobr>command standards required to transfer data to and from a compliant device. That standard does not </nobr></div>
<div style="position: absolute; top: 21778px; left: 87px;"><nobr>differentiate between host adapter and host requirements.  The ATA – Adapter standard defines the register and </nobr></div>
<div style="position: absolute; top: 21794px; left: 87px;"><nobr>physical requirements of Host adapters. The objective is to enable Host software to be developed that can work </nobr></div>
<div style="position: absolute; top: 21811px; left: 87px;"><nobr>with a Host adapter supplied from a variety of vendors.</nobr></div>
<div style="position: absolute; top: 21838px; left: 87px;"><nobr>Host adapters act as a bridge between the Host bus and the ATA bus. Thus Host adapters are required to meet </nobr></div>
<div style="position: absolute; top: 21855px; left: 87px;"><nobr>at least two sets of standards. Host software shall be able to configure the adapter for both the Host bus </nobr></div>
<div style="position: absolute; top: 21872px; left: 87px;"><nobr>operation and the ATA bus operation. Thus this standard defines, where possible, a common API (Applications </nobr></div>
<div style="position: absolute; top: 21890px; left: 87px;"><nobr>Programming Interface) for those functions. </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 21917px; left: 65px;"><nobr><b>4.1 Adapter Types</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 21943px; left: 87px;"><nobr>The ATA interface has evolved from an original plug in Host adapter on the IBM PC-AT. This adapter controlled </nobr></div>
<div style="position: absolute; top: 21961px; left: 87px;"><nobr>hard drives that interfaced to it using an ST506 interface. ATA drives moved the functionality of that adapter </nobr></div>
<div style="position: absolute; top: 21978px; left: 87px;"><nobr>from a plug in card into the device. The same register set was retained and thus the most important attribute of </nobr></div>
<div style="position: absolute; top: 21996px; left: 87px;"><nobr>the ATA interface was initiated, backward compatibility. Host software and BIOS code did not have to change. </nobr></div>
<div style="position: absolute; top: 22018px; left: 87px;"><nobr>The first ATA Host adapters were address decoder cards plugged into the ISA bus. The cards decoded the I/O </nobr></div>
<div style="position: absolute; top: 22036px; left: 87px;"><nobr>addresses of the registers in the ATA register set and connected the ISA bus to the ATA bus. All timings on the </nobr></div>
<div style="position: absolute; top: 22053px; left: 87px;"><nobr>ATA bus were those of the ISA bus. As time has progressed the performance of the ATA devices have far </nobr></div>
<div style="position: absolute; top: 22070px; left: 87px;"><nobr>exceeded the capabilities of the ISA bus. The majority of Host adapters now reside on the PCI bus and the Host </nobr></div>
<div style="position: absolute; top: 22088px; left: 87px;"><nobr>adapters have become more complex involving timing and protocol conversions as a very minimum. An ATA </nobr></div>
<div style="position: absolute; top: 22105px; left: 87px;"><nobr>Host adapter can be engineered to work on many host buses. This standard is limited to the original ISA bus </nobr></div>
<div style="position: absolute; top: 22122px; left: 87px;"><nobr>and the PCI bus.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 22150px; left: 65px;"><nobr><b>4.2 Adapter Modes</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 22175px; left: 75px;"><nobr><b>4.2.1 Legacy Mode</b></nobr></div>
<div style="position: absolute; top: 22206px; left: 87px;"><nobr>An adapter is in Legacy Mode when the control of the transfer is through the ATA Command and Control Block </nobr></div>
<div style="position: absolute; top: 22223px; left: 87px;"><nobr>Registers including the IO mapped registers. Any data transfers are via PIO mode through the Data register. </nobr></div>
<div style="position: absolute; top: 22240px; left: 87px;"><nobr>The addresses of the Command or Control block are configurable in this mode.</nobr></div>
<div style="position: absolute; top: 22262px; left: 87px;"><nobr><b>4.2.1.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 22263px; left: 136px;"><nobr><b>Compatibility Mode</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 22288px; left: 87px;"><nobr>An adapter is in Compatibility Mode when the control of the transfer is through the ATA Command and Control </nobr></div>
<div style="position: absolute; top: 22305px; left: 87px;"><nobr>Block Registers and registers in the adapter. The addresses of the Command or Control block are defined as </nobr></div>
<div style="position: absolute; top: 22322px; left: 87px;"><nobr>well as the host’s interrupt lines (IRQs). Table 1 defines the four standard I/O address banks.</nobr></div>
<div style="position: absolute; top: 22367px; left: 237px;"><nobr><b>Table 1 – Compatibility Mode Standard I/O Register Addresses</b></nobr></div>
<div style="position: absolute; top: 22401px; left: 134px;"><nobr>Channel</nobr></div>
<div style="position: absolute; top: 22401px; left: 249px;"><nobr>Command Block Registers</nobr></div>
<div style="position: absolute; top: 22401px; left: 449px;"><nobr>Control Block Register</nobr></div>
<div style="position: absolute; top: 22401px; left: 628px;"><nobr>IRQ</nobr></div>
<div style="position: absolute; top: 22401px; left: 701px;"><nobr>Alternate IRQ</nobr></div>
<div style="position: absolute; top: 22430px; left: 135px;"><nobr>Primary</nobr></div>
<div style="position: absolute; top: 22430px; left: 304px;"><nobr>IF0h-1F7h</nobr></div>
<div style="position: absolute; top: 22430px; left: 503px;"><nobr>3F6h*</nobr></div>
<div style="position: absolute; top: 22430px; left: 632px;"><nobr>14</nobr></div>
<div style="position: absolute; top: 22430px; left: 728px;"><nobr>None</nobr></div>
<div style="position: absolute; top: 22458px; left: 126px;"><nobr>Secondary</nobr></div>
<div style="position: absolute; top: 22458px; left: 303px;"><nobr>170h-177h</nobr></div>
<div style="position: absolute; top: 22458px; left: 503px;"><nobr>376h*</nobr></div>
<div style="position: absolute; top: 22458px; left: 632px;"><nobr>15</nobr></div>
<div style="position: absolute; top: 22458px; left: 728px;"><nobr>None</nobr></div>
<div style="position: absolute; top: 22485px; left: 136px;"><nobr>Tertiary</nobr></div>
<div style="position: absolute; top: 22485px; left: 299px;"><nobr>1E8h-1EFh</nobr></div>
<div style="position: absolute; top: 22485px; left: 504px;"><nobr>3EEh</nobr></div>
<div style="position: absolute; top: 22485px; left: 632px;"><nobr>11</nobr></div>
<div style="position: absolute; top: 22485px; left: 722px;"><nobr>12 or 9</nobr></div>
<div style="position: absolute; top: 22512px; left: 125px;"><nobr>Quaternary</nobr></div>
<div style="position: absolute; top: 22512px; left: 302px;"><nobr>168h-16Fh</nobr></div>
<div style="position: absolute; top: 22512px; left: 505px;"><nobr>36Eh</nobr></div>
<div style="position: absolute; top: 22512px; left: 632px;"><nobr>10</nobr></div>
<div style="position: absolute; top: 22512px; left: 722px;"><nobr>12 or 9</nobr></div>
<div style="position: absolute; top: 22536px; left: 95px;"><nobr>*NOTE- The Control Block registers were originally defined to include a second register at 3F7h and 377h. </nobr></div>
<div style="position: absolute; top: 22553px; left: 95px;"><nobr>This register address was shared with the Floppy Disk adapter on the AT architecture. The floppy drive </nobr></div>
<div style="position: absolute; top: 22570px; left: 95px;"><nobr>uses bit 7 of that register; the device used bits 0-6. This register is no longer used in the ATA standard.</nobr></div>
<div style="position: absolute; top: 22595px; left: 87px;"><nobr><b>4.2.1.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 22596px; left: 136px;"><nobr><b>PCI-Native Mode</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 22621px; left: 87px;"><nobr>This mode is only applicable to adapters bridging to the PCI bus. In this mode the control of the transfer is </nobr></div>
<div style="position: absolute; top: 22638px; left: 87px;"><nobr>through the ATA Command and Control Block Registers and registers in the adapter. The addresses of the </nobr></div>
<div style="position: absolute; top: 22655px; left: 87px;"><nobr>Command or Control block are defined in the Base Address Register (BAR) of the adapter and are defined by </nobr></div>
</span></font>

<div style="position: absolute; top: 22747px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="22"><b>Page 22</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23886px; left: 689px;"><nobr>Page 8</nobr></div>
<div style="position: absolute; top: 22823px; left: 87px;"><nobr>the Host software. There is only one Host interrupt line for all the channels attached to an adapter.  There is no </nobr></div>
<div style="position: absolute; top: 22841px; left: 87px;"><nobr>restriction on the number of adapters there can be in the system.</nobr></div>
<div style="position: absolute; top: 22871px; left: 75px;"><nobr><b>4.2.2 ADMA Mode</b></nobr></div>
<div style="position: absolute; top: 22901px; left: 87px;"><nobr>In this mode the ATA Command and Control Block registers are not accessible to the Host. Control is exercised </nobr></div>
<div style="position: absolute; top: 22919px; left: 87px;"><nobr>through a data structure held in host memory and adapter registers.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 22935px; left: 54px;"><nobr><b>5 ISA Bus Adapter</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 22966px; left: 87px;"><nobr>This type of adapter is commonly called a paddle card for use in PC compatible systems. The function of the </nobr></div>
<div style="position: absolute; top: 22984px; left: 87px;"><nobr>adapter is to decode the I/O addresses appropriate to the channels it controls.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23011px; left: 65px;"><nobr><b>5.1 Mode of Operation</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23036px; left: 87px;"><nobr>Only operates in Compatibility Mode.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23065px; left: 65px;"><nobr><b>5.2 Detection</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23092px; left: 87px;"><nobr>There is no standard method to detect the presence of this type of adapter. Software may be able to detect the </nobr></div>
<div style="position: absolute; top: 23108px; left: 87px;"><nobr>presence of ATA drives by examining the ATA registers at the standard I/O addresses and thereby infer the </nobr></div>
<div style="position: absolute; top: 23126px; left: 87px;"><nobr>presence of an adapter.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23154px; left: 65px;"><nobr><b>5.3 Adapter Set Up</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23180px; left: 87px;"><nobr>There is no standard method used to set up these adapters. In most cases the I/O address banks are set by </nobr></div>
<div style="position: absolute; top: 23197px; left: 87px;"><nobr>hard jumpers or by vendor specific registers.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23226px; left: 65px;"><nobr><b>5.4 ATA Bus Timings</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23251px; left: 87px;"><nobr>ISA timings. No programmable timing is available.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23280px; left: 65px;"><nobr><b>5.5 Electrical and Physical</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23305px; left: 87px;"><nobr>The electrical and physical specifications of the ATA bus are defined in the {ATA Standard}; the ISA bus </nobr></div>
<div style="position: absolute; top: 23323px; left: 87px;"><nobr>characteristics are defined in the {ISA Spec}.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23350px; left: 65px;"><nobr><b>5.6 Registers</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23377px; left: 87px;"><nobr>The compatibility register set shall be implemented.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 23393px; left: 54px;"><nobr><b>6 PCI Compatibility and PCI-Native Mode Bus Master Adapters</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23425px; left: 87px;"><nobr>PCI Adapters conforming to this standard may operate in Compatibility or Native-PCI Mode. Some adapters can </nobr></div>
<div style="position: absolute; top: 23441px; left: 87px;"><nobr>be configured to operate in either mode; some are fixed to one of the modes. The mode configuration may be </nobr></div>
<div style="position: absolute; top: 23458px; left: 87px;"><nobr>determined from the PCI Configuration registers.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23487px; left: 65px;"><nobr><b>6.1 Mode of Operation</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23511px; left: 75px;"><nobr><b>6.1.1 Compatibility Mode</b></nobr></div>
<div style="position: absolute; top: 23543px; left: 87px;"><nobr>Adapters operating in Compatibility Mode support two channels conforming to the Primary and Secondary </nobr></div>
<div style="position: absolute; top: 23560px; left: 87px;"><nobr>channel address and have a separate IRQ for each channel.</nobr></div>
<div style="position: absolute; top: 23581px; left: 75px;"><nobr><b>6.1.2 PCI-Native Mode</b></nobr></div>
<div style="position: absolute; top: 23612px; left: 87px;"><nobr>Adapters operating in Compatibility Mode may support one or two channels.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23640px; left: 65px;"><nobr><b>6.2 Detection</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23666px; left: 87px;"><nobr>The Class Code fields determine the capabilities. </nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23694px; left: 65px;"><nobr><b>6.3 Adapter Set Up</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23720px; left: 87px;"><nobr>The Class Code fields determine the capabilities of an adapter and may be used to configure the channels to </nobr></div>
<div style="position: absolute; top: 23737px; left: 87px;"><nobr>Compatibility or PCI-Native mode. The PCI BARs may be used to configure and determine the I/O addresses to </nobr></div>
<div style="position: absolute; top: 23755px; left: 87px;"><nobr>use to access the ATA and adapter registers.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 23782px; left: 65px;"><nobr><b>6.4 ATA Bus Timings</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23809px; left: 87px;"><nobr>Determination of the ATA PIO timings, DMA protocols and DMA timings supported is vendor specific. </nobr></div>
<div style="position: absolute; top: 23826px; left: 87px;"><nobr>Consequently configuring these attributes is vendor specific.</nobr></div>
</span></font>

<div style="position: absolute; top: 23935px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="23"><b>Page 23</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 23989px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 25074px; left: 87px;"><nobr>Page 9</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 24010px; left: 65px;"><nobr><b>6.5 Electrical and Physical</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 24035px; left: 87px;"><nobr>The electrical and physical specifications of the ATA bus are defined in the {ATA Standard}; the PCI bus </nobr></div>
<div style="position: absolute; top: 24053px; left: 87px;"><nobr>characteristics are defined in the {PCI SPEC} specification.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 24081px; left: 65px;"><nobr><b>6.6 PCI Registers</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 24111px; left: 87px;"><nobr>The PCI Adapter implements a subset of the PCI standard type 00h configuration header register set. All </nobr></div>
<div style="position: absolute; top: 24128px; left: 87px;"><nobr>registers have the standard meaning as defined in the PCI Specification, Issue 2.2. The registers with specific </nobr></div>
<div style="position: absolute; top: 24145px; left: 87px;"><nobr>meanings with respect to this standard are defined below. Register contents that are otherwise defined in the </nobr></div>
<div style="position: absolute; top: 24163px; left: 87px;"><nobr>PCI standard are indicates as “PCI”. Fields marked 'reserved' are all zeros and read only.</nobr></div>
<div style="position: absolute; top: 24197px; left: 125px;"><nobr><b>Table 2 – PCI Compatibility and PCI-Native Mode Bus Master Adapters Configuration Registers</b></nobr></div>
<div style="position: absolute; top: 24231px; left: 135px;"><nobr>Byte Offset</nobr></div>
<div style="position: absolute; top: 24231px; left: 243px;"><nobr>Bits 31-24</nobr></div>
<div style="position: absolute; top: 24231px; left: 368px;"><nobr>Bits 23-16</nobr></div>
<div style="position: absolute; top: 24231px; left: 521px;"><nobr>Bits 15-8</nobr></div>
<div style="position: absolute; top: 24231px; left: 686px;"><nobr>Bits 7-0</nobr></div>
<div style="position: absolute; top: 24262px; left: 133px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 24262px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24289px; left: 133px;"><nobr>04h</nobr></div>
<div style="position: absolute; top: 24289px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24316px; left: 133px;"><nobr>08h</nobr></div>
<div style="position: absolute; top: 24316px; left: 227px;"><nobr>Class Code</nobr></div>
<div style="position: absolute; top: 24316px; left: 639px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24344px; left: 133px;"><nobr>0Ch</nobr></div>
<div style="position: absolute; top: 24344px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24371px; left: 133px;"><nobr>10h</nobr></div>
<div style="position: absolute; top: 24371px; left: 227px;"><nobr>Base Address 0 -- Base Address of Cmd-Block Regs, ATA Channel X</nobr></div>
<div style="position: absolute; top: 24398px; left: 133px;"><nobr>14h</nobr></div>
<div style="position: absolute; top: 24398px; left: 227px;"><nobr>Base Address 1 -- Base Address of Control Regs, ATA Channel X</nobr></div>
<div style="position: absolute; top: 24426px; left: 133px;"><nobr>18h</nobr></div>
<div style="position: absolute; top: 24426px; left: 227px;"><nobr>Base Address 2 -- Base Address of Cmd-Block Regs, ATA Channel Y</nobr></div>
<div style="position: absolute; top: 24453px; left: 133px;"><nobr>1Ch</nobr></div>
<div style="position: absolute; top: 24453px; left: 227px;"><nobr>Base Address 3 -- Base Address of Control Regs, ATA Channel Y</nobr></div>
<div style="position: absolute; top: 24480px; left: 133px;"><nobr>20h</nobr></div>
<div style="position: absolute; top: 24480px; left: 227px;"><nobr>Base Address 4 -- Base Address of ATA Bus Master Registers</nobr></div>
<div style="position: absolute; top: 24508px; left: 133px;"><nobr>24h</nobr></div>
<div style="position: absolute; top: 24508px; left: 227px;"><nobr>Base Address 5 – Vendor Specific</nobr></div>
<div style="position: absolute; top: 24535px; left: 133px;"><nobr>28h</nobr></div>
<div style="position: absolute; top: 24535px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24562px; left: 133px;"><nobr>2Ch</nobr></div>
<div style="position: absolute; top: 24562px; left: 227px;"><nobr>Subsystem ID</nobr></div>
<div style="position: absolute; top: 24562px; left: 477px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24590px; left: 133px;"><nobr>30h</nobr></div>
<div style="position: absolute; top: 24590px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24617px; left: 133px;"><nobr>34h</nobr></div>
<div style="position: absolute; top: 24617px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24644px; left: 133px;"><nobr>38h</nobr></div>
<div style="position: absolute; top: 24644px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24672px; left: 133px;"><nobr>3Ch</nobr></div>
<div style="position: absolute; top: 24672px; left: 227px;"><nobr>PCI</nobr></div>
<div style="position: absolute; top: 24672px; left: 639px;"><nobr>Interrupt Line</nobr></div>
<div style="position: absolute; top: 24718px; left: 75px;"><nobr><b>6.6.1 PCI Class Code</b></nobr></div>
<div style="position: absolute; top: 24741px; left: 87px;"><nobr>Address Offset 09h</nobr></div>
<div style="position: absolute; top: 24758px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 24758px; left: 216px;"><nobr>24 bits</nobr></div>
<div style="position: absolute; top: 24793px; left: 134px;"><nobr><b>Table 3 – PCI Compatibility and PCI-Native Mode Bus Master Adapters Class Code Registers</b></nobr></div>
<div style="position: absolute; top: 24827px; left: 181px;"><nobr>Byte Offset</nobr></div>
<div style="position: absolute; top: 24827px; left: 359px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 24827px; left: 531px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 24827px; left: 667px;"><nobr>Value</nobr></div>
<div style="position: absolute; top: 24857px; left: 162px;"><nobr>09h</nobr></div>
<div style="position: absolute; top: 24857px; left: 290px;"><nobr>Programming Interface Code</nobr></div>
<div style="position: absolute; top: 24857px; left: 516px;"><nobr>See Table 4</nobr></div>
<div style="position: absolute; top: 24857px; left: 617px;"><nobr>See Table 4</nobr></div>
<div style="position: absolute; top: 24884px; left: 162px;"><nobr>0Ah</nobr></div>
<div style="position: absolute; top: 24884px; left: 290px;"><nobr>Sub-class Code</nobr></div>
<div style="position: absolute; top: 24884px; left: 516px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 24884px; left: 617px;"><nobr>01h – IDE</nobr></div>
<div style="position: absolute; top: 24912px; left: 162px;"><nobr>0Bh</nobr></div>
<div style="position: absolute; top: 24912px; left: 290px;"><nobr>Base-Class Code</nobr></div>
<div style="position: absolute; top: 24912px; left: 516px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 24912px; left: 617px;"><nobr>01h – Mass Storage</nobr></div>
<div style="position: absolute; top: 24946px; left: 87px;"><nobr><b>6.6.1.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 24947px; left: 136px;"><nobr><b>Programming Interface Code</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 24971px; left: 87px;"><nobr>Table 4 defines the usage and values of the Programming and Interface Byte.</nobr></div>
</span></font>

<div style="position: absolute; top: 25123px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="24"><b>Page 24</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 26262px; left: 681px;"><nobr>Page 10</nobr></div>
<div style="position: absolute; top: 25199px; left: 218px;"><nobr><b>Table 4 – PCI Adapter bit definitions in Programming Interface Byte</b></nobr></div>
<div style="position: absolute; top: 25234px; left: 173px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 25234px; left: 242px;"><nobr>Read/write</nobr></div>
<div style="position: absolute; top: 25234px; left: 516px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 25315px; left: 178px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 25306px; left: 225px;"><nobr>Implementation </nobr></div>
<div style="position: absolute; top: 25322px; left: 225px;"><nobr>dependent</nobr></div>
<div style="position: absolute; top: 25263px; left: 344px;"><nobr>Determines the mode that the primary ATA channel is </nobr></div>
<div style="position: absolute; top: 25280px; left: 344px;"><nobr>operating in.  Clearing this bit to zero corresponds to </nobr></div>
<div style="position: absolute; top: 25298px; left: 344px;"><nobr>'compatibility', setting the bit to one means PCI-native mode.  </nobr></div>
<div style="position: absolute; top: 25315px; left: 344px;"><nobr>This bit is implemented as read-only if the channel supports </nobr></div>
<div style="position: absolute; top: 25331px; left: 344px;"><nobr>only one mode, or read-write if both modes are supported. For </nobr></div>
<div style="position: absolute; top: 25349px; left: 344px;"><nobr>implementations that support both modes the power on and </nobr></div>
<div style="position: absolute; top: 25366px; left: 344px;"><nobr>hardware reset states are vendor specific.</nobr></div>
<div style="position: absolute; top: 25428px; left: 178px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 25428px; left: 225px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 25393px; left: 344px;"><nobr>This bit indicates whether or not the primary channel has a </nobr></div>
<div style="position: absolute; top: 25411px; left: 344px;"><nobr>fixed mode of operation.  If this bit is cleared to zero, the mode </nobr></div>
<div style="position: absolute; top: 25428px; left: 344px;"><nobr>is fixed and is determined by the read-only value of bit 0.  If </nobr></div>
<div style="position: absolute; top: 25445px; left: 344px;"><nobr>this bit is set to one, the channel supports both modes and </nobr></div>
<div style="position: absolute; top: 25463px; left: 344px;"><nobr>may be set to either mode by writing bit 0.</nobr></div>
<div style="position: absolute; top: 25542px; left: 178px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 25533px; left: 225px;"><nobr>Implementation </nobr></div>
<div style="position: absolute; top: 25550px; left: 225px;"><nobr>dependent</nobr></div>
<div style="position: absolute; top: 25490px; left: 344px;"><nobr>Determines the mode that the secondary ATA channel is </nobr></div>
<div style="position: absolute; top: 25507px; left: 344px;"><nobr>operating in.  Clearing this bit to zero corresponds to </nobr></div>
<div style="position: absolute; top: 25525px; left: 344px;"><nobr>'compatibility', setting the bit to one means PCI-native mode.  </nobr></div>
<div style="position: absolute; top: 25542px; left: 344px;"><nobr>This bit is implemented as read-only if the channel supports </nobr></div>
<div style="position: absolute; top: 25559px; left: 344px;"><nobr>only one mode, or read-write if both modes are supported. For </nobr></div>
<div style="position: absolute; top: 25577px; left: 344px;"><nobr>implementations that support both modes the power on and </nobr></div>
<div style="position: absolute; top: 25594px; left: 344px;"><nobr>hardware reset states are vendor specific.</nobr></div>
<div style="position: absolute; top: 25655px; left: 178px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 25655px; left: 225px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 25621px; left: 344px;"><nobr>This bit indicates whether or not the secondary channel has a </nobr></div>
<div style="position: absolute; top: 25639px; left: 344px;"><nobr>fixed mode of operation.  If this bit is cleared to zero, the mode </nobr></div>
<div style="position: absolute; top: 25655px; left: 344px;"><nobr>is fixed and is determined by the read-only value of bit 2.  If </nobr></div>
<div style="position: absolute; top: 25672px; left: 344px;"><nobr>this bit is set to one, the channel supports both modes and </nobr></div>
<div style="position: absolute; top: 25690px; left: 344px;"><nobr>may be set to either mode by writing bit 2.</nobr></div>
<div style="position: absolute; top: 25717px; left: 172px;"><nobr>4-6</nobr></div>
<div style="position: absolute; top: 25717px; left: 225px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 25717px; left: 344px;"><nobr>Reserved and shall be cleared to zero.</nobr></div>
<div style="position: absolute; top: 25770px; left: 178px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 25770px; left: 225px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 25744px; left: 344px;"><nobr>This bit shall indicate that the adapter can do bus master </nobr></div>
<div style="position: absolute; top: 25761px; left: 344px;"><nobr>operation when it is set to one.  This bit shall indicate that the </nobr></div>
<div style="position: absolute; top: 25779px; left: 344px;"><nobr>adapter is not capable of bus master operation when it is </nobr></div>
<div style="position: absolute; top: 25796px; left: 344px;"><nobr>cleared to 0.</nobr></div>
<div style="position: absolute; top: 25830px; left: 75px;"><nobr><b>6.6.2 PCI Base Address Registers (BAR)</b></nobr></div>
<div style="position: absolute; top: 25861px; left: 87px;"><nobr>Base Address Registers 0-3 have Bit zero hard-wired to one to indicate I/O space.  Initialization of the following </nobr></div>
<div style="position: absolute; top: 25878px; left: 87px;"><nobr>BARs is described in the {PCI Specification}</nobr></div>
<div style="position: absolute; top: 25900px; left: 87px;"><nobr><b>6.6.2.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 25901px; left: 136px;"><nobr><b>PCI Base Address Register (BAR) 0</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 25918px; left: 87px;"><nobr>This is the base address for the command block registers for ATA Channel X.</nobr></div>
<div style="position: absolute; top: 25934px; left: 87px;"><nobr>Address Offset 10h</nobr></div>
<div style="position: absolute; top: 25951px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 25951px; left: 216px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 25978px; left: 87px;"><nobr>When operating in Compatibility Mode any write to the BAR shall be ignored and the value 1F0h shall always be </nobr></div>
<div style="position: absolute; top: 25995px; left: 87px;"><nobr>used. In Compatibility Mode an independent IRQ shall be provided that is connected to IRQ14. When the </nobr></div>
<div style="position: absolute; top: 26012px; left: 87px;"><nobr>adapter is disabled by using the I/O Enable bit in the PCI Command register, the adapter shall not respond to </nobr></div>
<div style="position: absolute; top: 26030px; left: 87px;"><nobr>any I/O addresses, and shall release its IRQ connections.</nobr></div>
<div style="position: absolute; top: 26051px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 26051px; left: 195px;"><nobr>Bits 31-16 may be Read Only, Bits 15-3 Read/Write, Bits 2-0 Read Only</nobr></div>
<div style="position: absolute; top: 26068px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 26068px; left: 216px;"><nobr>32 bits</nobr></div>
</span></font>

<div style="position: absolute; top: 26311px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="25"><b>Page 25</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 26365px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 27450px; left: 87px;"><nobr>Page 11</nobr></div>
<div style="position: absolute; top: 26387px; left: 87px;"><nobr><b>6.6.2.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 26388px; left: 136px;"><nobr><b>PCI Base Address Register (BAR) 1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 26404px; left: 87px;"><nobr>This is the base address for the control register for ATA Channel X.  Note that because of the Dword alignment </nobr></div>
<div style="position: absolute; top: 26422px; left: 87px;"><nobr>of PCI, the Device Control and Alternate Status Registers are at offset 02h from this base.</nobr></div>
<div style="position: absolute; top: 26438px; left: 87px;"><nobr>For example, to put those registers at address 3F6h, this register shall be set to 3F4h (+ Bit 0).</nobr></div>
<div style="position: absolute; top: 26455px; left: 87px;"><nobr>Address Offset 14h</nobr></div>
<div style="position: absolute; top: 26473px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 26473px; left: 216px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 26490px; left: 87px;"><nobr>When operating in Compatibility Mode any write to the BAR shall be ignored and the value 3F5h always be </nobr></div>
<div style="position: absolute; top: 26507px; left: 87px;"><nobr>used. </nobr></div>
<div style="position: absolute; top: 26525px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 26525px; left: 195px;"><nobr>Bits 31-16 may be Read Only, Bits 15-2 Read/Write, Bits 1-0 Read Only.</nobr></div>
<div style="position: absolute; top: 26542px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 26542px; left: 216px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 26563px; left: 87px;"><nobr><b>6.6.2.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 26564px; left: 136px;"><nobr><b>PCI Base Address Register (BAR) 2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 26580px; left: 87px;"><nobr>If the device implements two channels this is the base address for the command block registers for ATA </nobr></div>
<div style="position: absolute; top: 26598px; left: 87px;"><nobr>Channel Y. If the device only supports one channel this base address is read only and cleared to zero,</nobr></div>
<div style="position: absolute; top: 26615px; left: 87px;"><nobr>Address Offset 18h</nobr></div>
<div style="position: absolute; top: 26632px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 26632px; left: 216px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 26650px; left: 87px;"><nobr>When operating in Compatibility Mode any write to the BAR shall be ignored and the value 170h shall always be </nobr></div>
<div style="position: absolute; top: 26667px; left: 87px;"><nobr>used. In Compatibility Mode an independent IRQ shall be provided that is connected to IRQ15. When the </nobr></div>
<div style="position: absolute; top: 26684px; left: 87px;"><nobr>adapter is disabled  by using the I/O Enable bit in the PCI Command register, the adapter shall not respond to </nobr></div>
<div style="position: absolute; top: 26702px; left: 87px;"><nobr>any I/O addresses, and shall release its IRQ connections</nobr></div>
<div style="position: absolute; top: 26719px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 26719px; left: 195px;"><nobr>Bits 31-16 may be Read Only; Bits15-3 Read/Write; Bits 2-0 Read Only.</nobr></div>
<div style="position: absolute; top: 26735px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 26735px; left: 216px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 26758px; left: 87px;"><nobr><b>6.6.2.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 26759px; left: 136px;"><nobr><b>PCI Base Address Register (BAR) 3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 26775px; left: 87px;"><nobr>If the device implements two channels this is the base address for the control registers for ATA Channel Y. If the </nobr></div>
<div style="position: absolute; top: 26792px; left: 87px;"><nobr>device only supports one channel this base address is read only and cleared to zero.  Note that because of the </nobr></div>
<div style="position: absolute; top: 26809px; left: 87px;"><nobr>Dword alignment of PCI, the Device Control and Alternate Status Registers are at offset 02h from this base.</nobr></div>
<div style="position: absolute; top: 26827px; left: 87px;"><nobr>Address Offset 1Ch</nobr></div>
<div style="position: absolute; top: 26843px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 26843px; left: 216px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 26860px; left: 87px;"><nobr>When operating in Compatibility Mode any write to the BAR shall be ignored and the value 376h shall always be </nobr></div>
<div style="position: absolute; top: 26878px; left: 87px;"><nobr>used. </nobr></div>
<div style="position: absolute; top: 26895px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 26895px; left: 195px;"><nobr>Bits 31-16 may be Read Only, Bits 15-2 Read/Write, Bits 1-0 Read Only.</nobr></div>
<div style="position: absolute; top: 26912px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 26912px; left: 216px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 26935px; left: 87px;"><nobr><b>6.6.2.5</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 26936px; left: 136px;"><nobr><b>PCI Base Address Register (BAR) 4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 26951px; left: 87px;"><nobr>Base address of the ATA Bus Master I/O registers.</nobr></div>
<div style="position: absolute; top: 26968px; left: 87px;"><nobr>Address Offset 20h</nobr></div>
<div style="position: absolute; top: 26985px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 26985px; left: 216px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 27003px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 27003px; left: 195px;"><nobr>Bits 31-16 may be Read Only, Bits 15-3 Read/Write, Bits 2-0 Read Only.</nobr></div>
<div style="position: absolute; top: 27020px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 27020px; left: 216px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 27041px; left: 87px;"><nobr><b>6.6.2.6</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 27042px; left: 136px;"><nobr><b>PCI Base Address Register (BAR) 5</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 27067px; left: 87px;"><nobr>This is a vendor specific BAR</nobr></div>
<div style="position: absolute; top: 27094px; left: 75px;"><nobr><b>6.6.3 PCI Interrupt Line</b></nobr></div>
<div style="position: absolute; top: 27125px; left: 87px;"><nobr>The host BIOS and host software may use this location to store the system interrupt (IRQ) allocated to this </nobr></div>
<div style="position: absolute; top: 27142px; left: 87px;"><nobr>device. The adapter does not use this information. BIOS and host software may use this location to store the </nobr></div>
<div style="position: absolute; top: 27160px; left: 87px;"><nobr>information.</nobr></div>
<div style="position: absolute; top: 27176px; left: 87px;"><nobr>Address Offset 3Ch</nobr></div>
<div style="position: absolute; top: 27193px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 27193px; left: 216px;"><nobr>00h</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 27222px; left: 65px;"><nobr><b>6.7 ATA Bus Master Registers</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 27247px; left: 87px;"><nobr>The bus master -ATA function uses 16 bytes of I/O space.  All bus master -ATA I/O space registers can be </nobr></div>
<div style="position: absolute; top: 27265px; left: 87px;"><nobr>accessed as byte, word, or Dword quantities. The base address for these registers is PCI BAR 4.  The </nobr></div>
<div style="position: absolute; top: 27282px; left: 87px;"><nobr>description of the 16 bytes of I/O registers follows:</nobr></div>
</span></font>

<div style="position: absolute; top: 27499px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="26"><b>Page 26</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 28638px; left: 681px;"><nobr>Page 12</nobr></div>
<div style="position: absolute; top: 27575px; left: 311px;"><nobr><b>Table 5 – ATA Bus Master Register Offsets</b></nobr></div>
<div style="position: absolute; top: 27610px; left: 108px;"><nobr><b>Offset from Base Address</b></nobr></div>
<div style="position: absolute; top: 27610px; left: 452px;"><nobr><b>Register</b></nobr></div>
<div style="position: absolute; top: 27610px; left: 674px;"><nobr><b>RegisterAccess (1,2)</b></nobr></div>
<div style="position: absolute; top: 27639px; left: 185px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 27639px; left: 315px;"><nobr>ATA Bus Master Command register Primary </nobr></div>
<div style="position: absolute; top: 27639px; left: 730px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 27666px; left: 185px;"><nobr>01h</nobr></div>
<div style="position: absolute; top: 27666px; left: 315px;"><nobr>Device Specific</nobr></div>
<div style="position: absolute; top: 27694px; left: 185px;"><nobr>02h</nobr></div>
<div style="position: absolute; top: 27694px; left: 315px;"><nobr>ATA Bus Master Status register Primary </nobr></div>
<div style="position: absolute; top: 27694px; left: 727px;"><nobr>RWC</nobr></div>
<div style="position: absolute; top: 27721px; left: 185px;"><nobr>03h</nobr></div>
<div style="position: absolute; top: 27721px; left: 315px;"><nobr>Device Specific</nobr></div>
<div style="position: absolute; top: 27748px; left: 171px;"><nobr>04h-07h</nobr></div>
<div style="position: absolute; top: 27748px; left: 315px;"><nobr>ATA Bus Master PRD Table Address Primary </nobr></div>
<div style="position: absolute; top: 27748px; left: 730px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 27776px; left: 185px;"><nobr>08h</nobr></div>
<div style="position: absolute; top: 27776px; left: 315px;"><nobr>ATA Bus Master Command register Secondary </nobr></div>
<div style="position: absolute; top: 27776px; left: 730px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 27803px; left: 185px;"><nobr>09h</nobr></div>
<div style="position: absolute; top: 27803px; left: 315px;"><nobr>Device Specific</nobr></div>
<div style="position: absolute; top: 27830px; left: 183px;"><nobr>0Ah</nobr></div>
<div style="position: absolute; top: 27830px; left: 315px;"><nobr>ATA Bus Master Status register Secondary </nobr></div>
<div style="position: absolute; top: 27830px; left: 727px;"><nobr>RWC</nobr></div>
<div style="position: absolute; top: 27858px; left: 183px;"><nobr>0Bh</nobr></div>
<div style="position: absolute; top: 27858px; left: 315px;"><nobr>Device Specific</nobr></div>
<div style="position: absolute; top: 27885px; left: 169px;"><nobr>0Ch-0Fh</nobr></div>
<div style="position: absolute; top: 27885px; left: 315px;"><nobr>ATA Bus Master PRD Table Address Secondary </nobr></div>
<div style="position: absolute; top: 27885px; left: 730px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 27912px; left: 95px;"><nobr>Notes:</nobr></div>
<div style="position: absolute; top: 27939px; left: 122px;"><nobr>1) R/W means that the bit may be both written and read.</nobr></div>
<div style="position: absolute; top: 27965px; left: 122px;"><nobr>2) RWC means that the bit may be read. If set it is cleared by writing a 1</nobr></div>
<div style="position: absolute; top: 27999px; left: 75px;"><nobr><b>6.7.1 ATA Bus Master Command Register</b></nobr></div>
<div style="position: absolute; top: 28030px; left: 87px;"><nobr>Register Name: ATA Bus Master Command Register</nobr></div>
<div style="position: absolute; top: 28056px; left: 87px;"><nobr>Address Offset: Primary Channel: </nobr></div>
<div style="position: absolute; top: 28056px; left: 345px;"><nobr>Base + 00h</nobr></div>
<div style="position: absolute; top: 28082px; left: 195px;"><nobr>Secondary Channel:</nobr></div>
<div style="position: absolute; top: 28082px; left: 345px;"><nobr>Base + 08h (for adapters that do not support this channel these registers </nobr></div>
<div style="position: absolute; top: 28100px; left: 87px;"><nobr>shall return zero when read).</nobr></div>
<div style="position: absolute; top: 28126px; left: 87px;"><nobr>Default Value: 00h</nobr></div>
<div style="position: absolute; top: 28152px; left: 87px;"><nobr>Attribute:</nobr></div>
<div style="position: absolute; top: 28152px; left: 195px;"><nobr>Read / Write</nobr></div>
<div style="position: absolute; top: 28179px; left: 87px;"><nobr>Size:</nobr></div>
<div style="position: absolute; top: 28179px; left: 195px;"><nobr>8 bits</nobr></div>
</span></font>

<div style="position: absolute; top: 28687px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="27"><b>Page 27</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 28741px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 29826px; left: 87px;"><nobr>Page 13</nobr></div>
<div style="position: absolute; top: 28763px; left: 298px;"><nobr><b>Table 6 – ATA Bus Master Command Register</b></nobr></div>
<div style="position: absolute; top: 28798px; left: 151px;"><nobr><b>Bit</b></nobr></div>
<div style="position: absolute; top: 28798px; left: 439px;"><nobr><b>Description.</b></nobr></div>
<div style="position: absolute; top: 28827px; left: 146px;"><nobr>7-4</nobr></div>
<div style="position: absolute; top: 28827px; left: 190px;"><nobr>Shall return zero on reads.</nobr></div>
<div style="position: absolute; top: 28880px; left: 146px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 28854px; left: 190px;"><nobr><b>Read or Write Control: </b>This bit sets the direction of the bus master transfer: when </nobr></div>
<div style="position: absolute; top: 28872px; left: 190px;"><nobr>cleared to zero, PCI bus master reads are performed. When set to one, PCI bus master </nobr></div>
<div style="position: absolute; top: 28889px; left: 190px;"><nobr>writes are performed. This bit shall NOT be changed when the bus master function is </nobr></div>
<div style="position: absolute; top: 28906px; left: 190px;"><nobr>active.</nobr></div>
<div style="position: absolute; top: 28934px; left: 146px;"><nobr>2-1</nobr></div>
<div style="position: absolute; top: 28934px; left: 190px;"><nobr><b>Shall </b>return zero on reads.</nobr></div>
<div style="position: absolute; top: 29090px; left: 146px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 28961px; left: 190px;"><nobr><b>Start/Stop Bus Master: </b>Bus master operation of the adapter is enabled by setting this </nobr></div>
<div style="position: absolute; top: 28978px; left: 190px;"><nobr>bit to one. Bus master operation begins when this bit is detected changing from a zero </nobr></div>
<div style="position: absolute; top: 28996px; left: 190px;"><nobr>to a one. The adapter shall only transfer data between the ATA device and host </nobr></div>
<div style="position: absolute; top: 29012px; left: 190px;"><nobr>memory when this bit is set to one.  Master operation may be halted by clearing this bit </nobr></div>
<div style="position: absolute; top: 29029px; left: 190px;"><nobr>to zero.  All state information is lost when a zero is written; Master mode operation </nobr></div>
<div style="position: absolute; top: 29047px; left: 190px;"><nobr>cannot be stopped and then resumed.</nobr></div>
<div style="position: absolute; top: 29073px; left: 190px;"><nobr>If this bit is cleared to zero while bus master operation is still active the bus master </nobr></div>
<div style="position: absolute; top: 29090px; left: 190px;"><nobr>command is aborted and data transferred from the device may be discarded before </nobr></div>
<div style="position: absolute; top: 29108px; left: 190px;"><nobr>being written to host memory. In any event the adapter should terminate any DMA burst </nobr></div>
<div style="position: absolute; top: 29125px; left: 190px;"><nobr>in progress compliant with the ATA protocol being used. If the UDMA protocol is being </nobr></div>
<div style="position: absolute; top: 29142px; left: 190px;"><nobr>used there may be a CRC error report. The ATA device may be in an indeterminate </nobr></div>
<div style="position: absolute; top: 29160px; left: 190px;"><nobr>state.</nobr></div>
<div style="position: absolute; top: 29186px; left: 195px;"><nobr>This bit is intended to be cleared to zero after the data transfer is completed, as </nobr></div>
<div style="position: absolute; top: 29203px; left: 190px;"><nobr>indicated by either the Bus Master ATA Active bit or the Interrupt bit of the Bus Master </nobr></div>
<div style="position: absolute; top: 29221px; left: 190px;"><nobr>ATA Status register for that ATA channel being set to one, or both.</nobr></div>
<div style="position: absolute; top: 29250px; left: 75px;"><nobr><b>6.7.2 Adapter Bus Master Status Register</b></nobr></div>
<div style="position: absolute; top: 29280px; left: 87px;"><nobr>Register Name:</nobr></div>
<div style="position: absolute; top: 29280px; left: 216px;"><nobr>Bus Master ATA Status Register</nobr></div>
<div style="position: absolute; top: 29307px; left: 87px;"><nobr>Address Offset:</nobr></div>
<div style="position: absolute; top: 29307px; left: 216px;"><nobr>Primary Channel:</nobr></div>
<div style="position: absolute; top: 29307px; left: 368px;"><nobr>Base + 02h</nobr></div>
<div style="position: absolute; top: 29333px; left: 216px;"><nobr>Secondary Channel:</nobr></div>
<div style="position: absolute; top: 29333px; left: 368px;"><nobr>Base + 0Ah (for adapters that do not support this channel these </nobr></div>
<div style="position: absolute; top: 29350px; left: 87px;"><nobr>registers shall return zero when read).</nobr></div>
<div style="position: absolute; top: 29376px; left: 87px;"><nobr>Default Value:</nobr></div>
<div style="position: absolute; top: 29376px; left: 216px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 29403px; left: 87px;"><nobr>Attribute:</nobr></div>
<div style="position: absolute; top: 29403px; left: 216px;"><nobr>Read/Write Clear</nobr></div>
<div style="position: absolute; top: 29429px; left: 87px;"><nobr>Size:</nobr></div>
<div style="position: absolute; top: 29429px; left: 216px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 29473px; left: 313px;"><nobr><b>Table 7 – Bus Master ATA Status Register</b></nobr></div>
<div style="position: absolute; top: 29507px; left: 151px;"><nobr><b>Bit</b></nobr></div>
<div style="position: absolute; top: 29507px; left: 441px;"><nobr><b>Description</b></nobr></div>
<div style="position: absolute; top: 29584px; left: 156px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 29537px; left: 190px;"><nobr><b>Simplex only: </b>This read-only bit indicates whether or not both bus master channels </nobr></div>
<div style="position: absolute; top: 29554px; left: 190px;"><nobr>(primary and secondary) can be operated at the same time.  If the bit is a zero, then the </nobr></div>
<div style="position: absolute; top: 29572px; left: 190px;"><nobr>channels operate independently and can be used at the same time.  If the bit is a one, </nobr></div>
<div style="position: absolute; top: 29588px; left: 190px;"><nobr>then only one channel may be used at a time. </nobr></div>
<div style="position: absolute; top: 29614px; left: 190px;"><nobr><b>NOTE - </b>Some vendors use this bit in a vendor specific manner when special features </nobr></div>
<div style="position: absolute; top: 29632px; left: 190px;"><nobr>are enabled.</nobr></div>
<div style="position: absolute; top: 29676px; left: 156px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 29659px; left: 190px;"><nobr><b>Device 1 DMA Capable: </b>This read/write bit is set by device dependent code (BIOS or </nobr></div>
<div style="position: absolute; top: 29676px; left: 190px;"><nobr>host software) to indicate that Device one for this channel is capable of DMA transfers, </nobr></div>
<div style="position: absolute; top: 29694px; left: 190px;"><nobr>and that the adapter has been initialized for optimum performance.</nobr></div>
<div style="position: absolute; top: 29738px; left: 156px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 29721px; left: 190px;"><nobr><b>Device 0 DMA Capable: </b>This read/write bit is set by device dependent code (BIOS or </nobr></div>
<div style="position: absolute; top: 29738px; left: 190px;"><nobr>host software) to indicate that Device zero for this channel is capable of DMA transfers, </nobr></div>
<div style="position: absolute; top: 29756px; left: 190px;"><nobr>and that the adapter has been initialized for optimum performance.</nobr></div>
<div style="position: absolute; top: 29783px; left: 150px;"><nobr>4-3</nobr></div>
<div style="position: absolute; top: 29783px; left: 190px;"><nobr><b>Reserved.  </b>Must return zero on reads.</nobr></div>
</span></font>

<div style="position: absolute; top: 29875px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="28"><b>Page 28</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 31014px; left: 681px;"><nobr>Page 14</nobr></div>
<div style="position: absolute; top: 30050px; left: 156px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 29959px; left: 190px;"><nobr><b>Interrupt: </b>This bit shall be set to one by the rising edge of the ATA channel’s interrupt </nobr></div>
<div style="position: absolute; top: 29977px; left: 190px;"><nobr>line (INTRQ).</nobr></div>
<div style="position: absolute; top: 30002px; left: 190px;"><nobr>This bit shall be cleared to zero when a one is written to it by software.  Software can </nobr></div>
<div style="position: absolute; top: 30019px; left: 190px;"><nobr>use this bit to determine if an ATA device has asserted its interrupt line (see ATA </nobr></div>
<div style="position: absolute; top: 30037px; left: 190px;"><nobr>standard). </nobr></div>
<div style="position: absolute; top: 30063px; left: 190px;"><nobr>When this bit is read as a one, all data may have been transferred to the Host’s system </nobr></div>
<div style="position: absolute; top: 30080px; left: 190px;"><nobr>memory. The adapter shall not set this bit to one until it has flushed any internal data </nobr></div>
<div style="position: absolute; top: 30098px; left: 190px;"><nobr>buffers.</nobr></div>
<div style="position: absolute; top: 30124px; left: 190px;"><nobr>NOTE - even if the device status is read, causing the device to deassert INTRQ, this </nobr></div>
<div style="position: absolute; top: 30141px; left: 190px;"><nobr>bit shall be cleared as well.</nobr></div>
<div style="position: absolute; top: 30186px; left: 156px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 30169px; left: 190px;"><nobr><b>Error:  </b>This bit is set when the adapter encounters an error in transferring data to/from </nobr></div>
<div style="position: absolute; top: 30186px; left: 190px;"><nobr>host memory.  The exact error condition is bus specific and can be determined in a bus </nobr></div>
<div style="position: absolute; top: 30203px; left: 190px;"><nobr>specific manner.  This bit is cleared when a one is written to it by software.</nobr></div>
<div style="position: absolute; top: 30308px; left: 156px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 30231px; left: 190px;"><nobr><b>Bus Master -ATA Active: </b>This bit shall be set to one when the Start bit is written to the </nobr></div>
<div style="position: absolute; top: 30248px; left: 190px;"><nobr>ATA Bus Master Command registers.</nobr></div>
<div style="position: absolute; top: 30274px; left: 190px;"><nobr>This bit shall be cleared to zero when the last transfer for a region is performed, where </nobr></div>
<div style="position: absolute; top: 30292px; left: 190px;"><nobr>EOT for that region is set in the region descriptor. It is also cleared when the Start bit is </nobr></div>
<div style="position: absolute; top: 30308px; left: 190px;"><nobr>cleared in the ATA Bus Master Command register.</nobr></div>
<div style="position: absolute; top: 30334px; left: 190px;"><nobr>When this bit is read as a zero, all data transferred from the device during the previous </nobr></div>
<div style="position: absolute; top: 30352px; left: 190px;"><nobr>bus master command has been transferred to the Host’s system memory, unless the </nobr></div>
<div style="position: absolute; top: 30369px; left: 190px;"><nobr>bus master command was aborted.  When this bit is zero all data has been written to </nobr></div>
<div style="position: absolute; top: 30386px; left: 190px;"><nobr>the device</nobr></div>
<div style="position: absolute; top: 30438px; left: 75px;"><nobr><b>6.7.3 Physical Region Descriptor (PRD) Table Pointer Register</b></nobr></div>
<div style="position: absolute; top: 30468px; left: 87px;"><nobr>Register Name:</nobr></div>
<div style="position: absolute; top: 30468px; left: 216px;"><nobr>Descriptor Table Pointer Register</nobr></div>
<div style="position: absolute; top: 30495px; left: 87px;"><nobr>Address Offset:</nobr></div>
<div style="position: absolute; top: 30495px; left: 216px;"><nobr>Primary Channel:</nobr></div>
<div style="position: absolute; top: 30495px; left: 368px;"><nobr>Base + 04h</nobr></div>
<div style="position: absolute; top: 30521px; left: 216px;"><nobr>Secondary Channel:</nobr></div>
<div style="position: absolute; top: 30521px; left: 368px;"><nobr>Base + 0Ch (for adapters that do not support this channel these </nobr></div>
<div style="position: absolute; top: 30538px; left: 87px;"><nobr>registers shall return zero when read).</nobr></div>
<div style="position: absolute; top: 30564px; left: 87px;"><nobr>Default Value:</nobr></div>
<div style="position: absolute; top: 30564px; left: 216px;"><nobr>00000000h</nobr></div>
<div style="position: absolute; top: 30591px; left: 87px;"><nobr>Attribute:</nobr></div>
<div style="position: absolute; top: 30591px; left: 216px;"><nobr>Read / Write</nobr></div>
<div style="position: absolute; top: 30617px; left: 87px;"><nobr>Size:</nobr></div>
<div style="position: absolute; top: 30617px; left: 216px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 30661px; left: 326px;"><nobr><b>Table 8 – PRD Table Pointer Register</b></nobr></div>
<div style="position: absolute; top: 30695px; left: 178px;"><nobr><b>Bit</b></nobr></div>
<div style="position: absolute; top: 30695px; left: 447px;"><nobr><b>Description</b></nobr></div>
<div style="position: absolute; top: 30725px; left: 168px;"><nobr>31-2</nobr></div>
<div style="position: absolute; top: 30725px; left: 223px;"><nobr>Base address of Descriptor table. Corresponds to A[31-2]</nobr></div>
<div style="position: absolute; top: 30752px; left: 168px;"><nobr>1-0</nobr></div>
<div style="position: absolute; top: 30752px; left: 223px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 30787px; left: 87px;"><nobr>The PRD Table shall be Dword aligned. The Descriptor Table shall not cross a 65,536 (64KB) boundary in host </nobr></div>
<div style="position: absolute; top: 30803px; left: 87px;"><nobr>memory.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 30831px; left: 65px;"><nobr><b>6.8 Interrupt Line Considerations</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 30857px; left: 87px;"><nobr>When a channel is in Compatibility Mode the IRQ used by the channel shall be the compatibility IRQ.  PCI </nobr></div>
<div style="position: absolute; top: 30875px; left: 87px;"><nobr>interrupt lines shall not be affected by that channel's interrupt.  Conversely, when the channel is in PCI-native </nobr></div>
<div style="position: absolute; top: 30892px; left: 87px;"><nobr>mode the interrupt signals from both channels shall be connected to the appropriate interrupt pin number </nobr></div>
<div style="position: absolute; top: 30909px; left: 87px;"><nobr>(INTA).  Compatibility IRQs shall not be affected and if connected shall be released.</nobr></div>
<div style="position: absolute; top: 30933px; left: 87px;"><nobr>Connections of channel interrupt signals to the compatibility IRQs should be released until the adapter is </nobr></div>
<div style="position: absolute; top: 30950px; left: 87px;"><nobr>enabled via the PCI Command register in PCI Configuration Space. The adapter is enabled when a one is </nobr></div>
<div style="position: absolute; top: 30968px; left: 87px;"><nobr>written to the I/O enable bit (bit 0) in the Command register.</nobr></div>
</span></font>

<div style="position: absolute; top: 31063px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="29"><b>Page 29</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 31117px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 32202px; left: 87px;"><nobr>Page 15</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 31138px; left: 65px;"><nobr><b>6.9 Bus Master Operation</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 31163px; left: 87px;"><nobr>When transferring data to or from an ATA device using an ATA DMA protocol the adapter uses PCI bus master </nobr></div>
<div style="position: absolute; top: 31181px; left: 87px;"><nobr>protocols to transfers the data to or from the Host’s memory. </nobr></div>
<div style="position: absolute; top: 31204px; left: 87px;"><nobr>The Bus Master mode-programming interface is an extension of the standard ATA programming model.  This </nobr></div>
<div style="position: absolute; top: 31222px; left: 87px;"><nobr>means that devices can always be dealt with using the standard ATA programming model, with the Bus Master </nobr></div>
<div style="position: absolute; top: 31239px; left: 87px;"><nobr>mode functionality used when the appropriate software and devices are present.  Bus Master operation is </nobr></div>
<div style="position: absolute; top: 31256px; left: 87px;"><nobr>designed to work with any ATA device that supports DMA transfers on the ATA bus.  Devices that only work in </nobr></div>
<div style="position: absolute; top: 31274px; left: 87px;"><nobr>PIO mode can be used through the standard ATA programming model.</nobr></div>
<div style="position: absolute; top: 31296px; left: 87px;"><nobr>The programming interface defines a simple scatter/gather mechanism allowing large transfer blocks to be </nobr></div>
<div style="position: absolute; top: 31314px; left: 87px;"><nobr>transferred to and from non-contiguous areas of host memory.  </nobr></div>
<div style="position: absolute; top: 31337px; left: 87px;"><nobr>Master ATA Adapters shall default upon PCI reset to Mode zero Multiword DMA timings. This ensures operation </nobr></div>
<div style="position: absolute; top: 31355px; left: 87px;"><nobr>with DMA capable ATA devices without the need for adapter vendor-specific code to initialize adapter-specific </nobr></div>
<div style="position: absolute; top: 31372px; left: 87px;"><nobr>timing parameters.</nobr></div>
<div style="position: absolute; top: 31393px; left: 75px;"><nobr><b>6.9.1 Physical Region Descriptor (PRD) Table</b></nobr></div>
<div style="position: absolute; top: 31424px; left: 87px;"><nobr>Before the start bit is set in the Bus Master register, it is given a pointer to a valid PRD Table This table contains </nobr></div>
<div style="position: absolute; top: 31441px; left: 87px;"><nobr>some number of Physical Region Descriptors (PRDs), which describe areas of host memory that are involved in </nobr></div>
<div style="position: absolute; top: 31458px; left: 87px;"><nobr>the data transfer. The descriptor table shall be aligned on a Dword boundary and the table cannot cross a </nobr></div>
<div style="position: absolute; top: 31476px; left: 87px;"><nobr>65,536 (64KB) Byte boundary in host memory.</nobr></div>
<div style="position: absolute; top: 31498px; left: 75px;"><nobr><b>6.9.2 Physical Region Descriptor</b></nobr></div>
<div style="position: absolute; top: 31528px; left: 87px;"><nobr>The physical host memory region to be transferred is described by a Physical Region Descriptor (PRD). The </nobr></div>
<div style="position: absolute; top: 31546px; left: 87px;"><nobr>data transfer will proceed sequentially from the first PRD until all regions described by the PRDs in the table </nobr></div>
<div style="position: absolute; top: 31563px; left: 87px;"><nobr>have been transferred.</nobr></div>
<div style="position: absolute; top: 31589px; left: 87px;"><nobr>Each PRD entry is 8 bytes in length. The first 4 bytes specify the byte address of a physical host memory </nobr></div>
<div style="position: absolute; top: 31607px; left: 87px;"><nobr>region. The next two bytes specify the count of the region in bytes (65,536 Byte limit per region). A value of zero </nobr></div>
<div style="position: absolute; top: 31624px; left: 87px;"><nobr>in these two bytes indicates 65,536.  Bit 7 (EOT) of the last byte indicates the end of the table; bus master </nobr></div>
<div style="position: absolute; top: 31640px; left: 87px;"><nobr>operation terminates when the last descriptor has been retired.</nobr></div>
<div style="position: absolute; top: 31685px; left: 286px;"><nobr><b>Table 9 – Physical Region Descriptor Table Entry</b></nobr></div>
<div style="position: absolute; top: 31719px; left: 295px;"><nobr>Byte 3</nobr></div>
<div style="position: absolute; top: 31719px; left: 416px;"><nobr>Byte 2</nobr></div>
<div style="position: absolute; top: 31719px; left: 534px;"><nobr>Byte 1</nobr></div>
<div style="position: absolute; top: 31719px; left: 656px;"><nobr>Byte 0</nobr></div>
<div style="position: absolute; top: 31748px; left: 188px;"><nobr>Dword 0</nobr></div>
<div style="position: absolute; top: 31748px; left: 316px;"><nobr>Host memory Region Physical Base Address [32-1]</nobr></div>
<div style="position: absolute; top: 31748px; left: 725px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 31777px; left: 188px;"><nobr>Dword 1</nobr></div>
<div style="position: absolute; top: 31777px; left: 264px;"><nobr>EOT</nobr></div>
<div style="position: absolute; top: 31777px; left: 349px;"><nobr>Vendor Specific</nobr></div>
<div style="position: absolute; top: 31777px; left: 549px;"><nobr>Byte Count [15-1]</nobr></div>
<div style="position: absolute; top: 31777px; left: 725px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 31810px; left: 87px;"><nobr>The host memory region specified by the descriptor is further restricted such that the region shall not cross a </nobr></div>
<div style="position: absolute; top: 31827px; left: 87px;"><nobr>65,536 boundary. The sum of the descriptor byte counts must be equal to, or greater than the size of the device </nobr></div>
<div style="position: absolute; top: 31845px; left: 87px;"><nobr>transfer request.  The host software shall terminate the bus master transaction by resetting bit zero of the ATA </nobr></div>
<div style="position: absolute; top: 31862px; left: 87px;"><nobr>Bus Master Command register to zero.</nobr></div>
<div style="position: absolute; top: 31888px; left: 87px;"><nobr>The adapter may update the Byte Count during its operation. Host software should not assume that the PRD </nobr></div>
<div style="position: absolute; top: 31906px; left: 87px;"><nobr>has been updated and should re-initialize its contents before reusing the structure.</nobr></div>
<div style="position: absolute; top: 31927px; left: 75px;"><nobr><b>6.9.3 Standard Programming Sequence</b></nobr></div>
<div style="position: absolute; top: 31958px; left: 87px;"><nobr>To initiate a bus master transfer between host memory and an ATA DMA device, the following steps are </nobr></div>
<div style="position: absolute; top: 31976px; left: 87px;"><nobr>required:</nobr></div>
<div style="position: absolute; top: 32002px; left: 108px;"><nobr>1. Software prepares a PRD Table in host memory. </nobr></div>
<div style="position: absolute; top: 32027px; left: 108px;"><nobr>2. Software provides the starting address of the PRD Table by loading the PRD Table Pointer Register. </nobr></div>
<div style="position: absolute; top: 32045px; left: 135px;"><nobr>Setting of the Read/Write Control bit specifies the direction of the data transfer. Clearing the Interrupt </nobr></div>
<div style="position: absolute; top: 32062px; left: 135px;"><nobr>and Error bits in the ATA Bus Master Status register to zero readies the adapter for a data transfer.</nobr></div>
<div style="position: absolute; top: 32088px; left: 108px;"><nobr>3. Software issues the appropriate DMA transfer command to the device.</nobr></div>
<div style="position: absolute; top: 32115px; left: 108px;"><nobr>4. Software initiates the bus master function by writing a one to the Start bit in the ATA Bus Master </nobr></div>
<div style="position: absolute; top: 32132px; left: 135px;"><nobr>Command Register for the appropriate channel.</nobr></div>
<div style="position: absolute; top: 32158px; left: 108px;"><nobr>5. The adapter transfers data to/from host memory responding to DMA requests from the ATA device.</nobr></div>
</span></font>

<div style="position: absolute; top: 32251px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="30"><b>Page 30</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 33390px; left: 681px;"><nobr>Page 16</nobr></div>
<div style="position: absolute; top: 32327px; left: 108px;"><nobr>6. At the end of the transfer the ATA device asserts an interrupt if nIEN is cleared to zero.</nobr></div>
<div style="position: absolute; top: 32354px; left: 108px;"><nobr>7. For transfers from the device to the host the adapter shall first transfer any internal data buffers before </nobr></div>
<div style="position: absolute; top: 32371px; left: 135px;"><nobr>first setting the interrupt bit and asserting the Host interrupt signal to host memory.</nobr></div>
<div style="position: absolute; top: 32396px; left: 108px;"><nobr>8. In response to the interrupt, software resets the Start/Stop and interrupt bits in the ATA Bus Master </nobr></div>
<div style="position: absolute; top: 32414px; left: 135px;"><nobr>Command register. The software then reads the adapter’s and device’s Status registers to determine if </nobr></div>
<div style="position: absolute; top: 32431px; left: 135px;"><nobr>the transfer completed successfully.</nobr></div>
<div style="position: absolute; top: 32457px; left: 108px;"><nobr>9. If there is less data transferred than is specified by the PRD table see Table 10 for appropriate action.</nobr></div>
<div style="position: absolute; top: 32480px; left: 75px;"><nobr><b>6.9.4 ATA Bus Master Status Register Bit Interpretation</b></nobr></div>
<div style="position: absolute; top: 32510px; left: 87px;"><nobr>The table below gives a description of how to interpret the Interrupt and Active bits in the Adapter status register </nobr></div>
<div style="position: absolute; top: 32527px; left: 87px;"><nobr>after a DMA transfer has been started.</nobr></div>
<div style="position: absolute; top: 32563px; left: 280px;"><nobr><b>Table 10 – Adapter Bus Master Status Register bits</b></nobr></div>
<div style="position: absolute; top: 32597px; left: 113px;"><nobr>Interrupt</nobr></div>
<div style="position: absolute; top: 32597px; left: 191px;"><nobr>Error</nobr></div>
<div style="position: absolute; top: 32597px; left: 248px;"><nobr>Active</nobr></div>
<div style="position: absolute; top: 32597px; left: 518px;"><nobr>Description:</nobr></div>
<div style="position: absolute; top: 32626px; left: 135px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32626px; left: 203px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32626px; left: 263px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 32626px; left: 306px;"><nobr>DMA transfer is in progress and the ATA device has not asserted INTRQ.</nobr></div>
<div style="position: absolute; top: 32654px; left: 135px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 32654px; left: 203px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32654px; left: 263px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32654px; left: 306px;"><nobr>The ATA device asserted INTRQ and the adapter exhausted the PRDs. </nobr></div>
<div style="position: absolute; top: 32671px; left: 306px;"><nobr>This is the normal completion case where the size of the physical host </nobr></div>
<div style="position: absolute; top: 32688px; left: 306px;"><nobr>memory regions was equal to the ATA device transfer size.</nobr></div>
<div style="position: absolute; top: 32716px; left: 135px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 32716px; left: 203px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32716px; left: 263px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 32716px; left: 306px;"><nobr>The ATA device asserted INTRQ but the adapter has not reached the end </nobr></div>
<div style="position: absolute; top: 32733px; left: 306px;"><nobr>of the physical host memory regions defined in the PRDs.  This is a valid </nobr></div>
<div style="position: absolute; top: 32750px; left: 306px;"><nobr>completion case where the size of the physical host memory regions was </nobr></div>
<div style="position: absolute; top: 32768px; left: 306px;"><nobr>larger than the ATA device transfer size.</nobr></div>
<div style="position: absolute; top: 32795px; left: 135px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32795px; left: 203px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32795px; left: 263px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 32795px; left: 306px;"><nobr>This bit combination signals an anomaly. The PRD’s specified a smaller </nobr></div>
<div style="position: absolute; top: 32812px; left: 306px;"><nobr>size than the ATA transfer size and as a result the device may have to be </nobr></div>
<div style="position: absolute; top: 32830px; left: 306px;"><nobr>reset. See clause 6.9.5.</nobr></div>
<div style="position: absolute; top: 32857px; left: 135px;"><nobr>X</nobr></div>
<div style="position: absolute; top: 32857px; left: 203px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 32857px; left: 263px;"><nobr>X</nobr></div>
<div style="position: absolute; top: 32857px; left: 306px;"><nobr>The adapter has some problem transferring data to/from host memory. </nobr></div>
<div style="position: absolute; top: 32873px; left: 306px;"><nobr>Specifics of the error have to be determined using bus-specific information.  </nobr></div>
<div style="position: absolute; top: 32891px; left: 306px;"><nobr>A timeout may be required to detect this condition.</nobr></div>
<div style="position: absolute; top: 32951px; left: 75px;"><nobr><b>6.9.5 Error Conditions</b></nobr></div>
<div style="position: absolute; top: 32981px; left: 87px;"><nobr>If the adapter encounters an error while doing the bus master transfers it shall stop the transfer (i.e. reset the </nobr></div>
<div style="position: absolute; top: 32999px; left: 87px;"><nobr>Active bit in the adapter Bus Master Command register) and set the Error bit in the adapter Bus Master Status </nobr></div>
<div style="position: absolute; top: 33016px; left: 87px;"><nobr>register. The adapter does not generate an interrupt when this happens.  The host software may use device or </nobr></div>
<div style="position: absolute; top: 33033px; left: 87px;"><nobr>adapter specific information (e.g.; PCI Configuration Space Status register) to determine what caused the error. </nobr></div>
<div style="position: absolute; top: 33051px; left: 87px;"><nobr>In any event the adapter should terminate any DMA burst in progress compliant with the ATA protocol being </nobr></div>
<div style="position: absolute; top: 33068px; left: 87px;"><nobr>used. If the UDMA protocol is being used there may be a CRC error to report. The ATA device may be in an </nobr></div>
<div style="position: absolute; top: 33085px; left: 87px;"><nobr>indeterminate state.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 16px; font-family: Times;">
<div style="position: absolute; top: 33102px; left: 54px;"><nobr><b>7 Automatic Direct Memory Access (ADMA) Adaptors - General Description</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 33133px; left: 65px;"><nobr><b>7.1 Background</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 33164px; left: 98px;"><nobr>The performance of ATA devices has increased dramatically over time, including the introduction of the </nobr></div>
<div style="position: absolute; top: 33181px; left: 98px;"><nobr>Overlapped and Queued Feature Sets.  However, systems using these faster devices have not shown all of </nobr></div>
<div style="position: absolute; top: 33197px; left: 98px;"><nobr>the expected benefits.  This limited performance improvement is a consequence of the demands the PCI </nobr></div>
<div style="position: absolute; top: 33215px; left: 98px;"><nobr>compatibility and PCI-native mode bus master adapters places on the resources of the host.  The problem is </nobr></div>
<div style="position: absolute; top: 33232px; left: 98px;"><nobr>amplified by the design of the standard ATA host software used in some operating systems.  This software </nobr></div>
<div style="position: absolute; top: 33249px; left: 98px;"><nobr>effectively treats ATA transfers as a single-threaded entity, with correspondingly long latencies to fully service </nobr></div>
<div style="position: absolute; top: 33267px; left: 98px;"><nobr>the interrupts.  The Automatic DMA (ADMA) engine is designed to address these problems and add features </nobr></div>
<div style="position: absolute; top: 33284px; left: 98px;"><nobr>that make it, and ATA devices, suitable for true multi-threading applications.  This host adapter shall not </nobr></div>
<div style="position: absolute; top: 33301px; left: 98px;"><nobr>support single or multiword DMA.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 33329px; left: 65px;"><nobr><b>7.2 The ADMA Engine</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 33358px; left: 98px;"><nobr>The objective of the ADMA design is to drastically increase the performance of systems that use ATA devices.</nobr></div>
</span></font>

<div style="position: absolute; top: 33439px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="31"><b>Page 31</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 33493px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 34578px; left: 87px;"><nobr>Page 17</nobr></div>
<div style="position: absolute; top: 33515px; left: 98px;"><nobr>To fully optimize the system throughput, the ADMA engine implements a command chaining technique to de-</nobr></div>
<div style="position: absolute; top: 33533px; left: 98px;"><nobr>couple the host command sequence from the channel execution.  This decoupling is accomplished by having </nobr></div>
<div style="position: absolute; top: 33550px; left: 98px;"><nobr>the traditional host software-to-device I/O negotiation executed in hardware.  This allows true multitasking and </nobr></div>
<div style="position: absolute; top: 33566px; left: 98px;"><nobr>the ability to effectively exploit the Overlapped and Queued Feature Sets. </nobr></div>
<div style="position: absolute; top: 33593px; left: 98px;"><nobr>The ADMA engine works in two modes, termed ATA Register and ADMA</nobr></div>
<div style="position: absolute; top: 33615px; left: 75px;"><nobr><b>7.2.1 Modes of Operation</b></nobr></div>
<div style="position: absolute; top: 33645px; left: 87px;"><nobr>In ATA Register Mode, the host software directly writes/reads the ATA registers.  The only function performed </nobr></div>
<div style="position: absolute; top: 33663px; left: 87px;"><nobr>by the ADMA engine is to obey the Programmed I/O (PIO) timing rules for the current PIO mode.  In this mode, </nobr></div>
<div style="position: absolute; top: 33680px; left: 87px;"><nobr>the ATA interrupts are routed directly to a PCI interrupt.  </nobr></div>
<div style="position: absolute; top: 33706px; left: 87px;"><nobr>In ADMA Mode, the ADMA engine controls all aspects of the ATA protocols including interception and routing of </nobr></div>
<div style="position: absolute; top: 33724px; left: 87px;"><nobr>the ATA interrupt as appropriate.</nobr></div>
<div style="position: absolute; top: 33745px; left: 75px;"><nobr><b>7.2.2 PCI Bus</b></nobr></div>
<div style="position: absolute; top: 33776px; left: 87px;"><nobr>The PCI bus conforms to the {PCI SPEC}, the {PCI PMS}, and the {PCI Hot Plug} requirements.  The ADMA </nobr></div>
<div style="position: absolute; top: 33794px; left: 87px;"><nobr>contains configuration header registers consistent with its implementation as a single PCI function device, and </nobr></div>
<div style="position: absolute; top: 33811px; left: 87px;"><nobr>thus drives a single interrupt line, see 7.2.6.</nobr></div>
<div style="position: absolute; top: 33832px; left: 75px;"><nobr><b>7.2.3 PCI Configuration </b></nobr></div>
<div style="position: absolute; top: 33863px; left: 87px;"><nobr>The ADMA may be implemented to support one or two ATA channels.  The PCI configuration header registers </nobr></div>
<div style="position: absolute; top: 33880px; left: 87px;"><nobr>contain one Memory Mapped Base Address Register (BAR) associated with the ADMA and ATA Registers, two </nobr></div>
<div style="position: absolute; top: 33897px; left: 87px;"><nobr>I/O BARs for each ATA channel, and an Expansion ROM BAR associated with the optional BIOS.</nobr></div>
<div style="position: absolute; top: 33920px; left: 75px;"><nobr><b>7.2.4 FIFOs and FIFO Control (optional)</b></nobr></div>
<div style="position: absolute; top: 33950px; left: 87px;"><nobr>Each ADMA channel contains a FIFO used to buffer data during transfers.  Each FIFO shall be a power of two </nobr></div>
<div style="position: absolute; top: 33967px; left: 87px;"><nobr>Quad-Words (Qwords) long and is controlled by two host programmable registers: the ADMA FIFO Input </nobr></div>
<div style="position: absolute; top: 33985px; left: 87px;"><nobr>Threshold (FITR) and ADMA FIFO Output Threshold (FOTR).  These registers are used by to control the FIFO </nobr></div>
<div style="position: absolute; top: 34002px; left: 87px;"><nobr>by indicating the burst size to/from the PCI bus The ADMA FIFO Input Threshold controls the requested PCI </nobr></div>
<div style="position: absolute; top: 34019px; left: 87px;"><nobr>data transfer burst length from the ADMA to the host, while the ADMA FIFO Output Threshold controls the </nobr></div>
<div style="position: absolute; top: 34037px; left: 87px;"><nobr>requested PCI data transfer burst length from the host to the ADMA.  Adjusting the FIFO thresholds controls the </nobr></div>
<div style="position: absolute; top: 34054px; left: 87px;"><nobr>length of the PCI transaction.</nobr></div>
<div style="position: absolute; top: 34075px; left: 75px;"><nobr><b>7.2.5 ATA Bus Transfer Modes</b></nobr></div>
<div style="position: absolute; top: 34105px; left: 87px;"><nobr>The ATA PIO protocol shall be automated in the ADMA.  This means that the ADMA executes PIO transfers to </nobr></div>
<div style="position: absolute; top: 34123px; left: 87px;"><nobr>the device while performing PCI Burst mode transfers on the PCI bus.  This method of operation is termed </nobr></div>
<div style="position: absolute; top: 34140px; left: 87px;"><nobr>"DMA-Assisted PIO mode".  The ADMA uses DMA-Assisted PIO mode for devices not implementing Ultra DMA.</nobr></div>
<div style="position: absolute; top: 34166px; left: 87px;"><nobr>In ATA Register Mode, the ADMA supports data transfer to/from the ATA bus using PIO protocols.</nobr></div>
<div style="position: absolute; top: 34193px; left: 87px;"><nobr>In ADMA mode, the ADMA uses Ultra DMA between the device and the ADMA and uses PCI Burst mode DMA </nobr></div>
<div style="position: absolute; top: 34210px; left: 87px;"><nobr>between the ADMA and the host.</nobr></div>
<div style="position: absolute; top: 34231px; left: 75px;"><nobr><b>7.2.6 ATA Interrupts</b></nobr></div>
<div style="position: absolute; top: 34263px; left: 87px;"><nobr>The ADMA relies on the use of the ATA device interrupt INTRQ.  Under no circumstances shall the host </nobr></div>
<div style="position: absolute; top: 34280px; left: 87px;"><nobr>software set nIEN to one, thereby disabling the ATA INTRQ signal. The ADMA engine is interrupt driven and </nobr></div>
<div style="position: absolute; top: 34297px; left: 87px;"><nobr>may not operate correctly in ADMA Mode with this bit set to one.</nobr></div>
<div style="position: absolute; top: 34319px; left: 75px;"><nobr><b>7.2.7 ADMA Interrupts</b></nobr></div>
<div style="position: absolute; top: 34349px; left: 87px;"><nobr>The ADMA generates the ADMA interrupt signal from three different sources of interrupt:</nobr></div>
<div style="position: absolute; top: 34375px; left: 114px;"><nobr>1. ADMA Interrupts.  The ADMA Interrupt signal is asserted by the ADMA to inform the host software of </nobr></div>
<div style="position: absolute; top: 34393px; left: 141px;"><nobr>events occurring within the ADMA engine.</nobr></div>
<div style="position: absolute; top: 34419px; left: 114px;"><nobr>2. Unsolicited Interrupts.  For systems that require an external interrupt the ADMA Unsolicited Interrupt </nobr></div>
<div style="position: absolute; top: 34436px; left: 141px;"><nobr>(UIRQ) signal shall be available.</nobr></div>
<div style="position: absolute; top: 34463px; left: 114px;"><nobr>3. ATA Device Interrupts.  When in ATA Register Mode, the ATA device interrupt is the ATA INTRQ signal </nobr></div>
<div style="position: absolute; top: 34480px; left: 141px;"><nobr>coming from the ATA/ATAPI bus.</nobr></div>
<div style="position: absolute; top: 34506px; left: 87px;"><nobr>The above signals from each channel are OR-ed to generate the Channel X Interrupt and the Channel Y </nobr></div>
<div style="position: absolute; top: 34524px; left: 87px;"><nobr>Interrupt.  These signals are OR-ed in turn to generate the PCI interrupt signal.</nobr></div>
</span></font>

<div style="position: absolute; top: 34627px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="32"><b>Page 32</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35766px; left: 681px;"><nobr>Page 18</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 34702px; left: 65px;"><nobr><b>7.3 ADMA Overview</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 34731px; left: 98px;"><nobr>The features of the ADMA engine are designed to provide access to the ATA registers using PIO reads and </nobr></div>
<div style="position: absolute; top: 34748px; left: 98px;"><nobr>writes.  Many new features drastically improve performance as well as functionality.  This section briefly </nobr></div>
<div style="position: absolute; top: 34766px; left: 98px;"><nobr>introduces these features.  For this reason, ADMA shall support both IO and Memory mapped operation.</nobr></div>
<div style="position: absolute; top: 34787px; left: 75px;"><nobr><b>7.3.1 Single Stepping and Continuous DMA</b></nobr></div>
<div style="position: absolute; top: 34817px; left: 108px;"><nobr>The ADMA may be implemented using either Single Stepping DMA or Continuous DMA.  The single stepping </nobr></div>
<div style="position: absolute; top: 34835px; left: 108px;"><nobr>DMA version read and processes one command at a time, interrupting the host after each command is </nobr></div>
<div style="position: absolute; top: 34852px; left: 108px;"><nobr>complete and waits for the host to instruct it to process the next command.  The continuous DMA version </nobr></div>
<div style="position: absolute; top: 34869px; left: 108px;"><nobr>does not stop between commands and these commands are processed without host intervention.</nobr></div>
<div style="position: absolute; top: 34892px; left: 75px;"><nobr><b>7.3.2 Accessing ATA and ADMA Registers</b></nobr></div>
<div style="position: absolute; top: 34922px; left: 87px;"><nobr>The ATA device’s Command and Control Registers are accessible through the ADMA by either I/O or memory </nobr></div>
<div style="position: absolute; top: 34939px; left: 87px;"><nobr>mapped registers.  The control of the ADMA engine is through a set of memory mapped registers.</nobr></div>
<div style="position: absolute; top: 34961px; left: 75px;"><nobr><b>7.3.3 ADMA Control Operating Modes</b></nobr></div>
<div style="position: absolute; top: 34992px; left: 87px;"><nobr>Two modes of operation are implemented: ATA Register Mode, and ADMA Mode.</nobr></div>
<div style="position: absolute; top: 35018px; left: 87px;"><nobr><b>7.3.3.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35019px; left: 136px;"><nobr><b>ATA Register Mode</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35044px; left: 119px;"><nobr>ATA Register Mode is the power-on and reset default.  In this mode, the ATA adapter acts as an address </nobr></div>
<div style="position: absolute; top: 35062px; left: 119px;"><nobr>decoder for the host.  All reads and writes are performed using host I/O or host memory instructions.  The </nobr></div>
<div style="position: absolute; top: 35078px; left: 119px;"><nobr>only function performed by the ADMA is to control the signal timings of the ATA bus and to respond to PCI </nobr></div>
<div style="position: absolute; top: 35095px; left: 119px;"><nobr>signals.  In this mode, all data transfers use the PIO protocols, and ATA bus interrupts are directly mapped </nobr></div>
<div style="position: absolute; top: 35113px; left: 119px;"><nobr>onto the PCI interrupt signal.  Note that both channels X and Y use the single PCI interrupt signal.</nobr></div>
<div style="position: absolute; top: 35139px; left: 87px;"><nobr><b>7.3.3.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35140px; left: 136px;"><nobr><b>Automatic DMA Mode</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35165px; left: 119px;"><nobr>The ADMA autonomously follows a command chain of Command Parameter Blocks (CPBs) mapped in </nobr></div>
<div style="position: absolute; top: 35182px; left: 119px;"><nobr>host memory as described in Section 7.3.5.  In this mode, data transfers can be either Ultra DMA or DMA-</nobr></div>
<div style="position: absolute; top: 35200px; left: 119px;"><nobr>assisted PIO.</nobr></div>
<div style="position: absolute; top: 35226px; left: 119px;"><nobr>In ADMA Mode, the ATA legacy registers are not available.  In this mode, any access to the ATA Status (or </nobr></div>
<div style="position: absolute; top: 35243px; left: 119px;"><nobr>ATA Alternate Status) register returns a value with bit 7 (BSY) set to one with all other bits cleared to zero.  </nobr></div>
<div style="position: absolute; top: 35261px; left: 119px;"><nobr>Any read to other registers returns an indeterminate value.  Any write to an ATA register shall be ignored.</nobr></div>
<div style="position: absolute; top: 35282px; left: 75px;"><nobr><b>7.3.4 ADMA Registers</b></nobr></div>
<div style="position: absolute; top: 35308px; left: 87px;"><nobr><b>7.3.4.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35309px; left: 136px;"><nobr><b>ADMA Control (ADMCTL)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35335px; left: 87px;"><nobr>The ADMA Control Register contains bits to control the mode and flow of operation.</nobr></div>
<div style="position: absolute; top: 35365px; left: 87px;"><nobr><b>7.3.4.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35366px; left: 140px;"><nobr><b>ADMA Status (ADMSTAT)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35391px; left: 87px;"><nobr>The ADMA Status Register contains bits that indicate the current state of the process and interrupt reason.</nobr></div>
<div style="position: absolute; top: 35422px; left: 87px;"><nobr><b>7.3.4.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35423px; left: 136px;"><nobr><b>CPB Search Count (CCNT)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35447px; left: 87px;"><nobr>The ADMA uses this value to determine when to stop processing CPBs.  This value is usually set to the number </nobr></div>
<div style="position: absolute; top: 35465px; left: 87px;"><nobr>of entries in the CPB chain.</nobr></div>
<div style="position: absolute; top: 35496px; left: 87px;"><nobr><b>7.3.4.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35497px; left: 136px;"><nobr><b>Current CPB Address (CCPB)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35522px; left: 87px;"><nobr>The Current CPB Address Register contains the 32-bit address of the CPB currently being processed.</nobr></div>
<div style="position: absolute; top: 35552px; left: 87px;"><nobr><b>7.3.4.5</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35553px; left: 136px;"><nobr><b>Next CPB Address (NCPB)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35578px; left: 87px;"><nobr>The ADMA Next CPB Address Register contains the 32-bit address of the next CPB to be processed by the </nobr></div>
<div style="position: absolute; top: 35596px; left: 87px;"><nobr>ADMA.  The host software shall initialize the contents of this register before entering ADMA Mode.  The ADMA </nobr></div>
<div style="position: absolute; top: 35613px; left: 87px;"><nobr>updates this register as it progresses through the CPB chain, except when accessing the CPB Lookup Table.</nobr></div>
<div style="position: absolute; top: 35643px; left: 87px;"><nobr><b>7.3.4.6</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35644px; left: 136px;"><nobr><b>CPB Lookup Table Address Register (CPBLAR)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35669px; left: 87px;"><nobr>The CPB Lookup Address Register contains the 32-bit address of the base of the CPB Lookup Table.  If the </nobr></div>
<div style="position: absolute; top: 35687px; left: 87px;"><nobr>host software is using overlapped/queued commands, it shall initialize the contents of this register before </nobr></div>
<div style="position: absolute; top: 35704px; left: 87px;"><nobr>entering ADMA Mode.  The ADMA uses this address to locate the correct CPB when servicing a released </nobr></div>
<div style="position: absolute; top: 35721px; left: 87px;"><nobr>overlapped/queued ATA or Packet Command.</nobr></div>
</span></font>

<div style="position: absolute; top: 35815px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="33"><b>Page 33</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35869px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 36954px; left: 87px;"><nobr>Page 19</nobr></div>
<div style="position: absolute; top: 35891px; left: 87px;"><nobr><b>7.3.4.7</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35892px; left: 136px;"><nobr><b>ADMA FIFO Input Threshold Register (FITR) (optional)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35917px; left: 87px;"><nobr>FITR controls the requested PCI data transfer burst length from the ADMA to the host.</nobr></div>
<div style="position: absolute; top: 35948px; left: 87px;"><nobr><b>7.3.4.8</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 35949px; left: 136px;"><nobr><b>ADMA FIFO Output Threshold Register (FOTR) (optional)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 35974px; left: 87px;"><nobr>FOTR controls the requested PCI data transfer burst length from the host to the ADMA.</nobr></div>
<div style="position: absolute; top: 36000px; left: 75px;"><nobr><b>7.3.5 ADMA Data Structures</b></nobr></div>
<div style="position: absolute; top: 36030px; left: 108px;"><nobr>The ADMA requires the following data structures to control and manage ATA devices when in ADMA Mode.  </nobr></div>
<div style="position: absolute; top: 36048px; left: 108px;"><nobr>These data structures shall be physically located in host memory with each entry of the data structure in </nobr></div>
<div style="position: absolute; top: 36065px; left: 108px;"><nobr>physically contiguous space.  Some HBA’s require that all addresses be Qword aligned.</nobr></div>
<div style="position: absolute; top: 36091px; left: 87px;"><nobr><b>7.3.5.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 36092px; left: 136px;"><nobr><b>CPB Chain</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 36117px; left: 119px;"><nobr>The CPB chain may be a circular linked-list of CPB entries.  A CPB is a data structure used during ADMA </nobr></div>
<div style="position: absolute; top: 36135px; left: 119px;"><nobr>Mode to store parameters that control the ADMA engine, and define an ATA command for the ATA device.  </nobr></div>
<div style="position: absolute; top: 36152px; left: 119px;"><nobr>A chain of CPBs is created in host memory as a linked-list with each CPB pointing to the next CPB.  Within </nobr></div>
<div style="position: absolute; top: 36169px; left: 119px;"><nobr>each CPB, there is a pointer to a APRD chain.  An APRD chain defines the host memory locations where </nobr></div>
<div style="position: absolute; top: 36187px; left: 119px;"><nobr>data is to be written to/read from.  Figure 2 illustrates the CPB structure and APRD relationship.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 10px; font-family: Times;">
<div style="position: absolute; top: 36268px; left: 119px;"><nobr>CPB Next Address</nobr></div>
<div style="position: absolute; top: 36282px; left: 147px;"><nobr>Register</nobr></div>
<div style="position: absolute; top: 36278px; left: 414px;"><nobr><b>CPB</b></nobr></div>
<div style="position: absolute; top: 36322px; left: 389px;"><nobr>APRD Pointer</nobr></div>
<div style="position: absolute; top: 36364px; left: 379px;"><nobr>Next CPB Pointer</nobr></div>
<div style="position: absolute; top: 36440px; left: 414px;"><nobr><b>CPB</b></nobr></div>
<div style="position: absolute; top: 36484px; left: 389px;"><nobr>APRD Pointer</nobr></div>
<div style="position: absolute; top: 36526px; left: 379px;"><nobr>Next CPB Pointer</nobr></div>
<div style="position: absolute; top: 36669px; left: 414px;"><nobr><b>CPB</b></nobr></div>
<div style="position: absolute; top: 36713px; left: 389px;"><nobr>APRD Pointer</nobr></div>
<div style="position: absolute; top: 36756px; left: 379px;"><nobr>Next CPB Pointer</nobr></div>
<div style="position: absolute; top: 36826px; left: 372px;"><nobr><b>CPB Lookup Table</b></nobr></div>
<div style="position: absolute; top: 36855px; left: 351px;"><nobr>CPB Address</nobr></div>
<div style="position: absolute; top: 36868px; left: 351px;"><nobr>CPB Address</nobr></div>
<div style="position: absolute; top: 36883px; left: 351px;"><nobr>CPB Address</nobr></div>
<div style="position: absolute; top: 36898px; left: 351px;"><nobr>...</nobr></div>
<div style="position: absolute; top: 36855px; left: 636px;"><nobr>CPB Lookup Table Address</nobr></div>
<div style="position: absolute; top: 36868px; left: 689px;"><nobr>Register</nobr></div>
<div style="position: absolute; top: 36322px; left: 600px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36322px; left: 694px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36322px; left: 789px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36484px; left: 600px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36484px; left: 694px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36484px; left: 789px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36713px; left: 600px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36713px; left: 694px;"><nobr><b>APRD</b></nobr></div>
<div style="position: absolute; top: 36713px; left: 789px;"><nobr><b>APRD</b></nobr></div>
</span></font>

<div style="position: absolute; top: 37003px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="34"><b>Page 34</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 38142px; left: 681px;"><nobr>Page 20</nobr></div>
<div style="position: absolute; top: 37079px; left: 343px;"><nobr><b>Figure 2 – ADMA Data Structures</b></nobr></div>
<div style="position: absolute; top: 37115px; left: 119px;"><nobr>An individual CPB can be in one of four States:  Not-Valid, Valid-Waiting, Valid-Processing or Released.  A </nobr></div>
<div style="position: absolute; top: 37132px; left: 119px;"><nobr>CPB that is Not-Valid is under the control of the host.  A CPB that is Valid-Waiting, Valid-Processing, or </nobr></div>
<div style="position: absolute; top: 37148px; left: 119px;"><nobr>Released is under the control of the ADMA and should not be updated by the host, except for the cVLD bit </nobr></div>
<div style="position: absolute; top: 37166px; left: 119px;"><nobr>(see 7.6.3).</nobr></div>
<div style="position: absolute; top: 37192px; left: 87px;"><nobr><b>7.3.5.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 37193px; left: 136px;"><nobr><b>APRD Chain</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 37218px; left: 119px;"><nobr>An APRD chain is a linked-list of one or more APRD entries used to transfer data for a single CPB.  This is </nobr></div>
<div style="position: absolute; top: 37235px; left: 119px;"><nobr>a superset of the compatible mode PRD pointers described in 6.9.1.  Each entry contains the physical </nobr></div>
<div style="position: absolute; top: 37253px; left: 119px;"><nobr>location to be used as the source or destination of the current transfer, and the transfer length.  The </nobr></div>
<div style="position: absolute; top: 37270px; left: 119px;"><nobr>transfer location may be a contiguous host memory area or an I/O address.  Each entry also contains a </nobr></div>
<div style="position: absolute; top: 37287px; left: 119px;"><nobr>pointer to the next entry, as well as values to control the method and mode of the transfer.</nobr></div>
<div style="position: absolute; top: 37314px; left: 87px;"><nobr><b>7.3.5.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 37315px; left: 136px;"><nobr><b>CPB Lookup Table</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 37340px; left: 119px;"><nobr>The host constructs a CPB Lookup Table in host memory for use in overlapped/queued operation.  It is </nobr></div>
<div style="position: absolute; top: 37357px; left: 119px;"><nobr>pointed to by the CPB Lookup Address Register, which is initialized by the host software.  Each entry in the </nobr></div>
<div style="position: absolute; top: 37373px; left: 119px;"><nobr>table is a Qword holding the physical address of a CPB.  Figure 2 illustrates the CPB Lookup Table.</nobr></div>
<div style="position: absolute; top: 37400px; left: 87px;"><nobr><b>7.3.5.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 37401px; left: 136px;"><nobr><b>Data Structure Initialization</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 37426px; left: 119px;"><nobr>A valid APRD chain shall be constructed.  An APRD chain defines the host memory locations where data is </nobr></div>
<div style="position: absolute; top: 37443px; left: 119px;"><nobr>to be written to/read from.  A valid CPB chain shall be constructed consisting of one or more CPB entries </nobr></div>
<div style="position: absolute; top: 37460px; left: 119px;"><nobr>with the Next CPB field pointing to the physical host memory address of the next CPB in the chain (the </nobr></div>
<div style="position: absolute; top: 37478px; left: 119px;"><nobr>Next CPB field in a chain of one CPB would point to itself).  Each CPB shall be initialized to point to the </nobr></div>
<div style="position: absolute; top: 37495px; left: 119px;"><nobr>head of an APRD chain.  All CPBs shall be set to Not-Valid.  The CPB Lookup Table shall be constructed.  </nobr></div>
<div style="position: absolute; top: 37512px; left: 119px;"><nobr>The address of the first CPB shall be written into the ADMA Next CPB Address Register, and the base of </nobr></div>
<div style="position: absolute; top: 37530px; left: 119px;"><nobr>the CPB Lookup Table shall be written into the ADMA Lookup Table Address Register.</nobr></div>
<div style="position: absolute; top: 37551px; left: 75px;"><nobr><b>7.3.6 ADMA Engine Initialization</b></nobr></div>
<div style="position: absolute; top: 37582px; left: 87px;"><nobr>Before entering ADMA Mode, the host writes a CPB address into the ADMA Next CPB Address Register, and </nobr></div>
<div style="position: absolute; top: 37600px; left: 87px;"><nobr>writes into the CPB Search Count Register the number of CPBs to scan before stopping.  The value in the CPB </nobr></div>
<div style="position: absolute; top: 37616px; left: 87px;"><nobr>Search Count Register is used by the ADMA to refresh an internal counter.  This internal counter is refreshed </nobr></div>
<div style="position: absolute; top: 37633px; left: 87px;"><nobr>each time the host writes a one to aGO indicating that the ADMA should begin processing the CPB chain.  The </nobr></div>
<div style="position: absolute; top: 37651px; left: 87px;"><nobr>ADMA decrements this internal count each time a CPB is encountered.  When this internal counter reaches </nobr></div>
<div style="position: absolute; top: 37668px; left: 87px;"><nobr>zero, the ADMA stops fetching CPB entries.  The value set in the CPB Search Count Register determines the </nobr></div>
<div style="position: absolute; top: 37685px; left: 87px;"><nobr>number of CPBs that will be accessed after aGO is written as one.</nobr></div>
<div style="position: absolute; top: 37708px; left: 75px;"><nobr><b>7.3.7 Time-outs</b></nobr></div>
<div style="position: absolute; top: 37738px; left: 87px;"><nobr>The ADMA shall not automatically time out an ATA command.  The host software is responsible for timing out </nobr></div>
<div style="position: absolute; top: 37755px; left: 87px;"><nobr>commands.  Status information in the CPB chain and the ADMA Registers is available for host software to be </nobr></div>
<div style="position: absolute; top: 37773px; left: 87px;"><nobr>able to determine the status of the ADMA.  Host software is able to pause the ADMA in the event of a command </nobr></div>
<div style="position: absolute; top: 37790px; left: 87px;"><nobr>time-out, revert to ATA Register Mode, and directly address the device registers.</nobr></div>
<div style="position: absolute; top: 37811px; left: 75px;"><nobr><b>7.3.8 Non-Queued Operation</b></nobr></div>
<div style="position: absolute; top: 37843px; left: 87px;"><nobr>The host software assembles CPB entries in the host’s memory and indicates that the ADMA should examine </nobr></div>
<div style="position: absolute; top: 37859px; left: 87px;"><nobr>the CPB chain by writing aGO to one in the ADMA control register.  Starting from the current value in the ADMA </nobr></div>
<div style="position: absolute; top: 37876px; left: 87px;"><nobr>Next CPB Address Register, the ADMA Sequencer reads the current CPB using a PCI master mode burst.</nobr></div>
<div style="position: absolute; top: 37903px; left: 114px;"><nobr>1. If the CPB is ready to be processed, then the ADMA proceeds to step 2.  If the CPB is not ready to be </nobr></div>
<div style="position: absolute; top: 37920px; left: 141px;"><nobr>processed, the next CPB is read until a valid entry is found or the ADMA internal CPB counter has </nobr></div>
<div style="position: absolute; top: 37937px; left: 141px;"><nobr>decremented to zero.</nobr></div>
<div style="position: absolute; top: 37964px; left: 114px;"><nobr>2. The contents of the CPB ATA command block are read by the ADMA.</nobr></div>
<div style="position: absolute; top: 37990px; left: 114px;"><nobr>3. The ADMA updates the  Next CPB Address Register from the current CPB to point to the next CPB in </nobr></div>
<div style="position: absolute; top: 38007px; left: 141px;"><nobr>the chain</nobr></div>
<div style="position: absolute; top: 38034px; left: 114px;"><nobr>4. The ADMA stores the start address of the APRD chain</nobr></div>
<div style="position: absolute; top: 38060px; left: 114px;"><nobr>5. If the CPB involves a data transfer, the ADMA reads the first APRD entry, using a PCI master mode </nobr></div>
<div style="position: absolute; top: 38077px; left: 141px;"><nobr>burst.  The data address and transfer count in this entry are used by the ADMA to control the data </nobr></div>
<div style="position: absolute; top: 38095px; left: 141px;"><nobr>transfer.  The control information in this entry is used by the ADMA to manage the transfer on the ATA </nobr></div>
<div style="position: absolute; top: 38111px; left: 141px;"><nobr>Bus. </nobr></div>
</span></font>

<div style="position: absolute; top: 38191px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="35"><b>Page 35</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 38245px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 39330px; left: 87px;"><nobr>Page 21</nobr></div>
<div style="position: absolute; top: 38267px; left: 114px;"><nobr>6. The ADMA writes the ATA device’s registers with parameters and the command. </nobr></div>
<div style="position: absolute; top: 38294px; left: 114px;"><nobr>7. If the ATA data transfer is via PIO, the ADMA monitors the ATA Status Register and the ATA INTRQ </nobr></div>
<div style="position: absolute; top: 38311px; left: 141px;"><nobr>signal, to determine when the device is ready to transfer data.</nobr></div>
<div style="position: absolute; top: 38336px; left: 114px;"><nobr>8. If the transfer is via Ultra DMA, the ATA device indicates that it is ready, by asserting the ATA signal </nobr></div>
<div style="position: absolute; top: 38354px; left: 141px;"><nobr>DMARQ.</nobr></div>
<div style="position: absolute; top: 38380px; left: 114px;"><nobr>9. When all the data has been transferred as indicated by the APRD count, the ADMA  accesses the next </nobr></div>
<div style="position: absolute; top: 38397px; left: 141px;"><nobr>APRD entry from the address located in the current APRD.  This process is repeated until the total </nobr></div>
<div style="position: absolute; top: 38415px; left: 141px;"><nobr>transfer is complete.</nobr></div>
<div style="position: absolute; top: 38441px; left: 114px;"><nobr>10. At the conclusion of a CPB, the ADMA updates the CPB with status information.  The PCI Interrupt </nobr></div>
<div style="position: absolute; top: 38458px; left: 141px;"><nobr>signal is then asserted if the CPB indicates a request for an interrupt on completion of the CPB, or if an </nobr></div>
<div style="position: absolute; top: 38476px; left: 141px;"><nobr>ATA error occurs.</nobr></div>
<div style="position: absolute; top: 38502px; left: 114px;"><nobr>11. In the single step version the ADMA engine shall go into its idle state and wait for the host to write aGO </nobr></div>
<div style="position: absolute; top: 38519px; left: 141px;"><nobr>as one before accessing the next CPB at step 1.</nobr></div>
<div style="position: absolute; top: 38546px; left: 114px;"><nobr>12. In the continuous version the ADMA shall continue to step 1</nobr></div>
<div style="position: absolute; top: 38567px; left: 75px;"><nobr><b>7.3.9 Queued Operation</b></nobr></div>
<div style="position: absolute; top: 38597px; left: 87px;"><nobr>The overlapped/queued protocols differ for ATA and ATAPI devices.  Only certain commands can be </nobr></div>
<div style="position: absolute; top: 38615px; left: 87px;"><nobr>overlapped or queued.  On each such command, there is a flag in the CPB that indicates that it contains a </nobr></div>
<div style="position: absolute; top: 38632px; left: 87px;"><nobr>queued or overlapped ATA command. Overlapped/queued commands shall not be mixed with non-queued </nobr></div>
<div style="position: absolute; top: 38649px; left: 87px;"><nobr>commands for the same device within a CPB chain.  </nobr></div>
<div style="position: absolute; top: 38676px; left: 114px;"><nobr>a) The sequence commences as in section 7.3.8.  After step 6 in that sequence when the Queued </nobr></div>
<div style="position: absolute; top: 38693px; left: 141px;"><nobr>command is written to the ATA device, the ADMA waits for the DMARQ signal to be asserted, or ATA </nobr></div>
<div style="position: absolute; top: 38710px; left: 141px;"><nobr>BSY to be cleared to zero.</nobr></div>
<div style="position: absolute; top: 38737px; left: 114px;"><nobr>b) If an ATA device is ready to transfer data, it asserts DMARQ and the transfer completes.  If the device is </nobr></div>
<div style="position: absolute; top: 38754px; left: 141px;"><nobr>not ready to transfer data for the current command, it may release the ATA bus, by clearing BSY to zero </nobr></div>
<div style="position: absolute; top: 38771px; left: 141px;"><nobr>and with the ATA Release Bit (REL) set to one.  In either case, the ATA Service Bit (SERV) may be set </nobr></div>
<div style="position: absolute; top: 38789px; left: 141px;"><nobr>to one, to indicate that the device is ready to transfer data for a previously queued command.</nobr></div>
<div style="position: absolute; top: 38815px; left: 114px;"><nobr>c) If the ATA INTRQ signal is asserted and ATA REL is set to one and ATA SERV is cleared to zero, then </nobr></div>
<div style="position: absolute; top: 38831px; left: 141px;"><nobr>the ADMA sets the current CPB to the Released State and proceeds to step 1 in 7.3.8 without asserting </nobr></div>
<div style="position: absolute; top: 38848px; left: 141px;"><nobr>the PCI Interrupt signal.  The next valid CPB is executed, by writing the command to the specified ATA </nobr></div>
<div style="position: absolute; top: 38866px; left: 141px;"><nobr>device, thereby creating a queue of commands in one or both ATA devices.</nobr></div>
<div style="position: absolute; top: 38892px; left: 114px;"><nobr>d) If ATA SERV is set to one, the ADMA writes an ATA Service command to the device, and then polls the </nobr></div>
<div style="position: absolute; top: 38909px; left: 141px;"><nobr>ATA status Register.  When ATA DRQ is set to one, the ADMA reads the TAG from the ATA device, </nobr></div>
<div style="position: absolute; top: 38927px; left: 141px;"><nobr>reads the ATA DEV Bit to determine the current device, and combines the TAG, DEV, and CPBLAR to </nobr></div>
<div style="position: absolute; top: 38944px; left: 141px;"><nobr>fetch the Released CPB’s address from the CPB Lookup Table.  The ADMA then performs the data </nobr></div>
<div style="position: absolute; top: 38961px; left: 141px;"><nobr>transfer as in the non-queued case.</nobr></div>
<div style="position: absolute; top: 38988px; left: 114px;"><nobr>e) When the ATA bus is in the IDLE State, auto-polling is enabled and queues have been built in both </nobr></div>
<div style="position: absolute; top: 39005px; left: 141px;"><nobr>devices on a channel the ADMA alternately selects each device (auto-poll).  This enables a device to </nobr></div>
<div style="position: absolute; top: 39022px; left: 141px;"><nobr>assert the ATA INTRQ signal to indicate that it requires service.  The ADMA stops the auto-poll </nobr></div>
<div style="position: absolute; top: 39040px; left: 141px;"><nobr>sequence if the ATA INTRQ signal is asserted and reverts to step d.</nobr></div>
<div style="position: absolute; top: 39061px; left: 75px;"><nobr><b>7.3.10 Host Control of Ultra DMA Burst Length</b></nobr></div>
<div style="position: absolute; top: 39088px; left: 108px;"><nobr>ADMA provides the host with the ability to control the size of an Ultra DMA data burst.  The device may </nobr></div>
<div style="position: absolute; top: 39106px; left: 108px;"><nobr>choose to provide a smaller burst than requested by the host.  Ultra DMA mode transfers include the use of a </nobr></div>
<div style="position: absolute; top: 39123px; left: 108px;"><nobr>Cyclic Redundancy Check (CRC).  The CRC is calculated over the entire block of data transferred.  A CRC </nobr></div>
<div style="position: absolute; top: 39141px; left: 108px;"><nobr>was introduced into the Ultra DMA protocol to increase the integrity of the data on the ATA cable.  The </nobr></div>
<div style="position: absolute; top: 39158px; left: 108px;"><nobr>effectiveness of a CRC reduces as the length of the transfer increases.  The ADMA has the ability to break </nobr></div>
<div style="position: absolute; top: 39175px; left: 108px;"><nobr>each transfer into smaller units by terminating the burst after transfer of a host-specified number of Sectors.  </nobr></div>
<div style="position: absolute; top: 39193px; left: 108px;"><nobr>The maximum size of each burst is controlled by the APRD for that block of data.</nobr></div>
</span></font>

<div style="position: absolute; top: 39379px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="36"><b>Page 36</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 40518px; left: 681px;"><nobr>Page 22</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 39454px; left: 65px;"><nobr><b>7.4 ADMA PCI Registers</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 39478px; left: 75px;"><nobr><b>7.4.1 PCI Configuration Header Registers</b></nobr></div>
<div style="position: absolute; top: 39509px; left: 87px;"><nobr>All ADMA PCI registers have the standard meaning as defined in the PCI Specification, Issue 2.2.  The ADMA </nobr></div>
<div style="position: absolute; top: 39527px; left: 87px;"><nobr>implements a subset of the standard type 00h configuration header register set.  The implemented registers, </nobr></div>
<div style="position: absolute; top: 39544px; left: 87px;"><nobr>and device-specific values, are described below.  The contents of fields marked 'Reserved' shall be preserved.</nobr></div>
<div style="position: absolute; top: 39578px; left: 245px;"><nobr><b>Table 11 – ADMA PCI Configuration Space Header Registers</b></nobr></div>
<div style="position: absolute; top: 39613px; left: 143px;"><nobr>Bits 31-24</nobr></div>
<div style="position: absolute; top: 39613px; left: 299px;"><nobr>Bits 23-16</nobr></div>
<div style="position: absolute; top: 39613px; left: 459px;"><nobr>Bits 15-8</nobr></div>
<div style="position: absolute; top: 39613px; left: 620px;"><nobr>Bits 7-0</nobr></div>
<div style="position: absolute; top: 39613px; left: 736px;"><nobr>Byte Offset</nobr></div>
<div style="position: absolute; top: 39643px; left: 209px;"><nobr>PCI Device ID</nobr></div>
<div style="position: absolute; top: 39643px; left: 521px;"><nobr>PCI Vendor ID</nobr></div>
<div style="position: absolute; top: 39643px; left: 761px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 39670px; left: 189px;"><nobr>PCI Status Register</nobr></div>
<div style="position: absolute; top: 39670px; left: 491px;"><nobr>PCI Command Register</nobr></div>
<div style="position: absolute; top: 39670px; left: 761px;"><nobr>04h</nobr></div>
<div style="position: absolute; top: 39698px; left: 280px;"><nobr>PCI Class Code</nobr></div>
<div style="position: absolute; top: 39698px; left: 595px;"><nobr>PCI IC Revision</nobr></div>
<div style="position: absolute; top: 39698px; left: 761px;"><nobr>08h</nobr></div>
<div style="position: absolute; top: 39725px; left: 146px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 39725px; left: 277px;"><nobr>PCI Header Type</nobr></div>
<div style="position: absolute; top: 39725px; left: 429px;"><nobr>PCI Latency Timer</nobr></div>
<div style="position: absolute; top: 39725px; left: 577px;"><nobr>PCI Cache Line Size</nobr></div>
<div style="position: absolute; top: 39725px; left: 759px;"><nobr>0Ch</nobr></div>
<div style="position: absolute; top: 39752px; left: 145px;"><nobr>Base Address 0 – Base Address of Command-Block Registers,</nobr></div>
<div style="position: absolute; top: 39752px; left: 577px;"><nobr>ATA Channel X</nobr></div>
<div style="position: absolute; top: 39752px; left: 761px;"><nobr>10h</nobr></div>
<div style="position: absolute; top: 39780px; left: 145px;"><nobr>Base Address 1 – Base Address of Control Registers, </nobr></div>
<div style="position: absolute; top: 39780px; left: 577px;"><nobr>ATA Channel X</nobr></div>
<div style="position: absolute; top: 39780px; left: 761px;"><nobr>14h</nobr></div>
<div style="position: absolute; top: 39807px; left: 144px;"><nobr>Base Address 2 – Base Address of Command-Block Registers,  ATA Channel Y</nobr></div>
<div style="position: absolute; top: 39807px; left: 761px;"><nobr>18h</nobr></div>
<div style="position: absolute; top: 39834px; left: 144px;"><nobr>Base Address 3 – Base Address of Control Registers, </nobr></div>
<div style="position: absolute; top: 39834px; left: 576px;"><nobr>ATA Channel Y</nobr></div>
<div style="position: absolute; top: 39834px; left: 759px;"><nobr>1Ch</nobr></div>
<div style="position: absolute; top: 39862px; left: 117px;"><nobr>Base Address 4/5 – Base Address of Memory Mapped ATA Channel and ADMA Registers</nobr></div>
<div style="position: absolute; top: 39862px; left: 747px;"><nobr>20h-27h</nobr></div>
<div style="position: absolute; top: 39889px; left: 380px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 39889px; left: 761px;"><nobr>28h</nobr></div>
<div style="position: absolute; top: 39916px; left: 194px;"><nobr>PCI Subsystem ID</nobr></div>
<div style="position: absolute; top: 39916px; left: 482px;"><nobr>PCI Subsystem Vendor ID</nobr></div>
<div style="position: absolute; top: 39916px; left: 759px;"><nobr>2Ch</nobr></div>
<div style="position: absolute; top: 39944px; left: 295px;"><nobr>PCI Expansion ROM Base Address</nobr></div>
<div style="position: absolute; top: 39944px; left: 761px;"><nobr>30h</nobr></div>
<div style="position: absolute; top: 39971px; left: 303px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 39971px; left: 585px;"><nobr>PCI Capability Ptr.</nobr></div>
<div style="position: absolute; top: 39971px; left: 761px;"><nobr>34h</nobr></div>
<div style="position: absolute; top: 39998px; left: 380px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 39998px; left: 761px;"><nobr>38h</nobr></div>
<div style="position: absolute; top: 40026px; left: 117px;"><nobr>PCI Max. Latency</nobr></div>
<div style="position: absolute; top: 40026px; left: 284px;"><nobr>PCI Min. Grant</nobr></div>
<div style="position: absolute; top: 40026px; left: 435px;"><nobr>PCI Interrupt Pin</nobr></div>
<div style="position: absolute; top: 40026px; left: 588px;"><nobr>PCI Interrupt Line</nobr></div>
<div style="position: absolute; top: 40026px; left: 759px;"><nobr>3Ch</nobr></div>
<div style="position: absolute; top: 40057px; left: 359px;"><nobr>Vendor Specific</nobr></div>
<div style="position: absolute; top: 40057px; left: 765px;"><nobr>…</nobr></div>
<div style="position: absolute; top: 40087px; left: 155px;"><nobr>Power Management Capability</nobr></div>
<div style="position: absolute; top: 40087px; left: 421px;"><nobr>Ptr. to Nxt Capability</nobr></div>
<div style="position: absolute; top: 40087px; left: 604px;"><nobr>Capability ID</nobr></div>
<div style="position: absolute; top: 40087px; left: 761px;"><nobr>50h</nobr></div>
<div style="position: absolute; top: 40114px; left: 132px;"><nobr>Data Register</nobr></div>
<div style="position: absolute; top: 40114px; left: 268px;"><nobr>Bridge Support Ext.</nobr></div>
<div style="position: absolute; top: 40114px; left: 453px;"><nobr>Power Management Control/Status</nobr></div>
<div style="position: absolute; top: 40114px; left: 761px;"><nobr>54h</nobr></div>
<div style="position: absolute; top: 40142px; left: 359px;"><nobr>Vendor Specific</nobr></div>
<div style="position: absolute; top: 40142px; left: 749px;"><nobr>58-FFh</nobr></div>
<div style="position: absolute; top: 40176px; left: 87px;"><nobr><b>7.4.1.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 40177px; left: 136px;"><nobr><b>PCI Vendor ID</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 40202px; left: 87px;"><nobr>Address offset 00h</nobr></div>
<div style="position: absolute; top: 40232px; left: 87px;"><nobr>Value</nobr></div>
<div style="position: absolute; top: 40232px; left: 195px;"><nobr>xxxxh (PCI Vendor ID)</nobr></div>
<div style="position: absolute; top: 40264px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 40264px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 40294px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 40294px; left: 195px;"><nobr>16 bits</nobr></div>
<div style="position: absolute; top: 40320px; left: 87px;"><nobr><b>7.4.1.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 40321px; left: 136px;"><nobr><b>PCI Device ID</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 40346px; left: 87px;"><nobr>Indicates the implemention ID of the ADMA device.</nobr></div>
<div style="position: absolute; top: 40377px; left: 87px;"><nobr>Address offset 02h</nobr></div>
<div style="position: absolute; top: 40408px; left: 87px;"><nobr>Value</nobr></div>
<div style="position: absolute; top: 40408px; left: 195px;"><nobr>xxxxh (Vendor Specific)</nobr></div>
<div style="position: absolute; top: 40438px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 40438px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 40469px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 40469px; left: 195px;"><nobr>16 bits</nobr></div>
</span></font>

<div style="position: absolute; top: 40567px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="37"><b>Page 37</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 40621px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 41706px; left: 87px;"><nobr>Page 23</nobr></div>
<div style="position: absolute; top: 40643px; left: 87px;"><nobr><b>7.4.1.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 40644px; left: 136px;"><nobr><b>PCI Command Register</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 40669px; left: 87px;"><nobr>The value in this register is set by the host to enable various PCI functions.  Default on reset is everything </nobr></div>
<div style="position: absolute; top: 40687px; left: 87px;"><nobr>disabled.</nobr></div>
<div style="position: absolute; top: 40717px; left: 87px;"><nobr>Address Offset 04h</nobr></div>
<div style="position: absolute; top: 40747px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 40747px; left: 195px;"><nobr>0000h</nobr></div>
<div style="position: absolute; top: 40779px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 40779px; left: 195px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 40809px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 40809px; left: 195px;"><nobr>16 bits</nobr></div>
<div style="position: absolute; top: 40849px; left: 314px;"><nobr><b>Table 12 – ADMA PCI Command Register</b></nobr></div>
<div style="position: absolute; top: 40883px; left: 153px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 40883px; left: 205px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 40883px; left: 520px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 40913px; left: 158px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 40913px; left: 218px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 40913px; left: 281px;"><nobr>Target I/O enable.  A value of zero disables Base Address Registers 0 – 4.</nobr></div>
<div style="position: absolute; top: 40949px; left: 158px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 40949px; left: 218px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 40940px; left: 281px;"><nobr>Memory Space Enable.  A value of zero disables the Expansion ROM Base </nobr></div>
<div style="position: absolute; top: 40958px; left: 281px;"><nobr>Address Register and the Memory Base Address Register.</nobr></div>
<div style="position: absolute; top: 40985px; left: 158px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 40985px; left: 218px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 40985px; left: 281px;"><nobr>Master Enable.  A value of zero disables the Master mode function of the ADMA.</nobr></div>
<div style="position: absolute; top: 41012px; left: 158px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 41012px; left: 227px;"><nobr>R</nobr></div>
<div style="position: absolute; top: 41012px; left: 281px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 41049px; left: 158px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 41049px; left: 218px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 41040px; left: 281px;"><nobr>Memory Write and Invalidate Enable.  A value of zero disables the function in the </nobr></div>
<div style="position: absolute; top: 41057px; left: 281px;"><nobr>ADMA.</nobr></div>
<div style="position: absolute; top: 41084px; left: 158px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 41084px; left: 227px;"><nobr>R</nobr></div>
<div style="position: absolute; top: 41084px; left: 281px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 41112px; left: 158px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 41112px; left: 218px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 41112px; left: 281px;"><nobr>Parity Check Enable.  A value of zero causes parity errors to be ignored.</nobr></div>
<div style="position: absolute; top: 41139px; left: 147px;"><nobr>15-7</nobr></div>
<div style="position: absolute; top: 41139px; left: 227px;"><nobr>R</nobr></div>
<div style="position: absolute; top: 41139px; left: 281px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 41173px; left: 87px;"><nobr><b>7.4.1.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 41174px; left: 136px;"><nobr><b>PCI Status Register</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 41198px; left: 87px;"><nobr>Provides status information related to PCI bus events.  Bits indicated as “clear” are cleared by writing a one to </nobr></div>
<div style="position: absolute; top: 41216px; left: 87px;"><nobr>that bit position.</nobr></div>
<div style="position: absolute; top: 41247px; left: 87px;"><nobr>Address Offset 06h</nobr></div>
<div style="position: absolute; top: 41277px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 41277px; left: 195px;"><nobr>See Table Below</nobr></div>
<div style="position: absolute; top: 41309px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 41309px; left: 195px;"><nobr>Read Only/Clear</nobr></div>
<div style="position: absolute; top: 41339px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 41339px; left: 195px;"><nobr>16 bits</nobr></div>
</span></font>

<div style="position: absolute; top: 41755px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="38"><b>Page 38</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 42894px; left: 681px;"><nobr>Page 24</nobr></div>
<div style="position: absolute; top: 41831px; left: 329px;"><nobr><b>Table 13 – ADMA PCI Status Register</b></nobr></div>
<div style="position: absolute; top: 41866px; left: 96px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 41866px; left: 353px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 41866px; left: 668px;"><nobr>Default</nobr></div>
<div style="position: absolute; top: 41866px; left: 745px;"><nobr>Fixed/Clear</nobr></div>
<div style="position: absolute; top: 41895px; left: 95px;"><nobr>3:0</nobr></div>
<div style="position: absolute; top: 41895px; left: 136px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 41895px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 41895px; left: 777px;"><nobr>R</nobr></div>
<div style="position: absolute; top: 41922px; left: 100px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 41922px; left: 136px;"><nobr>Capabilities Enable.  Set to one to indicate Capabilities are enabled.</nobr></div>
<div style="position: absolute; top: 41922px; left: 681px;"><nobr>VS</nobr></div>
<div style="position: absolute; top: 41922px; left: 777px;"><nobr>F</nobr></div>
<div style="position: absolute; top: 41950px; left: 100px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 41950px; left: 136px;"><nobr>Set to one to indicate 66MHz-Capable</nobr></div>
<div style="position: absolute; top: 41950px; left: 681px;"><nobr>VS</nobr></div>
<div style="position: absolute; top: 41950px; left: 777px;"><nobr>F</nobr></div>
<div style="position: absolute; top: 41977px; left: 100px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 41977px; left: 136px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 41977px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 41977px; left: 777px;"><nobr>R</nobr></div>
<div style="position: absolute; top: 42004px; left: 100px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 42004px; left: 136px;"><nobr>Set to one to indicate it is Fast Back-to-Back Capable. </nobr></div>
<div style="position: absolute; top: 42004px; left: 681px;"><nobr>VS</nobr></div>
<div style="position: absolute; top: 42004px; left: 777px;"><nobr>F</nobr></div>
<div style="position: absolute; top: 42041px; left: 100px;"><nobr>8</nobr></div>
<div style="position: absolute; top: 42032px; left: 136px;"><nobr>Set when, in Master mode, a Data Parity error is detected, and bit 6 of the </nobr></div>
<div style="position: absolute; top: 42049px; left: 136px;"><nobr>PCI command Register is set to one.</nobr></div>
<div style="position: absolute; top: 42041px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 42041px; left: 777px;"><nobr>C</nobr></div>
<div style="position: absolute; top: 42076px; left: 90px;"><nobr>10-9 DEVSEL timing set to medium speed</nobr></div>
<div style="position: absolute; top: 42076px; left: 678px;"><nobr>V S</nobr></div>
<div style="position: absolute; top: 42076px; left: 777px;"><nobr>F</nobr></div>
<div style="position: absolute; top: 42104px; left: 97px;"><nobr>11</nobr></div>
<div style="position: absolute; top: 42104px; left: 136px;"><nobr>Signaled target abort</nobr></div>
<div style="position: absolute; top: 42104px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 42104px; left: 777px;"><nobr>C</nobr></div>
<div style="position: absolute; top: 42131px; left: 97px;"><nobr>12</nobr></div>
<div style="position: absolute; top: 42131px; left: 136px;"><nobr>Received target abort</nobr></div>
<div style="position: absolute; top: 42131px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 42131px; left: 777px;"><nobr>C</nobr></div>
<div style="position: absolute; top: 42158px; left: 97px;"><nobr>13</nobr></div>
<div style="position: absolute; top: 42158px; left: 136px;"><nobr>Received master abort</nobr></div>
<div style="position: absolute; top: 42158px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 42158px; left: 777px;"><nobr>C</nobr></div>
<div style="position: absolute; top: 42186px; left: 97px;"><nobr>14</nobr></div>
<div style="position: absolute; top: 42186px; left: 136px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 42186px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 42186px; left: 777px;"><nobr>R</nobr></div>
<div style="position: absolute; top: 42213px; left: 97px;"><nobr>15</nobr></div>
<div style="position: absolute; top: 42213px; left: 136px;"><nobr>Detected parity error</nobr></div>
<div style="position: absolute; top: 42213px; left: 686px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 42213px; left: 777px;"><nobr>C</nobr></div>
<div style="position: absolute; top: 42240px; left: 89px;"><nobr>VS means Vendor specific.</nobr></div>
<div style="position: absolute; top: 42268px; left: 89px;"><nobr>NOTE - F = fixed value; C = may be read by the host. The host may clear the bit to zero by writing a one to the </nobr></div>
<div style="position: absolute; top: 42285px; left: 89px;"><nobr>bit.</nobr></div>
<div style="position: absolute; top: 42319px; left: 87px;"><nobr><b>7.4.1.5</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 42320px; left: 136px;"><nobr><b>PCI Revision ID</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 42345px; left: 87px;"><nobr>Indicates the IC revision of the ADMA device implementation.</nobr></div>
<div style="position: absolute; top: 42376px; left: 87px;"><nobr>Address Offset 08h</nobr></div>
<div style="position: absolute; top: 42407px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 42407px; left: 195px;"><nobr>xxh (Vendor Specific)</nobr></div>
<div style="position: absolute; top: 42437px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 42437px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 42469px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 42469px; left: 195px;"><nobr>8 bits </nobr></div>
<div style="position: absolute; top: 42494px; left: 87px;"><nobr><b>7.4.1.6</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 42495px; left: 136px;"><nobr><b>PCI Class Code</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 42520px; left: 87px;"><nobr>Address Offset 09h</nobr></div>
<div style="position: absolute; top: 42551px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 42551px; left: 195px;"><nobr>000105h (see Table 14)</nobr></div>
<div style="position: absolute; top: 42582px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 42582px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 42613px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 42613px; left: 195px;"><nobr>24 bits</nobr></div>
<div style="position: absolute; top: 42652px; left: 342px;"><nobr><b>Table 14 – ADMA PCI Class Code</b></nobr></div>
<div style="position: absolute; top: 42687px; left: 230px;"><nobr>Bits</nobr></div>
<div style="position: absolute; top: 42687px; left: 360px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 42687px; left: 594px;"><nobr>Value</nobr></div>
<div style="position: absolute; top: 42725px; left: 228px;"><nobr>15-8</nobr></div>
<div style="position: absolute; top: 42725px; left: 304px;"><nobr>Programming Interface Code</nobr></div>
<div style="position: absolute; top: 42716px; left: 518px;"><nobr>20h – Single Stepping</nobr></div>
<div style="position: absolute; top: 42733px; left: 518px;"><nobr>30h – Continuous Operation</nobr></div>
<div style="position: absolute; top: 42761px; left: 225px;"><nobr>23-16</nobr></div>
<div style="position: absolute; top: 42761px; left: 344px;"><nobr>Sub-class Code</nobr></div>
<div style="position: absolute; top: 42761px; left: 518px;"><nobr>05h – ATA</nobr></div>
<div style="position: absolute; top: 42788px; left: 225px;"><nobr>31-24</nobr></div>
<div style="position: absolute; top: 42788px; left: 340px;"><nobr>Base-Class Code</nobr></div>
<div style="position: absolute; top: 42788px; left: 518px;"><nobr>01h – Mass Storage</nobr></div>
</span></font>

<div style="position: absolute; top: 42943px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="39"><b>Page 39</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 42997px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 44082px; left: 87px;"><nobr>Page 25</nobr></div>
<div style="position: absolute; top: 43019px; left: 87px;"><nobr><b>7.4.1.7</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 43020px; left: 136px;"><nobr><b>PCI Cache Line Size</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 43045px; left: 87px;"><nobr>In Master mode, the Cache Line Size Register in bytes is used to determine the PCI command appropriate for </nobr></div>
<div style="position: absolute; top: 43063px; left: 87px;"><nobr>the burst.  The commands implemented are Memory Read, Memory Read Line, Memory Read Multiple, Memory </nobr></div>
<div style="position: absolute; top: 43079px; left: 87px;"><nobr>Write, and Memory Write Invalidate.  Set by the host BIOS or Operating System.</nobr></div>
<div style="position: absolute; top: 43110px; left: 87px;"><nobr>Address Offset 0Ch</nobr></div>
<div style="position: absolute; top: 43141px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 43141px; left: 195px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 43172px; left: 87px;"><nobr>Attribute </nobr></div>
<div style="position: absolute; top: 43172px; left: 195px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 43202px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 43202px; left: 195px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 43229px; left: 87px;"><nobr><b>7.4.1.8</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 43230px; left: 136px;"><nobr><b>PCI Latency Timer</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 43255px; left: 87px;"><nobr>The host writes a value (in PCI clocks) that is decremented by the ADMA during a master mode transfer.  If the </nobr></div>
<div style="position: absolute; top: 43272px; left: 87px;"><nobr>host deasserts the PCI GNTn signal before this value expires, the ADMA may continue until the latency timer </nobr></div>
<div style="position: absolute; top: 43289px; left: 87px;"><nobr>expires or there is no more data to transfer. If the data transfer is complete before GNTn is de-asserted the </nobr></div>
<div style="position: absolute; top: 43307px; left: 87px;"><nobr>ADMA terminates the bus master transfer. The host BIOS or Operating System sets this register.</nobr></div>
<div style="position: absolute; top: 43337px; left: 87px;"><nobr>Address Offset 0Dh</nobr></div>
<div style="position: absolute; top: 43367px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 43367px; left: 195px;"><nobr>40h</nobr></div>
<div style="position: absolute; top: 43399px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 43399px; left: 195px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 43429px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 43429px; left: 195px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 43455px; left: 87px;"><nobr><b>7.4.1.9</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 43456px; left: 136px;"><nobr><b>PCI Header Type</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 43481px; left: 87px;"><nobr>Indicates that the ADMA is a single-function device.</nobr></div>
<div style="position: absolute; top: 43513px; left: 87px;"><nobr>Address Offset 0Eh</nobr></div>
<div style="position: absolute; top: 43543px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 43543px; left: 195px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 43573px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 43573px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 43605px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 43605px; left: 195px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 43631px; left: 87px;"><nobr><b>7.4.1.10</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 43632px; left: 145px;"><nobr><b>PCI Base Address Registers (BAR)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 43657px; left: 87px;"><nobr>Base Address Registers 0-3 have bit zero hard-wired to one to indicate I/O space, and bits 16-31 hard-wired to </nobr></div>
<div style="position: absolute; top: 43673px; left: 87px;"><nobr>zero.  Full address decoding shall be implemented.  BARs 4-5 have bit zero hard-wired to zero to indicate host </nobr></div>
<div style="position: absolute; top: 43691px; left: 87px;"><nobr>memory address space.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 43716px; left: 87px;"><nobr><b>7.4.1.10.1 PCI Base Address 0</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 43747px; left: 87px;"><nobr>This is the base address for the command block registers for ATA Channel X.</nobr></div>
<div style="position: absolute; top: 43777px; left: 87px;"><nobr>Address Offset 10h</nobr></div>
<div style="position: absolute; top: 43807px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 43807px; left: 195px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 43839px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 43839px; left: 195px;"><nobr>Bits 31-16 Read Only, bits 15-3 Read/Write, bits 2-0 Read Only.</nobr></div>
<div style="position: absolute; top: 43869px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 43869px; left: 195px;"><nobr>32 bits</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 43894px; left: 87px;"><nobr><b>7.4.1.10.2 PCI Base Address 1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 43924px; left: 87px;"><nobr>This is the base address for the Control Registers for ATA Channel X.  Note that, because of the Dword </nobr></div>
<div style="position: absolute; top: 43942px; left: 87px;"><nobr>alignment of PCI, the device Control and Alternate Status Registers are at offset 06h from this base.</nobr></div>
<div style="position: absolute; top: 43973px; left: 87px;"><nobr>Address Offset 14h</nobr></div>
<div style="position: absolute; top: 44003px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 44003px; left: 195px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 44035px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 44035px; left: 195px;"><nobr>Bits 31-16 Read Only, bits 15-3 Read/Write, bits 2-0 Read Only.</nobr></div>
</span></font>

<div style="position: absolute; top: 44131px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="40"><b>Page 40</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 45270px; left: 681px;"><nobr>Page 26</nobr></div>
<div style="position: absolute; top: 44207px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 44207px; left: 195px;"><nobr>32 bits</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 44232px; left: 87px;"><nobr><b>7.4.1.10.3 PCI Base Address 2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 44262px; left: 87px;"><nobr>This is the base address for the command block registers for ATA Channel Y. If the device only supports one </nobr></div>
<div style="position: absolute; top: 44280px; left: 87px;"><nobr>channel this base address is read only and cleared to zero.  Note that, because of the Dword alignment of PCI, </nobr></div>
<div style="position: absolute; top: 44297px; left: 87px;"><nobr>the device Control and Alternate Status Registers are at offset 06h from this base.</nobr></div>
<div style="position: absolute; top: 44327px; left: 87px;"><nobr>Address Offset 18h</nobr></div>
<div style="position: absolute; top: 44359px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 44359px; left: 195px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 44389px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 44389px; left: 195px;"><nobr>Bits 31-16 Read Only; bits15-3 Read/Write, bits 2-0 Read Only.</nobr></div>
<div style="position: absolute; top: 44419px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 44419px; left: 195px;"><nobr>32 bits</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 44445px; left: 87px;"><nobr><b>7.4.1.10.4 PCI Base Address 3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 44474px; left: 87px;"><nobr>This is the base address for the Control Registers for ATA Channel Y. If the device only supports one channel </nobr></div>
<div style="position: absolute; top: 44492px; left: 87px;"><nobr>this base address is read only and cleared to zero.</nobr></div>
<div style="position: absolute; top: 44523px; left: 87px;"><nobr>Address Offset 1Ch</nobr></div>
<div style="position: absolute; top: 44553px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 44553px; left: 195px;"><nobr>00000001h</nobr></div>
<div style="position: absolute; top: 44585px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 44585px; left: 195px;"><nobr>Bits 31-16 Read Only, bits 15-3 Read/Write, bits 2-0 Read Only.</nobr></div>
<div style="position: absolute; top: 44615px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 44615px; left: 195px;"><nobr>32 bits</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 44640px; left: 87px;"><nobr><b>7.4.1.10.5 PCI Base Address 4 and 5</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 44670px; left: 87px;"><nobr>This is the base address for the 64-bit Memory Mapped ATA Channel and ADMA registers.</nobr></div>
<div style="position: absolute; top: 44702px; left: 87px;"><nobr>Address Offset 20h</nobr></div>
<div style="position: absolute; top: 44732px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 44732px; left: 195px;"><nobr>0000000000000004h</nobr></div>
<div style="position: absolute; top: 44762px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 44762px; left: 195px;"><nobr>Bits 63-10 Read/Write; bits 9-0 Read Only. If size is 32 bits then bits 32-63 are Read Only.</nobr></div>
<div style="position: absolute; top: 44794px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 44794px; left: 195px;"><nobr>32 or 64 bits</nobr></div>
<div style="position: absolute; top: 44820px; left: 87px;"><nobr><b>7.4.1.11</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 44821px; left: 145px;"><nobr><b>PCI Subsystem Vendor ID</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 44846px; left: 87px;"><nobr>The PCI subsystem vendor ID indicates the vendor of the adapter.</nobr></div>
<div style="position: absolute; top: 44876px; left: 87px;"><nobr>Address Offset</nobr></div>
<div style="position: absolute; top: 44876px; left: 216px;"><nobr>2Ch</nobr></div>
<div style="position: absolute; top: 44908px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 44908px; left: 195px;"><nobr>xxxxh (PCI Vendor Unique ID)</nobr></div>
<div style="position: absolute; top: 44938px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 44938px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 44968px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 44968px; left: 195px;"><nobr>16 bits</nobr></div>
<div style="position: absolute; top: 44995px; left: 87px;"><nobr><b>7.4.1.12</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 44996px; left: 145px;"><nobr><b>PCI Subsystem ID</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 45021px; left: 87px;"><nobr>The PCI subsystem ID indicates the adapter implementation.</nobr></div>
<div style="position: absolute; top: 45052px; left: 87px;"><nobr>Address Offset 2Eh</nobr></div>
<div style="position: absolute; top: 45082px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 45082px; left: 199px;"><nobr>xxxxh (Vendor Specific)</nobr></div>
<div style="position: absolute; top: 45113px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 45113px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 45144px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 45144px; left: 195px;"><nobr>16 bits</nobr></div>
<div style="position: absolute; top: 45170px; left: 87px;"><nobr><b>7.4.1.13</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 45171px; left: 145px;"><nobr><b>PCI Expansion ROM Base Address</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 45196px; left: 87px;"><nobr>Address Offset 30h</nobr></div>
<div style="position: absolute; top: 45227px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 45227px; left: 195px;"><nobr>If ROM is present this BAR shall contain the size of the ROM in bytes, if no ROM is present this </nobr></div>
<div style="position: absolute; top: 45244px; left: 87px;"><nobr>BAR shall contain 00000000h.</nobr></div>
</span></font>

<div style="position: absolute; top: 45319px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="41"><b>Page 41</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 45373px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 46458px; left: 87px;"><nobr>Page 27</nobr></div>
<div style="position: absolute; top: 45395px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 45395px; left: 195px;"><nobr>Bits 31-17 Read/Write; bits 16-01 Read Only; bit zero Read/Write.</nobr></div>
<div style="position: absolute; top: 45426px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 45426px; left: 195px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 45452px; left: 87px;"><nobr><b>7.4.1.14</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 45453px; left: 145px;"><nobr><b>PCI Capability Pointer</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 45478px; left: 87px;"><nobr>The PCI Capability Pointer points to a linked list of capabilities (i.e., the Power Management Registers).</nobr></div>
<div style="position: absolute; top: 45508px; left: 87px;"><nobr>Address Offset 34h</nobr></div>
<div style="position: absolute; top: 45540px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 45540px; left: 195px;"><nobr>50h</nobr></div>
<div style="position: absolute; top: 45570px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 45570px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 45601px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 45601px; left: 195px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 45628px; left: 87px;"><nobr><b>7.4.1.15</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 45629px; left: 145px;"><nobr><b>PCI Interrupt Line</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 45653px; left: 87px;"><nobr>NOTE - the host BIOS loads the system interrupt (IRQ) allocated to this device.  This Register is not used by </nobr></div>
<div style="position: absolute; top: 45670px; left: 87px;"><nobr>the ADMA.  It may be used by the system BIOS and host software as a location to store the IRQ being used.</nobr></div>
<div style="position: absolute; top: 45701px; left: 87px;"><nobr>Address Offset 3Ch</nobr></div>
<div style="position: absolute; top: 45732px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 45732px; left: 195px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 45763px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 45763px; left: 195px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 45793px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 45793px; left: 195px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 45820px; left: 87px;"><nobr><b>7.4.1.16</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 45821px; left: 145px;"><nobr><b>PCI Interrupt Pin</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 45846px; left: 87px;"><nobr>The PCI interrupt pin defaults to 01h, indicating that the PCI interrupt signal is used.</nobr></div>
<div style="position: absolute; top: 45876px; left: 87px;"><nobr>Address Offset 3Dh</nobr></div>
<div style="position: absolute; top: 45907px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 45907px; left: 195px;"><nobr>01h</nobr></div>
<div style="position: absolute; top: 45938px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 45938px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 45968px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 45968px; left: 195px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 45994px; left: 87px;"><nobr><b>7.4.1.17</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 45995px; left: 145px;"><nobr><b>PCI Minimum Grant</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 46020px; left: 87px;"><nobr>The PCI minimum grant is the minimum burst period in units of 250 ns required by the ADMA.</nobr></div>
<div style="position: absolute; top: 46052px; left: 87px;"><nobr>Address Offset 3Eh</nobr></div>
<div style="position: absolute; top: 46082px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 46082px; left: 195px;"><nobr>xxh</nobr></div>
<div style="position: absolute; top: 46112px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 46112px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 46144px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 46144px; left: 195px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 46170px; left: 87px;"><nobr><b>7.4.1.18</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 46171px; left: 145px;"><nobr><b>PCI Maximum Latency</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 46196px; left: 87px;"><nobr>The default value of 00h indicates that the ADMA has no particular requirement for Maximum Latency.</nobr></div>
<div style="position: absolute; top: 46226px; left: 87px;"><nobr>Address Offset 3Fh</nobr></div>
<div style="position: absolute; top: 46258px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 46258px; left: 195px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 46288px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 46288px; left: 195px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 46318px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 46318px; left: 195px;"><nobr>8 bits</nobr></div>
</span></font>

<div style="position: absolute; top: 46507px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="42"><b>Page 42</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 47646px; left: 681px;"><nobr>Page 28</nobr></div>
<div style="position: absolute; top: 46583px; left: 87px;"><nobr><b>7.4.1.19</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 46584px; left: 145px;"><nobr><b>Power Management Registers (optional)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 46609px; left: 87px;"><nobr>Address Offset 50h </nobr></div>
<div style="position: absolute; top: 46640px; left: 87px;"><nobr>Default Value  see Table 15</nobr></div>
<div style="position: absolute; top: 46670px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 46670px; left: 195px;"><nobr>see Table 15</nobr></div>
<div style="position: absolute; top: 46701px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 46701px; left: 195px;"><nobr>8 Bytes</nobr></div>
<div style="position: absolute; top: 46741px; left: 289px;"><nobr><b>Table 15 – ADMA Power Management Registers</b></nobr></div>
<div style="position: absolute; top: 46771px; left: 137px;"><nobr>Pointer to Next Capability (Read Only)</nobr></div>
<div style="position: absolute; top: 46771px; left: 543px;"><nobr>Capability ID (Read Only)</nobr></div>
<div style="position: absolute; top: 46771px; left: 809px;"><nobr>50h</nobr></div>
<div style="position: absolute; top: 46789px; left: 250px;"><nobr>XXh</nobr></div>
<div style="position: absolute; top: 46789px; left: 614px;"><nobr>01h</nobr></div>
<div style="position: absolute; top: 46808px; left: 304px;"><nobr>Power Management Capability (Read Only)</nobr></div>
<div style="position: absolute; top: 46808px; left: 809px;"><nobr>52h</nobr></div>
<div style="position: absolute; top: 46826px; left: 90px;"><nobr>b15</nobr></div>
<div style="position: absolute; top: 46826px; left: 134px;"><nobr>b14</nobr></div>
<div style="position: absolute; top: 46826px; left: 180px;"><nobr>b13</nobr></div>
<div style="position: absolute; top: 46826px; left: 226px;"><nobr>b12</nobr></div>
<div style="position: absolute; top: 46826px; left: 272px;"><nobr>b11</nobr></div>
<div style="position: absolute; top: 46826px; left: 317px;"><nobr>b10</nobr></div>
<div style="position: absolute; top: 46826px; left: 367px;"><nobr>b9</nobr></div>
<div style="position: absolute; top: 46826px; left: 413px;"><nobr>b8</nobr></div>
<div style="position: absolute; top: 46826px; left: 459px;"><nobr>b7</nobr></div>
<div style="position: absolute; top: 46826px; left: 506px;"><nobr>b6</nobr></div>
<div style="position: absolute; top: 46826px; left: 552px;"><nobr>b5</nobr></div>
<div style="position: absolute; top: 46826px; left: 599px;"><nobr>b4</nobr></div>
<div style="position: absolute; top: 46826px; left: 645px;"><nobr>b3</nobr></div>
<div style="position: absolute; top: 46826px; left: 691px;"><nobr>b2</nobr></div>
<div style="position: absolute; top: 46826px; left: 737px;"><nobr>b1</nobr></div>
<div style="position: absolute; top: 46826px; left: 780px;"><nobr>b0</nobr></div>
<div style="position: absolute; top: 46844px; left: 98px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 142px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 188px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 46844px; left: 234px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 280px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 325px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 46844px; left: 371px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 417px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 464px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 511px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 556px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 602px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 649px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 46844px; left: 694px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46844px; left: 740px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 46844px; left: 783px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46863px; left: 330px;"><nobr>Power Management Control/Status</nobr></div>
<div style="position: absolute; top: 46863px; left: 810px;"><nobr>54h</nobr></div>
<div style="position: absolute; top: 46881px; left: 90px;"><nobr>b15</nobr></div>
<div style="position: absolute; top: 46881px; left: 134px;"><nobr>b14</nobr></div>
<div style="position: absolute; top: 46881px; left: 180px;"><nobr>b13</nobr></div>
<div style="position: absolute; top: 46881px; left: 226px;"><nobr>b12</nobr></div>
<div style="position: absolute; top: 46881px; left: 272px;"><nobr>b11</nobr></div>
<div style="position: absolute; top: 46881px; left: 317px;"><nobr>b10</nobr></div>
<div style="position: absolute; top: 46881px; left: 367px;"><nobr>b9</nobr></div>
<div style="position: absolute; top: 46881px; left: 413px;"><nobr>b8</nobr></div>
<div style="position: absolute; top: 46881px; left: 459px;"><nobr>b7</nobr></div>
<div style="position: absolute; top: 46881px; left: 506px;"><nobr>b6</nobr></div>
<div style="position: absolute; top: 46881px; left: 552px;"><nobr>b5</nobr></div>
<div style="position: absolute; top: 46881px; left: 599px;"><nobr>b4</nobr></div>
<div style="position: absolute; top: 46881px; left: 645px;"><nobr>b3</nobr></div>
<div style="position: absolute; top: 46881px; left: 691px;"><nobr>b2</nobr></div>
<div style="position: absolute; top: 46881px; left: 737px;"><nobr>b1</nobr></div>
<div style="position: absolute; top: 46881px; left: 780px;"><nobr>b0</nobr></div>
<div style="position: absolute; top: 46899px; left: 98px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 142px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 188px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 234px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 280px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 325px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 371px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 406px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 46899px; left: 464px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 511px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 556px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 602px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 649px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 694px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 46899px; left: 730px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 46899px; left: 777px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 46918px; left: 177px;"><nobr>Data Register (Read Only)</nobr></div>
<div style="position: absolute; top: 46918px; left: 502px;"><nobr>Bridge Support Extension (Read Only)</nobr></div>
<div style="position: absolute; top: 46918px; left: 809px;"><nobr>56h</nobr></div>
<div style="position: absolute; top: 46936px; left: 250px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 46936px; left: 614px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 46954px; left: 266px;"><nobr>R/W means that the bit is both read and write capable.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 46983px; left: 87px;"><nobr><b>7.4.1.19.1 Capability ID</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 47012px; left: 87px;"><nobr>The capability ID indicates that the ADMA supports the {PCI PMS}.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 47038px; left: 87px;"><nobr><b>7.4.1.19.2 Pointer to Next Capability</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 47068px; left: 87px;"><nobr>The next capability points to the next capability; 00h indicates the end of the linked list of capabilities.</nobr></div>
</span></font>

<div style="position: absolute; top: 47695px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="43"><b>Page 43</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 47749px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 48834px; left: 87px;"><nobr>Page 29</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 47769px; left: 87px;"><nobr><b>7.4.1.19.3 Power Management Capability</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 47809px; left: 254px;"><nobr><b>Table 16 – ADMA Power Management Capability Register</b></nobr></div>
<div style="position: absolute; top: 47843px; left: 120px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 47843px; left: 449px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 47873px; left: 111px;"><nobr>15-14 Reserved.</nobr></div>
<div style="position: absolute; top: 47909px; left: 122px;"><nobr>13</nobr></div>
<div style="position: absolute; top: 47900px; left: 164px;"><nobr>Set to one indicates that the ADMA may assert PME# from the D2 state if the signal UINTRQ </nobr></div>
<div style="position: absolute; top: 47917px; left: 164px;"><nobr>(unsolicited interrupt) is asserted on either channel.</nobr></div>
<div style="position: absolute; top: 47945px; left: 111px;"><nobr>12-11 Reserved.</nobr></div>
<div style="position: absolute; top: 47972px; left: 122px;"><nobr>10</nobr></div>
<div style="position: absolute; top: 47972px; left: 164px;"><nobr>Set to one indicates that the ADMA supports the D2 (Standby) state.</nobr></div>
<div style="position: absolute; top: 47999px; left: 119px;"><nobr>9-4</nobr></div>
<div style="position: absolute; top: 47999px; left: 164px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 48027px; left: 125px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 48027px; left: 164px;"><nobr>Set to one indicates that the ADMA requires a PCI clock to assert PME#.</nobr></div>
<div style="position: absolute; top: 48054px; left: 119px;"><nobr>2-0</nobr></div>
<div style="position: absolute; top: 48054px; left: 164px;"><nobr>Set to 010b indicates that the ADMA complies with version 1.1 of the {PCI PMS}.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 48087px; left: 87px;"><nobr><b>7.4.1.19.4 Power Management Control/Status</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 48126px; left: 241px;"><nobr><b>Table 17 – ADMA Power Management Control/Status Register</b></nobr></div>
<div style="position: absolute; top: 48160px; left: 120px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 48160px; left: 449px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 48199px; left: 122px;"><nobr>15</nobr></div>
<div style="position: absolute; top: 48190px; left: 164px;"><nobr>Indicates whether PME# can be asserted from power state D3-Cold.  Fixed to zero indicating </nobr></div>
<div style="position: absolute; top: 48207px; left: 164px;"><nobr>that the ADMA does not support PME# assertion from the D3-Cold state.</nobr></div>
<div style="position: absolute; top: 48234px; left: 115px;"><nobr>14-9</nobr></div>
<div style="position: absolute; top: 48234px; left: 164px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 48271px; left: 125px;"><nobr>8</nobr></div>
<div style="position: absolute; top: 48262px; left: 164px;"><nobr>Controls the enable and disable of PME#.  When this bit is set to one, PME# is enabled.  When </nobr></div>
<div style="position: absolute; top: 48279px; left: 164px;"><nobr>this bit is cleared to zero, PME# is disabled.</nobr></div>
<div style="position: absolute; top: 48306px; left: 119px;"><nobr>7-2</nobr></div>
<div style="position: absolute; top: 48306px; left: 164px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 48334px; left: 119px;"><nobr>1-0</nobr></div>
<div style="position: absolute; top: 48334px; left: 164px;"><nobr>Power Management State Control Bits.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 48367px; left: 87px;"><nobr><b>7.4.1.19.5 Power Management State Control Bits:</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 48397px; left: 87px;"><nobr>The power management states D0, D2 and D3 are defined in the PCI Power Management Specification.</nobr></div>
<div style="position: absolute; top: 48432px; left: 259px;"><nobr><b>Table 18 – ADMA Power Management State Control bits.</b></nobr></div>
<div style="position: absolute; top: 48467px; left: 272px;"><nobr>Bit 1(b1)</nobr></div>
<div style="position: absolute; top: 48467px; left: 348px;"><nobr>Bit 0 (b0)</nobr></div>
<div style="position: absolute; top: 48467px; left: 520px;"><nobr>State</nobr></div>
<div style="position: absolute; top: 48496px; left: 296px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 48496px; left: 374px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 48496px; left: 502px;"><nobr>Active (D0)</nobr></div>
<div style="position: absolute; top: 48523px; left: 296px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 48523px; left: 374px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 48523px; left: 518px;"><nobr>Invalid</nobr></div>
<div style="position: absolute; top: 48551px; left: 296px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 48551px; left: 374px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 48551px; left: 495px;"><nobr>Standby (D2)</nobr></div>
<div style="position: absolute; top: 48578px; left: 296px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 48578px; left: 374px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 48578px; left: 503px;"><nobr>Sleep (D3)</nobr></div>
<div style="position: absolute; top: 48612px; left: 87px;"><nobr><b>7.4.1.20</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 48613px; left: 145px;"><nobr><b>Power Management State Transitions</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 48638px; left: 87px;"><nobr>Bits b0 and b1 are power management state control bits defined in Table 18.</nobr></div>
</span></font>

<div style="position: absolute; top: 48883px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="44"><b>Page 44</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 50022px; left: 681px;"><nobr>Page 30</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 10px; font-family: Times;">
<div style="position: absolute; top: 48996px; left: 190px;"><nobr><b>D0 : Active</b></nobr></div>
<div style="position: absolute; top: 48996px; left: 651px;"><nobr><b>D3-Hot : Sleep</b></nobr></div>
<div style="position: absolute; top: 49048px; left: 163px;"><nobr>:D0</nobr></div>
<div style="position: absolute; top: 49027px; left: 113px;"><nobr>Power On, Reset</nobr></div>
<div style="position: absolute; top: 49196px; left: 251px;"><nobr>D0:D2</nobr></div>
<div style="position: absolute; top: 48996px; left: 440px;"><nobr><b>D2 : Standby</b></nobr></div>
<div style="position: absolute; top: 49303px; left: 251px;"><nobr>D0:D3</nobr></div>
<div style="position: absolute; top: 49250px; left: 413px;"><nobr>D2:D0</nobr></div>
<div style="position: absolute; top: 49196px; left: 512px;"><nobr>D2:D3</nobr></div>
<div style="position: absolute; top: 49357px; left: 629px;"><nobr>D3:D0</nobr></div>
<div style="position: absolute; top: 49087px; left: 722px;"><nobr>D3:D3</nobr></div>
<div style="position: absolute; top: 49087px; left: 506px;"><nobr>D2:D2</nobr></div>
<div style="position: absolute; top: 49087px; left: 250px;"><nobr>D0:D0</nobr></div>
<div style="position: absolute; top: 49039px; left: 237px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49053px; left: 246px;"><nobr>00</nobr></div>
<div style="position: absolute; top: 49068px; left: 246px;"><nobr>01</nobr></div>
<div style="position: absolute; top: 49046px; left: 493px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49060px; left: 501px;"><nobr>01</nobr></div>
<div style="position: absolute; top: 49075px; left: 501px;"><nobr>10</nobr></div>
<div style="position: absolute; top: 49025px; left: 710px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49040px; left: 718px;"><nobr>01</nobr></div>
<div style="position: absolute; top: 49054px; left: 718px;"><nobr>10</nobr></div>
<div style="position: absolute; top: 49069px; left: 718px;"><nobr>11</nobr></div>
<div style="position: absolute; top: 49161px; left: 239px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49176px; left: 248px;"><nobr>10</nobr></div>
<div style="position: absolute; top: 49269px; left: 239px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49284px; left: 248px;"><nobr>11</nobr></div>
<div style="position: absolute; top: 49161px; left: 496px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49176px; left: 504px;"><nobr>11</nobr></div>
<div style="position: absolute; top: 49215px; left: 429px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49230px; left: 437px;"><nobr>00</nobr></div>
<div style="position: absolute; top: 49323px; left: 644px;"><nobr>b1:b0</nobr></div>
<div style="position: absolute; top: 49338px; left: 653px;"><nobr>00</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 49409px; left: 287px;"><nobr><b>Figure 3 – Power Management State Transitions</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 49438px; left: 87px;"><nobr><b>7.4.1.20.1 D0:Active State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 49468px; left: 87px;"><nobr>In this state the PCI bus is able to process all requests and the devices attached to the PCI bus are fully </nobr></div>
<div style="position: absolute; top: 49485px; left: 87px;"><nobr>powered.</nobr></div>
<div style="position: absolute; top: 49516px; left: 87px;"><nobr><b>Transition Initialization:D0</b>: Active is the default power management state for the PCI bus</nobr></div>
<div style="position: absolute; top: 49547px; left: 87px;"><nobr><b>Transition D0:D2: </b>When the host sets the ADMA Power Management Control bits to 01b, the ADMA controller </nobr></div>
<div style="position: absolute; top: 49564px; left: 87px;"><nobr>shall enter the standby state.  See 7.4.1.20.2 for more information on the Standby State.</nobr></div>
<div style="position: absolute; top: 49594px; left: 87px;"><nobr><b>Transition D0:D3: </b>When the host sets the ADMA Power Management Control bits to 11b, the ADMA controller </nobr></div>
<div style="position: absolute; top: 49612px; left: 87px;"><nobr>shall enter the D3-Hot: Sleep state.  See 7.4.1.20.3 for more information on the D3-Hot: Sleep state.</nobr></div>
<div style="position: absolute; top: 49643px; left: 87px;"><nobr><b>Transition D0:D0: </b>When the host sets the ADMA Power Management Control bits to 00b, the ADMA controller </nobr></div>
<div style="position: absolute; top: 49660px; left: 87px;"><nobr>shall remain in the active state.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 49685px; left: 87px;"><nobr><b>7.4.1.20.2 D2: Standby State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 49715px; left: 87px;"><nobr>When the host sets the ADMA Power Management Control bits to 01b the ADMA controller shall enter the </nobr></div>
<div style="position: absolute; top: 49733px; left: 87px;"><nobr>Standby state.  In this state the ADMA controller reduces power consumption but can re-enter the active state </nobr></div>
<div style="position: absolute; top: 49750px; left: 87px;"><nobr>with no noticeable delay.</nobr></div>
<div style="position: absolute; top: 49780px; left: 87px;"><nobr><b>Transition D2:D2: </b>When the host sets the ADMA Power Management Control bits to 01b, the ADMA controller </nobr></div>
<div style="position: absolute; top: 49798px; left: 87px;"><nobr>shall remain in the standby state.</nobr></div>
<div style="position: absolute; top: 49828px; left: 87px;"><nobr><b>Transition D2:D3: </b>When the host sets the ADMA Power Management Control bits to 11b, the ADMA controller </nobr></div>
<div style="position: absolute; top: 49845px; left: 87px;"><nobr>shall enter the D3-Hot: Sleep state.  See 7.4.1.20.3 for more information on the D3-Hot: Sleep state.</nobr></div>
<div style="position: absolute; top: 49877px; left: 87px;"><nobr><b>Transition D2:D0: </b>When the host sets the ADMA Power Management Control bits to 00b, the ADMA controller </nobr></div>
<div style="position: absolute; top: 49894px; left: 87px;"><nobr>shall enter the active state.  See 7.4.1.20.1 for more information on the D0: Active State.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 49918px; left: 87px;"><nobr><b>7.4.1.20.3 D3-Hot: Sleep</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 49949px; left: 87px;"><nobr>In this State the ADMA controller is powered down although other devices may remain powered.  The ADMA </nobr></div>
<div style="position: absolute; top: 49967px; left: 87px;"><nobr>controller may be removed from the PCI bus in a Hot-Plug operation once the D3 state has been set.  </nobr></div>
</span></font>

<div style="position: absolute; top: 50071px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="45"><b>Page 45</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 50125px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 51210px; left: 87px;"><nobr>Page 31</nobr></div>
<div style="position: absolute; top: 50147px; left: 87px;"><nobr><b>Transition D3:D3: </b>When the host sets the ADMA Power Management Control bits to 11b or 10b the ADMA </nobr></div>
<div style="position: absolute; top: 50165px; left: 87px;"><nobr>controller shall remain in the D3-Hot: Sleep state.  Once the D3-Hot: Sleep state has been achieved, the only </nobr></div>
<div style="position: absolute; top: 50182px; left: 87px;"><nobr>valid transition out is to enter the active state.</nobr></div>
<div style="position: absolute; top: 50212px; left: 87px;"><nobr><b>Transition D3:D0: </b>When the host sets the ADMA Power Management Control bits to 00b, the ADMA controller </nobr></div>
<div style="position: absolute; top: 50230px; left: 87px;"><nobr>shall enter the active state.  See 7.4.1.20.1 for more information on the D0: Active State.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 50262px; left: 65px;"><nobr><b>7.5 ADMA Registers</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 50291px; left: 87px;"><nobr>The ADMA register map uses 1024 bytes of host memory space.  This includes the ATA Command, Control and </nobr></div>
<div style="position: absolute; top: 50309px; left: 87px;"><nobr>Data port Registers.  All registers may be accessed as byte, word, or Dword entities.  These registers are </nobr></div>
<div style="position: absolute; top: 50326px; left: 87px;"><nobr>addressed via the base address in BAR 4 (Bytes 20h-27h) in the PCI configuration header registers.  The </nobr></div>
<div style="position: absolute; top: 50342px; left: 87px;"><nobr>description of the ADMA registers follows.</nobr></div>
</span></font>

<div style="position: absolute; top: 51259px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="46"><b>Page 46</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 52398px; left: 681px;"><nobr>Page 32</nobr></div>
<div style="position: absolute; top: 51335px; left: 302px;"><nobr><b>Table 19 – ADMA Memory Mapped Registers</b></nobr></div>
<div style="position: absolute; top: 51362px; left: 128px;"><nobr>Bits 31-24</nobr></div>
<div style="position: absolute; top: 51362px; left: 272px;"><nobr>Bits 23-16</nobr></div>
<div style="position: absolute; top: 51362px; left: 416px;"><nobr>Bits 15-8</nobr></div>
<div style="position: absolute; top: 51362px; left: 560px;"><nobr>Bits 7-0</nobr></div>
<div style="position: absolute; top: 51362px; left: 703px;"><nobr>Offset</nobr></div>
<div style="position: absolute; top: 51385px; left: 234px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51385px; left: 487px;"><nobr>Channel X PIO Data</nobr></div>
<div style="position: absolute; top: 51385px; left: 735px;"><nobr>00h</nobr></div>
<div style="position: absolute; top: 51407px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51407px; left: 560px;"><nobr>Ch. X Err/Features</nobr></div>
<div style="position: absolute; top: 51407px; left: 735px;"><nobr>04h</nobr></div>
<div style="position: absolute; top: 51428px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51428px; left: 560px;"><nobr>Ch. X Sector Cnt</nobr></div>
<div style="position: absolute; top: 51428px; left: 735px;"><nobr>08h</nobr></div>
<div style="position: absolute; top: 51449px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51449px; left: 560px;"><nobr>Ch. X LBA Low</nobr></div>
<div style="position: absolute; top: 51449px; left: 734px;"><nobr>0Ch</nobr></div>
<div style="position: absolute; top: 51471px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51471px; left: 560px;"><nobr>Ch. X LBA Mid</nobr></div>
<div style="position: absolute; top: 51471px; left: 735px;"><nobr>10h</nobr></div>
<div style="position: absolute; top: 51492px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51492px; left: 560px;"><nobr>Ch. X LBA High</nobr></div>
<div style="position: absolute; top: 51492px; left: 735px;"><nobr>14h</nobr></div>
<div style="position: absolute; top: 51514px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51514px; left: 560px;"><nobr>Ch. X Dev. Head</nobr></div>
<div style="position: absolute; top: 51514px; left: 735px;"><nobr>18h</nobr></div>
<div style="position: absolute; top: 51535px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51535px; left: 560px;"><nobr>Ch. X Stat/Cmd</nobr></div>
<div style="position: absolute; top: 51535px; left: 734px;"><nobr>1Ch</nobr></div>
<div style="position: absolute; top: 51556px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51556px; left: 560px;"><nobr>ADMA Standard</nobr></div>
<div style="position: absolute; top: 51556px; left: 735px;"><nobr>20h</nobr></div>
<div style="position: absolute; top: 51578px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51578px; left: 720px;"><nobr>21h-37h</nobr></div>
<div style="position: absolute; top: 51599px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51599px; left: 560px;"><nobr>Ch. X Alt Stat/Ctrl</nobr></div>
<div style="position: absolute; top: 51599px; left: 735px;"><nobr>38h</nobr></div>
<div style="position: absolute; top: 51620px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51620px; left: 734px;"><nobr>3Ch</nobr></div>
<div style="position: absolute; top: 51642px; left: 234px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51642px; left: 486px;"><nobr>Channel Y PIO Data</nobr></div>
<div style="position: absolute; top: 51642px; left: 735px;"><nobr>40h</nobr></div>
<div style="position: absolute; top: 51663px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51663px; left: 560px;"><nobr>Ch. Y Err/Features</nobr></div>
<div style="position: absolute; top: 51663px; left: 735px;"><nobr>44h</nobr></div>
<div style="position: absolute; top: 51685px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51685px; left: 560px;"><nobr>Ch. Y Sector Cnt</nobr></div>
<div style="position: absolute; top: 51685px; left: 735px;"><nobr>48h</nobr></div>
<div style="position: absolute; top: 51706px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51706px; left: 560px;"><nobr>Ch. Y LBA Low</nobr></div>
<div style="position: absolute; top: 51706px; left: 734px;"><nobr>4Ch</nobr></div>
<div style="position: absolute; top: 51727px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51727px; left: 560px;"><nobr>Ch. Y LBA Mid</nobr></div>
<div style="position: absolute; top: 51727px; left: 735px;"><nobr>50h</nobr></div>
<div style="position: absolute; top: 51749px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51749px; left: 560px;"><nobr>Ch. Y LBA High</nobr></div>
<div style="position: absolute; top: 51749px; left: 735px;"><nobr>54h</nobr></div>
<div style="position: absolute; top: 51770px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51770px; left: 560px;"><nobr>Ch. Y Dev. Head</nobr></div>
<div style="position: absolute; top: 51770px; left: 735px;"><nobr>58h</nobr></div>
<div style="position: absolute; top: 51791px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51791px; left: 560px;"><nobr>Ch. Y Stat/Cmd</nobr></div>
<div style="position: absolute; top: 51791px; left: 734px;"><nobr>5Ch</nobr></div>
<div style="position: absolute; top: 51813px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51813px; left: 720px;"><nobr>60h-77h</nobr></div>
<div style="position: absolute; top: 51834px; left: 306px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51834px; left: 560px;"><nobr>Ch. Y Alt Stat/Ctrl</nobr></div>
<div style="position: absolute; top: 51834px; left: 735px;"><nobr>78h</nobr></div>
<div style="position: absolute; top: 51856px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51856px; left: 734px;"><nobr>7Ch</nobr></div>
<div style="position: absolute; top: 51877px; left: 162px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51877px; left: 279px;"><nobr>Ch. X ADMA Stat</nobr></div>
<div style="position: absolute; top: 51877px; left: 477px;"><nobr>Chan. X ADMA Control</nobr></div>
<div style="position: absolute; top: 51877px; left: 735px;"><nobr>80h</nobr></div>
<div style="position: absolute; top: 51897px; left: 234px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 51897px; left: 439px;"><nobr>Chan. X ADMA CPB Search Count</nobr></div>
<div style="position: absolute; top: 51897px; left: 735px;"><nobr>84h</nobr></div>
<div style="position: absolute; top: 51919px; left: 286px;"><nobr>Chan. X ADMA Current CPB Address</nobr></div>
<div style="position: absolute; top: 51919px; left: 735px;"><nobr>88h</nobr></div>
<div style="position: absolute; top: 51940px; left: 295px;"><nobr>Chan. X ADMA Next CPB Address</nobr></div>
<div style="position: absolute; top: 51940px; left: 734px;"><nobr>8Ch</nobr></div>
<div style="position: absolute; top: 51961px; left: 290px;"><nobr>Chan. X CPB Lookup Table Address</nobr></div>
<div style="position: absolute; top: 51961px; left: 735px;"><nobr>90h</nobr></div>
<div style="position: absolute; top: 51983px; left: 138px;"><nobr>Chan. X ADMA FIFO Output Threshold</nobr></div>
<div style="position: absolute; top: 51983px; left: 432px;"><nobr>Chan. X ADMA FIFO Input Threshold</nobr></div>
<div style="position: absolute; top: 51983px; left: 735px;"><nobr>94h</nobr></div>
<div style="position: absolute; top: 52004px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 52004px; left: 720px;"><nobr>98h-9Fh</nobr></div>
<div style="position: absolute; top: 52025px; left: 162px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 52025px; left: 278px;"><nobr>Ch. Y ADMA Stat</nobr></div>
<div style="position: absolute; top: 52025px; left: 476px;"><nobr>Chan. Y ADMA Control</nobr></div>
<div style="position: absolute; top: 52025px; left: 734px;"><nobr>A0h</nobr></div>
<div style="position: absolute; top: 52047px; left: 234px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 52047px; left: 438px;"><nobr>Chan. Y ADMA CPB Search Count</nobr></div>
<div style="position: absolute; top: 52047px; left: 734px;"><nobr>A4h</nobr></div>
<div style="position: absolute; top: 52068px; left: 285px;"><nobr>Chan. Y ADMA Current CPB Address</nobr></div>
<div style="position: absolute; top: 52068px; left: 734px;"><nobr>A8h</nobr></div>
<div style="position: absolute; top: 52090px; left: 294px;"><nobr>Chan. Y ADMA Next CPB Address</nobr></div>
<div style="position: absolute; top: 52090px; left: 732px;"><nobr>ACh</nobr></div>
<div style="position: absolute; top: 52111px; left: 289px;"><nobr>Chan. Y CPB Lookup Table Address</nobr></div>
<div style="position: absolute; top: 52111px; left: 734px;"><nobr>B0h</nobr></div>
<div style="position: absolute; top: 52132px; left: 137px;"><nobr>Chan. Y ADMA FIFO Output Threshold</nobr></div>
<div style="position: absolute; top: 52132px; left: 431px;"><nobr>Chan. Y ADMA FIFO Input Threshold</nobr></div>
<div style="position: absolute; top: 52132px; left: 734px;"><nobr>B4h</nobr></div>
<div style="position: absolute; top: 52154px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 52154px; left: 716px;"><nobr>B8h- BFh</nobr></div>
<div style="position: absolute; top: 52175px; left: 357px;"><nobr>Vendor Specific</nobr></div>
<div style="position: absolute; top: 52175px; left: 734px;"><nobr>C0h</nobr></div>
<div style="position: absolute; top: 52196px; left: 357px;"><nobr>Vendor Specific</nobr></div>
<div style="position: absolute; top: 52196px; left: 734px;"><nobr>C4h</nobr></div>
<div style="position: absolute; top: 52218px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 52218px; left: 718px;"><nobr>C8h-D3h</nobr></div>
<div style="position: absolute; top: 52239px; left: 333px;"><nobr>BIOS Message Pointer</nobr></div>
<div style="position: absolute; top: 52239px; left: 734px;"><nobr>D4h</nobr></div>
<div style="position: absolute; top: 52261px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 52261px; left: 734px;"><nobr>D8h</nobr></div>
<div style="position: absolute; top: 52282px; left: 305px;"><nobr>Host Software Message Pointer</nobr></div>
<div style="position: absolute; top: 52282px; left: 732px;"><nobr>DCh</nobr></div>
<div style="position: absolute; top: 52303px; left: 357px;"><nobr>Vendor Specific</nobr></div>
<div style="position: absolute; top: 52303px; left: 714px;"><nobr>E0h-17Fh</nobr></div>
<div style="position: absolute; top: 52325px; left: 378px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 52325px; left: 711px;"><nobr>180h-3FFh</nobr></div>
</span></font>

<div style="position: absolute; top: 52447px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="47"><b>Page 47</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 52501px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 53586px; left: 87px;"><nobr>Page 33</nobr></div>
<div style="position: absolute; top: 52523px; left: 75px;"><nobr><b>7.5.1 ATA Channel X Command and Control Registers</b></nobr></div>
<div style="position: absolute; top: 52554px; left: 87px;"><nobr>Reading or writing these registers shall cause a corresponding read or write of the ATA command and control </nobr></div>
<div style="position: absolute; top: 52571px; left: 87px;"><nobr>block registers of the ATA devices connected to that channel. The registers may be written or read as 32bit </nobr></div>
<div style="position: absolute; top: 52588px; left: 87px;"><nobr>values but only the bits indicated in Table 19 shall either be driven on or read from the ATA channel. All other </nobr></div>
<div style="position: absolute; top: 52606px; left: 87px;"><nobr>bits written shall be ignored and shall be read as zero.</nobr></div>
<div style="position: absolute; top: 52653px; left: 75px;"><nobr><b>7.5.2 ADMA Identify Registers</b></nobr></div>
<div style="position: absolute; top: 52685px; left: 87px;"><nobr>This register space is used to provide version and other information regarding the capabilities of the ADMA </nobr></div>
<div style="position: absolute; top: 52702px; left: 87px;"><nobr>device. Software may determine the type and capability of the device by combining the PCI class code (see </nobr></div>
<div style="position: absolute; top: 52718px; left: 87px;"><nobr>6.6.1) and the information in these registers.</nobr></div>
<div style="position: absolute; top: 52741px; left: 87px;"><nobr><b>7.5.2.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 52742px; left: 136px;"><nobr><b>ADMA Standard Register</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 52767px; left: 87px;"><nobr>This register indicates which version of the standard the device conforms to.</nobr></div>
<div style="position: absolute; top: 52793px; left: 87px;"><nobr>Address offset Base + 20h</nobr></div>
<div style="position: absolute; top: 52819px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 52819px; left: 260px;"><nobr>00h (Indicates the device conforms to this standard).</nobr></div>
<div style="position: absolute; top: 52846px; left: 87px;"><nobr>Attributes</nobr></div>
<div style="position: absolute; top: 52846px; left: 260px;"><nobr>Read Only </nobr></div>
<div style="position: absolute; top: 52871px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 52871px; left: 260px;"><nobr>8bits</nobr></div>
<div style="position: absolute; top: 52893px; left: 87px;"><nobr><b>7.5.2.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 52894px; left: 136px;"><nobr><b>Reserved Identification Registers</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 52919px; left: 87px;"><nobr>Address offset Base +21h</nobr></div>
<div style="position: absolute; top: 52946px; left: 87px;"><nobr>Default value </nobr></div>
<div style="position: absolute; top: 52946px; left: 260px;"><nobr>cleared to zero.</nobr></div>
<div style="position: absolute; top: 52972px; left: 87px;"><nobr>Size </nobr></div>
<div style="position: absolute; top: 52972px; left: 260px;"><nobr>17Bytes</nobr></div>
<div style="position: absolute; top: 52993px; left: 75px;"><nobr><b>7.5.3 ADMA Control Register (ADMCTL)</b></nobr></div>
<div style="position: absolute; top: 53024px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 53024px; left: 281px;"><nobr>Base + 80h</nobr></div>
<div style="position: absolute; top: 53050px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 53050px; left: 281px;"><nobr>Base + A0h  (If the device does not support channel Y this register shall be read </nobr></div>
<div style="position: absolute; top: 53067px; left: 87px;"><nobr>only and cleared to zero).</nobr></div>
<div style="position: absolute; top: 53094px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 53094px; left: 281px;"><nobr>100h</nobr></div>
<div style="position: absolute; top: 53120px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 53120px; left: 260px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 53146px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 53146px; left: 281px;"><nobr>16 bits</nobr></div>
</span></font>

<div style="position: absolute; top: 53635px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="48"><b>Page 48</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 54774px; left: 681px;"><nobr>Page 34</nobr></div>
<div style="position: absolute; top: 53711px; left: 339px;"><nobr><b>Table 20 – ADMA Control Register</b></nobr></div>
<div style="position: absolute; top: 53746px; left: 78px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 53746px; left: 122px;"><nobr>Name</nobr></div>
<div style="position: absolute; top: 53746px; left: 182px;"><nobr>Reset</nobr></div>
<div style="position: absolute; top: 53746px; left: 500px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 53775px; left: 73px;"><nobr>15-9</nobr></div>
<div style="position: absolute; top: 53775px; left: 198px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 53775px; left: 232px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 53819px; left: 83px;"><nobr>8</nobr></div>
<div style="position: absolute; top: 53819px; left: 125px;"><nobr>aIEN</nobr></div>
<div style="position: absolute; top: 53819px; left: 198px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 53802px; left: 232px;"><nobr>PCI channel interrupt disable bit.  When cleared to zero, interrupts generated by the  channel </nobr></div>
<div style="position: absolute; top: 53820px; left: 232px;"><nobr>when in the ATA Register Mode are propagated through to the PCI bus.  When set to one, </nobr></div>
<div style="position: absolute; top: 53837px; left: 232px;"><nobr>interrupts generated by the channel are not propagated to the PCI bus</nobr></div>
<div style="position: absolute; top: 53911px; left: 83px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 53911px; left: 126px;"><nobr>aGO</nobr></div>
<div style="position: absolute; top: 53911px; left: 198px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 53864px; left: 232px;"><nobr>ADMA GO Bit.  When set to one, the ADMA can run.  When cleared to zero, the channel </nobr></div>
<div style="position: absolute; top: 53882px; left: 232px;"><nobr>operates only in ATA Register Mode.  The host writes a one to this bit each time that a CPB </nobr></div>
<div style="position: absolute; top: 53899px; left: 232px;"><nobr>has been updated, to notify the ADMA that there is another CPB to service.  The ADMA </nobr></div>
<div style="position: absolute; top: 53915px; left: 232px;"><nobr>shall not clear this bit.</nobr></div>
<div style="position: absolute; top: 53942px; left: 232px;"><nobr>NOTE - When this bit is cleared to zero by the host, the ADMA immediately ceases all </nobr></div>
<div style="position: absolute; top: 53959px; left: 232px;"><nobr>operations and goes to ATA Register Mode; the state of the current CPB is indeterminate.</nobr></div>
<div style="position: absolute; top: 54012px; left: 83px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 54012px; left: 122px;"><nobr>aPSE</nobr></div>
<div style="position: absolute; top: 54012px; left: 198px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 53986px; left: 232px;"><nobr>ADMA PAUSE Bit.  When set to one, the ADMA does not follow the CPB chain nor access </nobr></div>
<div style="position: absolute; top: 54004px; left: 232px;"><nobr>the CPB Lookup Table.  If set to one  while a CPB is being processed, the ADMA completes </nobr></div>
<div style="position: absolute; top: 54021px; left: 232px;"><nobr>the  CPB  and  then  PAUSES.  The  host  shall  pause  operations  before  modifying  the  CPB </nobr></div>
<div style="position: absolute; top: 54038px; left: 232px;"><nobr>chain pointers by the use of aPSE and aPSD </nobr></div>
<div style="position: absolute; top: 54075px; left: 83px;"><nobr>5 aRSTADM</nobr></div>
<div style="position: absolute; top: 54075px; left: 198px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 54066px; left: 232px;"><nobr>RESET  ADMA  Channel  to  the  IDLE  state.  Set  to  one  by  the  host  to  indicate a reset is </nobr></div>
<div style="position: absolute; top: 54083px; left: 232px;"><nobr>required.  Cleared by the host after 1µs to allow the ADMA to come out of the IDLE state.</nobr></div>
<div style="position: absolute; top: 54110px; left: 83px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 54110px; left: 232px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 54164px; left: 83px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 54164px; left: 113px;"><nobr>aAUTEN</nobr></div>
<div style="position: absolute; top: 54164px; left: 198px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 54138px; left: 232px;"><nobr>ADMA AUTO-POLL ENABLE Bit.  When set to one, the ADMA and there is no other activity </nobr></div>
<div style="position: absolute; top: 54155px; left: 232px;"><nobr>on  the  channel  the  ADMA  repeatedly alternates  selection  of  each  device  on  the  channel </nobr></div>
<div style="position: absolute; top: 54172px; left: 232px;"><nobr>when  waiting  for  interrupts,.This  enables  a  device  to  assert  a  Service  Interrupt  in  an</nobr></div>
<div style="position: absolute; top: 54190px; left: 232px;"><nobr>overlapped or queued situation.</nobr></div>
<div style="position: absolute; top: 54234px; left: 83px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 54234px; left: 118px;"><nobr>aRSTA</nobr></div>
<div style="position: absolute; top: 54234px; left: 198px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 54217px; left: 232px;"><nobr>ATA HARD RESET Bit.  When set to one, the ATA reset signal is asserted.  For the host to </nobr></div>
<div style="position: absolute; top: 54234px; left: 232px;"><nobr>reset the ATA channel, the host shall set this bit to one, wait for the minimum reset time </nobr></div>
<div style="position: absolute; top: 54252px; left: 232px;"><nobr>defined in the {ATA Standard}, and then clear this bit to zero.</nobr></div>
<div style="position: absolute; top: 54326px; left: 78px;"><nobr>1-0 aPIOMD</nobr></div>
<div style="position: absolute; top: 54326px; left: 194px;"><nobr>00</nobr></div>
<div style="position: absolute; top: 54279px; left: 232px;"><nobr>DEFAULT PIO MODE.  Used in ATA Register Mode to define the ATA PIO timing.  00 = </nobr></div>
<div style="position: absolute; top: 54296px; left: 232px;"><nobr>Mode 1, 01 = Mode 2, 10 = Mode 3, 11 = Mode 4.  ATA mode zero is not supported.</nobr></div>
<div style="position: absolute; top: 54322px; left: 232px;"><nobr>The value in this register shall be the highest PIO mode supported by the slowest device on </nobr></div>
<div style="position: absolute; top: 54340px; left: 232px;"><nobr>the channel.  The mode selected is used for all accesses to the ATA command and control </nobr></div>
<div style="position: absolute; top: 54356px; left: 232px;"><nobr>block registers, in ATA Register and ADMA Mode.  When in ATA Register Mode, the PIO </nobr></div>
<div style="position: absolute; top: 54373px; left: 232px;"><nobr>mode selected is used for access to the ATA data port (PIO mode).</nobr></div>
<div style="position: absolute; top: 54425px; left: 75px;"><nobr><b>7.5.4 ADMA Status Register (ADMSTAT)</b></nobr></div>
<div style="position: absolute; top: 54455px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 54455px; left: 281px;"><nobr>Base + 82h</nobr></div>
<div style="position: absolute; top: 54482px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 54482px; left: 281px;"><nobr>Base + A2h (If the device does not support channel this register shall be read only </nobr></div>
<div style="position: absolute; top: 54499px; left: 87px;"><nobr>and cleared to zero).</nobr></div>
<div style="position: absolute; top: 54525px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 54525px; left: 281px;"><nobr>See Table 21</nobr></div>
<div style="position: absolute; top: 54552px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 54552px; left: 281px;"><nobr>8 bits</nobr></div>
<div style="position: absolute; top: 54578px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 54578px; left: 260px;"><nobr>Read/Clear</nobr></div>
<div style="position: absolute; top: 54604px; left: 87px;"><nobr>Can be read by the host at any time. Reading the register clears bits 0, 1, and 7 to zero and de-asserts the PCI </nobr></div>
<div style="position: absolute; top: 54622px; left: 87px;"><nobr>Interrupt signal.</nobr></div>
</span></font>

<div style="position: absolute; top: 54823px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="49"><b>Page 49</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 54877px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 55962px; left: 87px;"><nobr>Page 35</nobr></div>
<div style="position: absolute; top: 54899px; left: 343px;"><nobr><b>Table 21 – ADMA Status Register</b></nobr></div>
<div style="position: absolute; top: 54934px; left: 91px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 54934px; left: 140px;"><nobr>Name</nobr></div>
<div style="position: absolute; top: 54934px; left: 208px;"><nobr>Reset</nobr></div>
<div style="position: absolute; top: 54934px; left: 520px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 54963px; left: 97px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 54963px; left: 134px;"><nobr>aDONE</nobr></div>
<div style="position: absolute; top: 54963px; left: 224px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 54963px; left: 261px;"><nobr>ADMA DONE Bit.  When set to one, indicates the ADMA has finished one or more CPBs.</nobr></div>
<div style="position: absolute; top: 54999px; left: 97px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 54999px; left: 140px;"><nobr>aPSD</nobr></div>
<div style="position: absolute; top: 54999px; left: 224px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 54990px; left: 261px;"><nobr>ADMA PAUSED Bit.  When set to one, indicates the ADMA has stopped as a result of </nobr></div>
<div style="position: absolute; top: 55008px; left: 261px;"><nobr>aPSE being set.  The current transfer has been completed.</nobr></div>
<div style="position: absolute; top: 55061px; left: 97px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 55061px; left: 135px;"><nobr>aSTPD</nobr></div>
<div style="position: absolute; top: 55061px; left: 224px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 55035px; left: 261px;"><nobr>ADMA STOPPED Bit.  When set to one, indicates the ADMA has stopped as a result of </nobr></div>
<div style="position: absolute; top: 55052px; left: 261px;"><nobr>aGO being cleared, an error occurring, or no more valid CPBs to be processed. See </nobr></div>
<div style="position: absolute; top: 55070px; left: 261px;"><nobr><b>Error! Reference source not found. </b>for details of the transitions that result in aSTPD </nobr></div>
<div style="position: absolute; top: 55087px; left: 261px;"><nobr>being set to one.</nobr></div>
<div style="position: absolute; top: 55123px; left: 97px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 55123px; left: 137px;"><nobr>aUIRQ</nobr></div>
<div style="position: absolute; top: 55123px; left: 224px;"><nobr>X</nobr></div>
<div style="position: absolute; top: 55114px; left: 261px;"><nobr>ATA UNSOLICITED IRQ Bit.  When set to one, indicates the ATA unsolicited interrupt line </nobr></div>
<div style="position: absolute; top: 55132px; left: 261px;"><nobr>is active.</nobr></div>
<div style="position: absolute; top: 55159px; left: 97px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 55159px; left: 135px;"><nobr>aLGCY</nobr></div>
<div style="position: absolute; top: 55159px; left: 224px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 55159px; left: 261px;"><nobr>ADMA LEGACY Bit.  When set to one, indicates that the ADMA is in ATA Register Mode.</nobr></div>
<div style="position: absolute; top: 55186px; left: 97px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 55186px; left: 224px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 55186px; left: 261px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 55231px; left: 97px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 55231px; left: 124px;"><nobr>aCPBERR</nobr></div>
<div style="position: absolute; top: 55231px; left: 224px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 55214px; left: 261px;"><nobr>ADMA CPB Error Bit.  When set to one, indicates that at least one of the CPB-error </nobr></div>
<div style="position: absolute; top: 55231px; left: 261px;"><nobr>response flags in the CPB has been set to one except in the case of cPSEXC (Table 22) </nobr></div>
<div style="position: absolute; top: 55247px; left: 261px;"><nobr>and pIGEX (Table 24) set to one.</nobr></div>
<div style="position: absolute; top: 55276px; left: 97px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 55276px; left: 134px;"><nobr>aPERR</nobr></div>
<div style="position: absolute; top: 55276px; left: 224px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 55276px; left: 261px;"><nobr>PCI ERROR Bit. When set to one, indicates that a PCI error has occurred.</nobr></div>
<div style="position: absolute; top: 55309px; left: 75px;"><nobr><b>7.5.5 ADMA CPB Search Count Register (CCNT)</b></nobr></div>
<div style="position: absolute; top: 55340px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 55340px; left: 281px;"><nobr>Base + 84h</nobr></div>
<div style="position: absolute; top: 55367px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 55367px; left: 281px;"><nobr>Base + A4h (If the device does not support channel this register shall be read only </nobr></div>
<div style="position: absolute; top: 55384px; left: 87px;"><nobr>and cleared to zero).</nobr></div>
<div style="position: absolute; top: 55409px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 55409px; left: 281px;"><nobr>0000h</nobr></div>
<div style="position: absolute; top: 55436px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 55436px; left: 281px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 55462px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 55462px; left: 281px;"><nobr>16 bits</nobr></div>
<div style="position: absolute; top: 55488px; left: 87px;"><nobr>The purpose of this register is to limit the number of CPB’s scanned by the ADMA.  This prevents the ADMA </nobr></div>
<div style="position: absolute; top: 55506px; left: 87px;"><nobr>from requiring the PCI bus when there are no valid CPB’s.  The ADMA CPB Search Count Register holds a </nobr></div>
<div style="position: absolute; top: 55523px; left: 87px;"><nobr>value that is copied into the Internal Down-Counter each time either a write occurs to ADMCTL with the ADMA </nobr></div>
<div style="position: absolute; top: 55540px; left: 87px;"><nobr>aGO Bit set or the ADMA reads a CPB with the cVLD Bit set and the cDONE Bit clear.  The down-counter </nobr></div>
<div style="position: absolute; top: 55557px; left: 87px;"><nobr>decrements each time the ADMA reads a CPB with the cVLD Bit clear, cREL set to one or the cDONE Bit set to </nobr></div>
<div style="position: absolute; top: 55575px; left: 87px;"><nobr>one.  When the down counter reaches zero, the ADMA sets aDONE and transitions to the IDLE state.  The </nobr></div>
<div style="position: absolute; top: 55592px; left: 87px;"><nobr>value loaded into this register is normally (but not necessarily) related to the number of CPBs in the chain.  This </nobr></div>
<div style="position: absolute; top: 55609px; left: 87px;"><nobr>value shall be greater than zero.</nobr></div>
<div style="position: absolute; top: 55631px; left: 75px;"><nobr><b>7.5.6 ADMA Current CPB Address (CCPB)</b></nobr></div>
<div style="position: absolute; top: 55661px; left: 87px;"><nobr>The ADMA Current CPB Address Register points to the address of the CPB currently being processed.  It is </nobr></div>
<div style="position: absolute; top: 55678px; left: 87px;"><nobr>loaded by the ADMA whenever a CPB is read or, in the case of queued operation, the CPB Lookup Table is </nobr></div>
<div style="position: absolute; top: 55696px; left: 87px;"><nobr>read.</nobr></div>
<div style="position: absolute; top: 55722px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 55722px; left: 281px;"><nobr>Base + 88h</nobr></div>
<div style="position: absolute; top: 55748px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 55748px; left: 281px;"><nobr>Base + A8h (If the device does not support channel this register shall be read only </nobr></div>
<div style="position: absolute; top: 55766px; left: 87px;"><nobr>and cleared to zero).</nobr></div>
<div style="position: absolute; top: 55792px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 55792px; left: 281px;"><nobr>00000000h</nobr></div>
<div style="position: absolute; top: 55818px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 55818px; left: 281px;"><nobr>Read Only</nobr></div>
<div style="position: absolute; top: 55845px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 55845px; left: 281px;"><nobr>32 bits</nobr></div>
</span></font>

<div style="position: absolute; top: 56011px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="50"><b>Page 50</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 57150px; left: 681px;"><nobr>Page 36</nobr></div>
<div style="position: absolute; top: 56087px; left: 75px;"><nobr><b>7.5.7 ADMA Next CPB Address (NCPB)</b></nobr></div>
<div style="position: absolute; top: 56118px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 56118px; left: 281px;"><nobr>Base + 8Ch</nobr></div>
<div style="position: absolute; top: 56144px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 56144px; left: 281px;"><nobr>Base + ACh (If the device does not support channel this register shall be read only </nobr></div>
<div style="position: absolute; top: 56161px; left: 87px;"><nobr>and cleared to zero).</nobr></div>
<div style="position: absolute; top: 56188px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 56188px; left: 281px;"><nobr>00000000h</nobr></div>
<div style="position: absolute; top: 56214px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 56214px; left: 281px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 56240px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 56240px; left: 281px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 56267px; left: 87px;"><nobr>The ADMA Next CPB Address Register is initialized by the host to point to the first CPB in a chain that the host </nobr></div>
<div style="position: absolute; top: 56284px; left: 87px;"><nobr>has constructed in host memory.  The address shall be a physical address. This register is updated by the </nobr></div>
<div style="position: absolute; top: 56300px; left: 87px;"><nobr>ADMA each time it reads a CPB, except when retrieving a CPB from the Lookup Table.  The host shall not write </nobr></div>
<div style="position: absolute; top: 56318px; left: 87px;"><nobr>to this register unless the ADMA is in the Legacy Idle or the Paused State (see 7.7).  The CPB pointed to by this </nobr></div>
<div style="position: absolute; top: 56335px; left: 87px;"><nobr>register may not physically follow the CPB pointed to by the CCPB pointer.</nobr></div>
<div style="position: absolute; top: 56361px; left: 87px;"><nobr>Note that the host software shall ensure that the content of each CPB within the chain shall be physically </nobr></div>
<div style="position: absolute; top: 56379px; left: 87px;"><nobr>contiguous and locked in host memory and that all chain pointers shall be physical addresses.</nobr></div>
<div style="position: absolute; top: 56401px; left: 75px;"><nobr><b>7.5.8 CPB Look Up Table Address Register (CPBLAR)</b></nobr></div>
<div style="position: absolute; top: 56431px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 56431px; left: 281px;"><nobr>Base + 90h</nobr></div>
<div style="position: absolute; top: 56458px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 56458px; left: 281px;"><nobr>Base + B0h (If the device does not support channel this register shall be read only </nobr></div>
<div style="position: absolute; top: 56475px; left: 87px;"><nobr>and cleared to zero).</nobr></div>
<div style="position: absolute; top: 56501px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 56501px; left: 281px;"><nobr>00000000h</nobr></div>
<div style="position: absolute; top: 56528px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 56528px; left: 281px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 56554px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 56554px; left: 281px;"><nobr>32 bits</nobr></div>
<div style="position: absolute; top: 56579px; left: 87px;"><nobr>The CPB Lookup Address Register contains the 32-bit address of the base of the CPB Lookup Table.  The host </nobr></div>
<div style="position: absolute; top: 56597px; left: 87px;"><nobr>software initializes the contents of this register before entering ADMA Mode.  The ADMA uses this address as a </nobr></div>
<div style="position: absolute; top: 56614px; left: 87px;"><nobr>base to which it adds the offset calculated from the device, and tag resulting from a Service command, the offset </nobr></div>
<div style="position: absolute; top: 56631px; left: 87px;"><nobr>calculation is defined in 7.6.2.  The resulting calculated address points to a location in host memory that, in turn, </nobr></div>
<div style="position: absolute; top: 56649px; left: 87px;"><nobr>points to the CPB associated with the command requiring service.</nobr></div>
<div style="position: absolute; top: 56675px; left: 87px;"><nobr>The CPB Lookup Table Address Register is only used in overlapped or queued operations.  It is initialized by </nobr></div>
<div style="position: absolute; top: 56692px; left: 87px;"><nobr>the host to point to the base of a Lookup Table that it is constructed in host memory.  The CPB Lookup Table </nobr></div>
<div style="position: absolute; top: 56709px; left: 87px;"><nobr>shall be physically contiguous and locked in host memory.  The address contained in this register shall be a </nobr></div>
<div style="position: absolute; top: 56727px; left: 87px;"><nobr>physical address.  This register is used by the ADMA to construct the address of the applicable CPB when a </nobr></div>
<div style="position: absolute; top: 56744px; left: 87px;"><nobr>service interrupt is received.  Each entry in the table is a Qword of which bits 0-31 are significant, bits 32-63 </nobr></div>
<div style="position: absolute; top: 56761px; left: 87px;"><nobr>shall be cleared to zero by the host. Bits 0-31holds the physical address of the CPB.</nobr></div>
<div style="position: absolute; top: 56783px; left: 75px;"><nobr><b>7.5.9 ADMA FIFO Input Threshold Register (FITR) (optional)</b></nobr></div>
<div style="position: absolute; top: 56813px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 56813px; left: 281px;"><nobr>Base + 94h</nobr></div>
<div style="position: absolute; top: 56839px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 56839px; left: 281px;"><nobr>Base + B4h (If the device does not support channel this register shall be read only </nobr></div>
<div style="position: absolute; top: 56857px; left: 87px;"><nobr>and cleared to zero).</nobr></div>
<div style="position: absolute; top: 56883px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 56883px; left: 281px;"><nobr>0000h</nobr></div>
<div style="position: absolute; top: 56909px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 56909px; left: 260px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 56936px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 56936px; left: 281px;"><nobr>16 bits</nobr></div>
<div style="position: absolute; top: 56962px; left: 87px;"><nobr>The ADMA FIFO Input Threshold is initialized by the host to request the desired PCI burst length.  It represents </nobr></div>
<div style="position: absolute; top: 56979px; left: 87px;"><nobr>the number of Qwords in the Input FIFO to the ADMA from the PCI bus before the FIFO Input Threshold (FIT) </nobr></div>
<div style="position: absolute; top: 56997px; left: 87px;"><nobr>Flag sets and a PCI burst is initiated to write the data to host memory.  The value loaded into this register may </nobr></div>
<div style="position: absolute; top: 57014px; left: 87px;"><nobr>be related to the value in the CacheLine Size Register (offset 0Ch) in the PCI configuration Registers.  The </nobr></div>
<div style="position: absolute; top: 57031px; left: 87px;"><nobr>value of FITR shall be greater than zero and less than the FIFO size.</nobr></div>
<div style="position: absolute; top: 57053px; left: 75px;"><nobr><b>7.5.10 ADMA FIFO Output Threshold Register (FOTR) (optional)</b></nobr></div>
<div style="position: absolute; top: 57083px; left: 87px;"><nobr>Address offset, Channel X:</nobr></div>
<div style="position: absolute; top: 57083px; left: 281px;"><nobr>Base + 96h</nobr></div>
<div style="position: absolute; top: 57109px; left: 87px;"><nobr>Address offset, Channel Y:</nobr></div>
<div style="position: absolute; top: 57109px; left: 281px;"><nobr>Base + B6h (If the device does not support channel this register shall be read only </nobr></div>
<div style="position: absolute; top: 57127px; left: 87px;"><nobr>and cleared to zero).</nobr></div>
</span></font>

<div style="position: absolute; top: 57199px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="51"><b>Page 51</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 57253px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 58338px; left: 87px;"><nobr>Page 37</nobr></div>
<div style="position: absolute; top: 57275px; left: 87px;"><nobr>Default value</nobr></div>
<div style="position: absolute; top: 57275px; left: 281px;"><nobr>0000h</nobr></div>
<div style="position: absolute; top: 57302px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 57302px; left: 260px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 57328px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 57328px; left: 281px;"><nobr>16 bits</nobr></div>
<div style="position: absolute; top: 57353px; left: 87px;"><nobr>The ADMA FIFO Output Threshold is initialized by the host to request the desired PCI burst length.  It </nobr></div>
<div style="position: absolute; top: 57371px; left: 87px;"><nobr>represents the space, in Qwords, in the Output FIFO from the ADMA to the PCI bus before the FIFO Output </nobr></div>
<div style="position: absolute; top: 57388px; left: 87px;"><nobr>Threshold (FOT) Flag sets and a PCI burst is initiated to read data from host memory.  The value loaded into </nobr></div>
<div style="position: absolute; top: 57405px; left: 87px;"><nobr>this register may be related to the value in the Cache Line Size Register (offset 0Ch) in the PCI configuration </nobr></div>
<div style="position: absolute; top: 57423px; left: 87px;"><nobr>Registers.  The value of FOTR shall be greater than zero and less than the FIFO size.</nobr></div>
<div style="position: absolute; top: 57445px; left: 75px;"><nobr><b>7.5.11 BIOS Message Pointer</b></nobr></div>
<div style="position: absolute; top: 57475px; left: 87px;"><nobr>Address Offset</nobr></div>
<div style="position: absolute; top: 57475px; left: 216px;"><nobr>D4h</nobr></div>
<div style="position: absolute; top: 57502px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 57502px; left: 216px;"><nobr>00000000h</nobr></div>
<div style="position: absolute; top: 57528px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 57528px; left: 216px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 57554px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 57554px; left: 216px;"><nobr>32 bits </nobr></div>
<div style="position: absolute; top: 57581px; left: 87px;"><nobr>This register may be used by the BIOS to point to its message area.  The ADMA takes no action on this register </nobr></div>
<div style="position: absolute; top: 57598px; left: 87px;"><nobr>other than clearing it to zero on reset.  This allows a BIOS to provide information to the host software.</nobr></div>
<div style="position: absolute; top: 57619px; left: 75px;"><nobr><b>7.5.12 Driver Message Pointer</b></nobr></div>
<div style="position: absolute; top: 57650px; left: 87px;"><nobr>Address Offset</nobr></div>
<div style="position: absolute; top: 57650px; left: 216px;"><nobr>DCh</nobr></div>
<div style="position: absolute; top: 57676px; left: 87px;"><nobr>Default Value</nobr></div>
<div style="position: absolute; top: 57676px; left: 216px;"><nobr>00000000h</nobr></div>
<div style="position: absolute; top: 57702px; left: 87px;"><nobr>Attribute</nobr></div>
<div style="position: absolute; top: 57702px; left: 216px;"><nobr>Read/Write</nobr></div>
<div style="position: absolute; top: 57729px; left: 87px;"><nobr>Size</nobr></div>
<div style="position: absolute; top: 57729px; left: 216px;"><nobr>32 bits </nobr></div>
<div style="position: absolute; top: 57755px; left: 87px;"><nobr>The host software may use this register to point to its message area.  The ADMA takes no action on this register </nobr></div>
<div style="position: absolute; top: 57772px; left: 87px;"><nobr>other than clearing it zero on reset.  This allows host software to provide information to a BIOS.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 57800px; left: 65px;"><nobr><b>7.6 Auto DMA Mode Data Structures</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 57826px; left: 87px;"><nobr>In ADMA Mode the ADMA engine reads a command held in a command chain from host memory.  The </nobr></div>
<div style="position: absolute; top: 57844px; left: 87px;"><nobr>command part of a data structure termed a Command Parameter Block (CPB).  A chain of CPBs is created in </nobr></div>
<div style="position: absolute; top: 57861px; left: 87px;"><nobr>host memory, with each CPB pointing to the next CPB.  The CPB pointer shall be a physical address.  The </nobr></div>
<div style="position: absolute; top: 57878px; left: 87px;"><nobr>ADMA maintains a Dword register that points to the next CPB of the chain.  Within each CPB, there is a pointer </nobr></div>
<div style="position: absolute; top: 57896px; left: 87px;"><nobr>to the chain of ADMA Physical Region Descriptors (APRDs).  The APRD is a structure that defines the memory </nobr></div>
<div style="position: absolute; top: 57913px; left: 87px;"><nobr>locations where the data is to be written to or read from, see 7.6.1.8.  The APRD pointer shall be a physical </nobr></div>
<div style="position: absolute; top: 57929px; left: 87px;"><nobr>address.</nobr></div>
<div style="position: absolute; top: 57952px; left: 75px;"><nobr><b>7.6.1 Command Parameter Block</b></nobr></div>
<div style="position: absolute; top: 57982px; left: 87px;"><nobr>The CPB is a block of parameters and commands for the ADMA and, indirectly, for the ATA Channel.  Each </nobr></div>
<div style="position: absolute; top: 57999px; left: 87px;"><nobr>CPB shall all be physically contiguous, locked in host memory, and possibly Qword-aligned in physical address </nobr></div>
<div style="position: absolute; top: 58017px; left: 87px;"><nobr>space.</nobr></div>
<div style="position: absolute; top: 58043px; left: 87px;"><nobr>NOTE – Some host controllers require Qword alignment of CPB addresses in physical address space.  </nobr></div>
<div style="position: absolute; top: 58060px; left: 87px;"><nobr>However, this requirement is optional in this standard.</nobr></div>
<div style="position: absolute; top: 58087px; left: 87px;"><nobr>CPB data, described in Table 22, is written by the host; only the Response Flags are modified by the ADMA.</nobr></div>
</span></font>

<div style="position: absolute; top: 58387px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="52"><b>Page 52</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 59526px; left: 681px;"><nobr>Page 38</nobr></div>
<div style="position: absolute; top: 58463px; left: 370px;"><nobr><b>Table 22 – CPB Structure</b></nobr></div>
<div style="position: absolute; top: 58494px; left: 91px;"><nobr>Qword Byte Bits</nobr></div>
<div style="position: absolute; top: 58494px; left: 240px;"><nobr>Name Init</nobr></div>
<div style="position: absolute; top: 58494px; left: 546px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 58526px; left: 201px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58526px; left: 234px;"><nobr>cDONE 1</nobr></div>
<div style="position: absolute; top: 58518px; left: 324px;"><nobr>The host shall clear this bit to zero to give the ADMA control of the CPB.  The </nobr></div>
<div style="position: absolute; top: 58535px; left: 324px;"><nobr>ADMA  shall set this bit to one to give the host control of the CPB.  See 7.6.3.</nobr></div>
<div style="position: absolute; top: 58564px; left: 201px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 58564px; left: 241px;"><nobr>cREL</nobr></div>
<div style="position: absolute; top: 58564px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58556px; left: 324px;"><nobr>The ADMA shall set cREL  to one if the device indicates that the command </nobr></div>
<div style="position: absolute; top: 58574px; left: 324px;"><nobr>associated with the CPB is to be released. Section 7.6.3.</nobr></div>
<div style="position: absolute; top: 58602px; left: 201px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 58602px; left: 233px;"><nobr>cIGNRD 0</nobr></div>
<div style="position: absolute; top: 58594px; left: 324px;"><nobr>The ADMA shall set cIGNRD to one if, on the first access of the CPB, cVLD, </nobr></div>
<div style="position: absolute; top: 58612px; left: 324px;"><nobr>cREL and cDONE are cleared to zero.  See 7.6.3.</nobr></div>
<div style="position: absolute; top: 58642px; left: 201px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 58642px; left: 231px;"><nobr>cATERR 0</nobr></div>
<div style="position: absolute; top: 58634px; left: 324px;"><nobr>The ADMA shall set cATERR to one if ATA ERR is set to one during </nobr></div>
<div style="position: absolute; top: 58651px; left: 324px;"><nobr>execution of the command.</nobr></div>
<div style="position: absolute; top: 58680px; left: 201px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 58680px; left: 236px;"><nobr>cSPNT 0</nobr></div>
<div style="position: absolute; top: 58672px; left: 324px;"><nobr>The ADMA shall set cSPNT to one if it detects a spurious interrupt on the </nobr></div>
<div style="position: absolute; top: 58690px; left: 324px;"><nobr>ATA INTRQ signal during execution of a command.</nobr></div>
<div style="position: absolute; top: 58727px; left: 201px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 58727px; left: 231px;"><nobr>cPSDEF 0</nobr></div>
<div style="position: absolute; top: 58710px; left: 324px;"><nobr>The ADMA shall set cPSDEF to one if the APRD data transfer lengths are </nobr></div>
<div style="position: absolute; top: 58728px; left: 324px;"><nobr>insufficient to complete the command.  This means that the DMA engine in </nobr></div>
<div style="position: absolute; top: 58745px; left: 324px;"><nobr>the ADMA may still be running.</nobr></div>
<div style="position: absolute; top: 58792px; left: 201px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 58792px; left: 231px;"><nobr>cPSEXC 0</nobr></div>
<div style="position: absolute; top: 58766px; left: 324px;"><nobr>The ADMA shall set cPSEXC to one if the APRD data transfer length is in </nobr></div>
<div style="position: absolute; top: 58784px; left: 324px;"><nobr>excess of that required to complete the command. .  This means that the </nobr></div>
<div style="position: absolute; top: 58801px; left: 324px;"><nobr>DMA engine in the ADMA may have stopped while the device is still </nobr></div>
<div style="position: absolute; top: 58818px; left: 324px;"><nobr>attempting to transfer data.</nobr></div>
<div style="position: absolute; top: 58735px; left: 131px;"><nobr>Response Flags</nobr></div>
<div style="position: absolute; top: 58685px; left: 162px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58847px; left: 201px;"><nobr>7</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 58841px; left: 232px;"><nobr>cCPBER</nobr></div>
<div style="position: absolute; top: 58856px; left: 254px;"><nobr>R</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 58847px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58840px; left: 324px;"><nobr>The ADMA shall set cCPBERR to one if it determines that the CPB is </nobr></div>
<div style="position: absolute; top: 58858px; left: 324px;"><nobr>inconsistent.</nobr></div>
<div style="position: absolute; top: 58878px; left: 162px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 58878px; left: 195px;"><nobr>7-0</nobr></div>
<div style="position: absolute; top: 58878px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58878px; left: 550px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 58916px; left: 201px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58916px; left: 241px;"><nobr>cVLD</nobr></div>
<div style="position: absolute; top: 58916px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58899px; left: 324px;"><nobr>cVLD is used in combination with cDONE and cREL to control the processing </nobr></div>
<div style="position: absolute; top: 58917px; left: 324px;"><nobr>of the CPB by the ADMA engine.  When cDONE is set to one, the CPB shall </nobr></div>
<div style="position: absolute; top: 58934px; left: 324px;"><nobr>not be processed.  See 7.6.3.</nobr></div>
<div style="position: absolute; top: 58963px; left: 201px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 58963px; left: 240px;"><nobr>cQUE</nobr></div>
<div style="position: absolute; top: 58963px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58955px; left: 324px;"><nobr>cQUE shall be cleared to zero by the host for non-queued or non-overlapped </nobr></div>
<div style="position: absolute; top: 58972px; left: 324px;"><nobr>commands.  cQUE shall be set to one for queued/overlapped commands.</nobr></div>
<div style="position: absolute; top: 59002px; left: 201px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 59002px; left: 241px;"><nobr>cDAT</nobr></div>
<div style="position: absolute; top: 59002px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 58994px; left: 324px;"><nobr>cDAT shall be set to one by the host to indicate that the APRD chain contains </nobr></div>
<div style="position: absolute; top: 59012px; left: 324px;"><nobr>valid information.  The address in cPRD shall be valid.</nobr></div>
<div style="position: absolute; top: 59040px; left: 201px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 59040px; left: 243px;"><nobr>cIEN</nobr></div>
<div style="position: absolute; top: 59040px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 59032px; left: 324px;"><nobr>cIEN is cleared to zero by the host to disable the command complete </nobr></div>
<div style="position: absolute; top: 59050px; left: 324px;"><nobr>interrupt; set to one by the host to allow the Command Complete interrupt.</nobr></div>
<div style="position: absolute; top: 59023px; left: 131px;"><nobr>Control Flags</nobr></div>
<div style="position: absolute; top: 58985px; left: 162px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 59071px; left: 195px;"><nobr>7-4</nobr></div>
<div style="position: absolute; top: 59071px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 59071px; left: 550px;"><nobr>Reserved.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 10px; font-family: Times;">
<div style="position: absolute; top: 59095px; left: 113px;"><nobr>ATA </nobr></div>
<div style="position: absolute; top: 59108px; left: 107px;"><nobr>Length</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 59101px; left: 162px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 59101px; left: 195px;"><nobr>7-0</nobr></div>
<div style="position: absolute; top: 59101px; left: 241px;"><nobr>cLEN</nobr></div>
<div style="position: absolute; top: 59101px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 59093px; left: 324px;"><nobr>The length in Qwords of the ATA Register Field Area of the CPB (the total </nobr></div>
<div style="position: absolute; top: 59110px; left: 324px;"><nobr>CPB length = 2 + cLEN Qwords).</nobr></div>
<div style="position: absolute; top: 58832px; left: 86px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 59139px; left: 155px;"><nobr>4-7 31-0 cNCPB x</nobr></div>
<div style="position: absolute; top: 59131px; left: 324px;"><nobr>Host memory Address of the next CPB.  Shall be Qword aligned in some </nobr></div>
<div style="position: absolute; top: 59149px; left: 324px;"><nobr>implementations.</nobr></div>
<div style="position: absolute; top: 59177px; left: 105px;"><nobr>APRD 0-3 31-0</nobr></div>
<div style="position: absolute; top: 59177px; left: 240px;"><nobr>cPRD</nobr></div>
<div style="position: absolute; top: 59169px; left: 324px;"><nobr>Host memory Address of the first APRD for this CPB.  Shall be Qword aligned </nobr></div>
<div style="position: absolute; top: 59187px; left: 324px;"><nobr>in some implementations.</nobr></div>
<div style="position: absolute; top: 59187px; left: 86px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 59209px; left: 155px;"><nobr>4-7</nobr></div>
<div style="position: absolute; top: 59209px; left: 300px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 59209px; left: 550px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 59230px; left: 109px;"><nobr>CMD 0-1 15-0 ATAR0 0’s</nobr></div>
<div style="position: absolute; top: 59230px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59251px; left: 109px;"><nobr>CMD 2-3 31-16 ATAR1 0’s</nobr></div>
<div style="position: absolute; top: 59251px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59273px; left: 109px;"><nobr>CMD 4-5 47-32 ATAR2 0’s</nobr></div>
<div style="position: absolute; top: 59273px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59261px; left: 86px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 59294px; left: 109px;"><nobr>CMD 6-7 63-48 ATAR3 0’s</nobr></div>
<div style="position: absolute; top: 59294px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59315px; left: 82px;"><nobr>… CMD …</nobr></div>
<div style="position: absolute; top: 59315px; left: 198px;"><nobr>…</nobr></div>
<div style="position: absolute; top: 59315px; left: 252px;"><nobr>…</nobr></div>
<div style="position: absolute; top: 59315px; left: 297px;"><nobr>…</nobr></div>
<div style="position: absolute; top: 59315px; left: 575px;"><nobr>…</nobr></div>
<div style="position: absolute; top: 59337px; left: 109px;"><nobr>CMD 0-1 15-0 ATAR0 0’s</nobr></div>
<div style="position: absolute; top: 59337px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59358px; left: 109px;"><nobr>CMD 2-3 31-16 ATAR1 0’s</nobr></div>
<div style="position: absolute; top: 59358px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59380px; left: 109px;"><nobr>CMD 4-5 47-32 ATAR2 0’s</nobr></div>
<div style="position: absolute; top: 59380px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59368px; left: 86px;"><nobr>n</nobr></div>
<div style="position: absolute; top: 59401px; left: 109px;"><nobr>CMD 6-7 63-48 ATAR3 0’s</nobr></div>
<div style="position: absolute; top: 59401px; left: 476px;"><nobr>ATA Register Field – see 7.6.1.6</nobr></div>
<div style="position: absolute; top: 59445px; left: 87px;"><nobr><b>7.6.1.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 59446px; left: 136px;"><nobr><b>Response Flags (Byte 0)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 59471px; left: 87px;"><nobr>These flags are written by the ADMA during the processing of the CPB.  Bit zero (cDONE) shall be set to one by </nobr></div>
<div style="position: absolute; top: 59489px; left: 87px;"><nobr>the host when preparing the CPB.  The host shall clear the byte to zero to indicate to the ADMA that the CPB is </nobr></div>
</span></font>

<div style="position: absolute; top: 59575px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="53"><b>Page 53</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 59629px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 60714px; left: 87px;"><nobr>Page 39</nobr></div>
<div style="position: absolute; top: 59651px; left: 87px;"><nobr>valid and ready to be processed.  The Response Flags are in a byte by themselves, so that the ADMA does not </nobr></div>
<div style="position: absolute; top: 59669px; left: 87px;"><nobr>have to do a read/modify/write operation.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 59693px; left: 87px;"><nobr><b>7.6.1.1.1 cDONE – ATA Command Complete Flag (Bit 0)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 59724px; left: 87px;"><nobr>This flag shall be set to one by the ADMA hardware when it has completed processing the command in this </nobr></div>
<div style="position: absolute; top: 59741px; left: 87px;"><nobr>CPB entry.  It is used by the ADMA to prevent processing the CPB again on subsequent passes around the </nobr></div>
<div style="position: absolute; top: 59758px; left: 87px;"><nobr>CPB chain.  When set, the host has control of the CPB.</nobr></div>
<div style="position: absolute; top: 59789px; left: 87px;"><nobr>The host sets cDONE to one when initializing a CPB in the CPB chain.  The host first sets cVLD to one and  </nobr></div>
<div style="position: absolute; top: 59806px; left: 87px;"><nobr>then clears cDONE to zero to indicate to the ADMA that the CPB contains valid command information.  </nobr></div>
<div style="position: absolute; top: 59823px; left: 87px;"><nobr>Thereafter, with the exception of cVLD, the host shall not change anything in the CPB until cDONE is set to one </nobr></div>
<div style="position: absolute; top: 59841px; left: 87px;"><nobr>by the ADMA.  The host can then write new command information to the CPB, set cVLD to one and, finally, </nobr></div>
<div style="position: absolute; top: 59858px; left: 87px;"><nobr>clear cDONE to zero.  See 7.6.3.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 59882px; left: 87px;"><nobr><b>7.6.1.1.2 cREL – ATA Release Interrupt Flag (Bit 1)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 59913px; left: 87px;"><nobr>This flag shall be set to one by the ADMA hardware when the ATA REL Bit is set to one by the device after a </nobr></div>
<div style="position: absolute; top: 59930px; left: 87px;"><nobr>queued command has been written to the device.  When the ADMA has set this flag it proceeds to the next </nobr></div>
<div style="position: absolute; top: 59948px; left: 87px;"><nobr>Valid-Waiting CPB, unless the ATA SERV Bit is set to one.  In this latter case, the ADMA then issues a service </nobr></div>
<div style="position: absolute; top: 59965px; left: 87px;"><nobr>command to the device to process a previously queued command.  See 7.6.3.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 59989px; left: 87px;"><nobr><b>7.6.1.1.3 cIGNRD – CPB Ignored (Bit 2)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60020px; left: 87px;"><nobr>If the ADMA hardware reads a CPB with both cDONE and cVLD cleared to zero, it sets both cDONE and </nobr></div>
<div style="position: absolute; top: 60038px; left: 87px;"><nobr>cIGNRD to one, sets aDONE, and asserts the PCI interrupt.  The CPB is ignored and the next CPB in the chain </nobr></div>
<div style="position: absolute; top: 60055px; left: 87px;"><nobr>is processed.  cVLD is assumed to be set to one if the CPB is being accessed due to a Service Interrupt.   See </nobr></div>
<div style="position: absolute; top: 60071px; left: 87px;"><nobr>7.6.3.  The PCI interrupt will not be asserted if the CPB is configured to mask interrupts.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 60097px; left: 87px;"><nobr><b>7.6.1.1.4 cATERR – ATA Command Error Flag (Bit 3)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60127px; left: 87px;"><nobr>This flag shall be set to one by the ADMA hardware if  the ATA ERR (ATAPI CHK) bit set in the ATA Status (or </nobr></div>
<div style="position: absolute; top: 60145px; left: 87px;"><nobr>Alt Status) Register during the command.  When the ADMA sets this bit, it sets aCPBERR, asserts the PCI </nobr></div>
<div style="position: absolute; top: 60161px; left: 87px;"><nobr>Interrupt signal, and transitions to ATA Register Mode.  The host is responsible for error recovery.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 60186px; left: 87px;"><nobr><b>7.6.1.1.5 cSPNT – ATA Spurious Interrupt Error Flag (Bit 4)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60217px; left: 87px;"><nobr>This flag shall be set to one by the ADMA hardware if the ATA INTRQ signal is asserted unexpectedly during </nobr></div>
<div style="position: absolute; top: 60233px; left: 87px;"><nobr>execution of a command.  When the ADMA sets this bit, it sets aCPBERR, asserts the PCI Interrupt signal </nobr></div>
<div style="position: absolute; top: 60251px; left: 87px;"><nobr>regardless of the state of cIEN, and transitions to ATA Register Mode.  The host is responsible for error </nobr></div>
<div style="position: absolute; top: 60268px; left: 87px;"><nobr>recovery.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 60293px; left: 87px;"><nobr><b>7.6.1.1.6 cPSDEF – APRD Deficiency Length Error Flag (Bit 5)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60323px; left: 87px;"><nobr>This flag shall be set to one by the ADMA hardware if the total transfer length in the APRD chain is insufficient to </nobr></div>
<div style="position: absolute; top: 60341px; left: 87px;"><nobr>complete the ATA transfer.  In this situation the ATA device might be hung or data might be lost.  When the </nobr></div>
<div style="position: absolute; top: 60358px; left: 87px;"><nobr>ADMA sets this bit, it sets aCPBERR, asserts the PCI Interrupt signal (irrespective of the state of cIEN), and </nobr></div>
<div style="position: absolute; top: 60375px; left: 87px;"><nobr>transitions to ATA Register Mode.  The host is responsible for error recovery.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 60401px; left: 87px;"><nobr><b>7.6.1.1.7 cPSEXC – APRD Excess Length Error Flag (Bit 6)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60430px; left: 87px;"><nobr>This flag shall be set to one by the ADMA hardware if the transfer is complete before the APRD length expires.  </nobr></div>
<div style="position: absolute; top: 60448px; left: 87px;"><nobr>In this case, the device will have completed the command, with or without errors.  When the ADMA sets this bit, </nobr></div>
<div style="position: absolute; top: 60465px; left: 87px;"><nobr>it sets aCPBERR, may assert the PCI Interrupt signal, and may transition to ATA Register Mode depending on </nobr></div>
<div style="position: absolute; top: 60482px; left: 87px;"><nobr>the state of pIGEX (see 7.6.1.7).  The host is responsible for error recovery.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 60508px; left: 87px;"><nobr><b>7.6.1.1.8 cCPBERR – ATA Command Error Flag (Bit 7)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60538px; left: 87px;"><nobr>This flag shall be set to one by the ADMA hardware if it detects an inconsistency in the CPB.  When the ADMA </nobr></div>
<div style="position: absolute; top: 60555px; left: 87px;"><nobr>sets this bit, it sets aCPBERR, asserts the PCI Interrupt signal (irrespective of the state of cIEN), and transitions </nobr></div>
<div style="position: absolute; top: 60572px; left: 87px;"><nobr>to ATA Register Mode.  The host is responsible for error recovery.</nobr></div>
<div style="position: absolute; top: 60599px; left: 87px;"><nobr><b>7.6.1.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 60600px; left: 136px;"><nobr><b>Control Flags (Byte 2)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60625px; left: 87px;"><nobr>These flags control the detailed operation of the ADMA sequencer.  They remove the need for the ADMA to </nobr></div>
<div style="position: absolute; top: 60642px; left: 87px;"><nobr>recognize the ATA command set.  Thus, if new commands are defined, the ADMA can still function.</nobr></div>
</span></font>

<div style="position: absolute; top: 60763px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="54"><b>Page 54</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61902px; left: 681px;"><nobr>Page 40</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 60837px; left: 87px;"><nobr><b>7.6.1.2.1 cVLD – CPB Valid (Bit 0)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 60868px; left: 87px;"><nobr>The host shall set cVLD to one to indicate that the CPB will be processed when cDONE is cleared to zero.  The </nobr></div>
<div style="position: absolute; top: 60885px; left: 87px;"><nobr>host shall not set cDONE to one (unless it is initializing the CPB chain).  If the host determines that a CPB need </nobr></div>
<div style="position: absolute; top: 60903px; left: 87px;"><nobr>no longer be processed, it may clear cVLD to zero.  Note that this does not necessarily guarantee that the CPB </nobr></div>
<div style="position: absolute; top: 60920px; left: 87px;"><nobr>will be ignored.  If the CPB is accessed by the ADMA after this bit is set, the ADMA ignores the CPB and </nobr></div>
<div style="position: absolute; top: 60937px; left: 87px;"><nobr>indicates such by setting cIGNRD to one.  If the CPB is in the Released State, the ADMA ignores cVLD when </nobr></div>
<div style="position: absolute; top: 60955px; left: 87px;"><nobr>accessing the CPB in response to an ATA service request interrupt.  To check that a command was “ignored” </nobr></div>
<div style="position: absolute; top: 60971px; left: 87px;"><nobr>after cVLD has been cleared, the host shall check the state of cIGNRD after cDONE has been set to one by the </nobr></div>
<div style="position: absolute; top: 60988px; left: 87px;"><nobr>ADMA.  See 7.6.3 for more information.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 61014px; left: 87px;"><nobr><b>7.6.1.2.2 cQUE – Overlap/Queue Flag (Bit 1)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61043px; left: 87px;"><nobr>This flag shall be set to one to indicate that the command set contains an overlapped/queued command.  This </nobr></div>
<div style="position: absolute; top: 61061px; left: 87px;"><nobr>flag cleared to zero indicates that there is no overlapped/queued command.  If this flag is set, the ADMA </nobr></div>
<div style="position: absolute; top: 61078px; left: 87px;"><nobr>inspects the ATA SERV Bit and the ATA REL Bit on the assertion of the ATA INTRQ signal.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 61103px; left: 87px;"><nobr><b>7.6.1.2.3 cDAT – APRD Valid Flag (Bit 2)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61133px; left: 87px;"><nobr>The host shall set this flag to one to indicate that cPRD is valid.  The APRD chain may contain Directed Interrupt </nobr></div>
<div style="position: absolute; top: 61151px; left: 87px;"><nobr>Information, ATAPI Packet data pointers, data transfer pointers, or any combination of these.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 61176px; left: 87px;"><nobr><b>7.6.1.2.4 cIEN – PCI Interrupt Enable Flag (Bit 3)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61207px; left: 87px;"><nobr>The host shall clear this flag to zero to prevent the ADMA from generating the PCI Interrupt signal when the </nobr></div>
<div style="position: absolute; top: 61223px; left: 87px;"><nobr>command is complete.  The host shall set this flag to one to allow the PCI Interrupt signal.  Clearing this flag will </nobr></div>
<div style="position: absolute; top: 61240px; left: 87px;"><nobr>not prevent the PCI Interrupt signal from being asserted in the event of an error.</nobr></div>
<div style="position: absolute; top: 61267px; left: 87px;"><nobr><b>7.6.1.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 61268px; left: 136px;"><nobr><b>cLEN – ATA Length (Byte 3)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61293px; left: 87px;"><nobr>This Byte contains the number of Qwords that follow the second Qword of the CPB.  This enables the ADMA to </nobr></div>
<div style="position: absolute; top: 61310px; left: 87px;"><nobr>correctly request the number of Qwords to fetch for any particular CPB.</nobr></div>
<div style="position: absolute; top: 61336px; left: 87px;"><nobr><b>7.6.1.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 61337px; left: 136px;"><nobr><b>cNCPB - Next CPB Address (Dword 1)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61362px; left: 87px;"><nobr>During initialization the host shall construct in memory a chain of CPBs, each of which is Qword-aligned in </nobr></div>
<div style="position: absolute; top: 61380px; left: 87px;"><nobr>physical address space.  Qword alignment is optional in some implementations.  Each CPB shall have in this </nobr></div>
<div style="position: absolute; top: 61397px; left: 87px;"><nobr>field the physical address of the next CPB.  The host shall write the address of the first CPB into the ADMA Next </nobr></div>
<div style="position: absolute; top: 61414px; left: 87px;"><nobr>CPB Address Register before setting the aGO Bit in ADMCTL.</nobr></div>
<div style="position: absolute; top: 61445px; left: 87px;"><nobr>If the host needs to change the chain pointers while the ADMA is running, it shall first pause the ADMA by </nobr></div>
<div style="position: absolute; top: 61462px; left: 87px;"><nobr>setting the aPSE Bit in ADMCTL, and checking that the aPSD Bit in ADMSTAT has been set.  This prevents the </nobr></div>
<div style="position: absolute; top: 61479px; left: 87px;"><nobr>ADMA from using any a pointer that might be invalid.</nobr></div>
<div style="position: absolute; top: 61506px; left: 87px;"><nobr><b>7.6.1.5</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 61507px; left: 136px;"><nobr><b>cPRD – APRD Address (Dword 2)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61532px; left: 87px;"><nobr>The host at initialization shall construct a APRD chain, as required, so that each CPB has a corresponding </nobr></div>
<div style="position: absolute; top: 61549px; left: 87px;"><nobr>APRD chain with its physical starting address in this field.</nobr></div>
<div style="position: absolute; top: 61576px; left: 87px;"><nobr><b>7.6.1.6</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 61577px; left: 136px;"><nobr><b>ATARn ATA Register Field</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 61601px; left: 87px;"><nobr>The ATA Register Field is a list of Qwords describing the ATA register writes involved in setting up an ATA </nobr></div>
<div style="position: absolute; top: 61618px; left: 87px;"><nobr>command.  Each Qword consists of four 16-bit entries.  Each entry defines an ATA register write.  There may be </nobr></div>
<div style="position: absolute; top: 61635px; left: 87px;"><nobr>as many of these Qwords included in a CPB as required (see Table 23.)</nobr></div>
</span></font>

<div style="position: absolute; top: 61951px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="55"><b>Page 55</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 62005px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 63090px; left: 87px;"><nobr>Page 41</nobr></div>
<div style="position: absolute; top: 62027px; left: 353px;"><nobr><b>Table 23 – ATA Register Field</b></nobr></div>
<div style="position: absolute; top: 62062px; left: 134px;"><nobr>Control</nobr></div>
<div style="position: absolute; top: 62062px; left: 315px;"><nobr>Address</nobr></div>
<div style="position: absolute; top: 62062px; left: 629px;"><nobr>Data</nobr></div>
<div style="position: absolute; top: 62091px; left: 101px;"><nobr>15</nobr></div>
<div style="position: absolute; top: 62091px; left: 149px;"><nobr>14</nobr></div>
<div style="position: absolute; top: 62091px; left: 196px;"><nobr>13</nobr></div>
<div style="position: absolute; top: 62091px; left: 242px;"><nobr>12</nobr></div>
<div style="position: absolute; top: 62091px; left: 288px;"><nobr>11</nobr></div>
<div style="position: absolute; top: 62091px; left: 334px;"><nobr>10</nobr></div>
<div style="position: absolute; top: 62091px; left: 384px;"><nobr>9</nobr></div>
<div style="position: absolute; top: 62091px; left: 431px;"><nobr>8</nobr></div>
<div style="position: absolute; top: 62091px; left: 477px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 62091px; left: 523px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 62091px; left: 570px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 62091px; left: 617px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 62091px; left: 664px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 62091px; left: 710px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 62091px; left: 756px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 62091px; left: 803px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 62118px; left: 106px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 62118px; left: 138px;"><nobr>WNB</nobr></div>
<div style="position: absolute; top: 62118px; left: 191px;"><nobr>IGN CS1- CS0- DA2 DA1</nobr></div>
<div style="position: absolute; top: 62118px; left: 421px;"><nobr>DA0 DD7 DD6</nobr></div>
<div style="position: absolute; top: 62118px; left: 560px;"><nobr>DD5 DD4</nobr></div>
<div style="position: absolute; top: 62118px; left: 654px;"><nobr>DD3 DD2 DD1</nobr></div>
<div style="position: absolute; top: 62118px; left: 793px;"><nobr>DD0</nobr></div>
<div style="position: absolute; top: 62148px; left: 101px;"><nobr>31</nobr></div>
<div style="position: absolute; top: 62148px; left: 149px;"><nobr>30</nobr></div>
<div style="position: absolute; top: 62148px; left: 196px;"><nobr>29</nobr></div>
<div style="position: absolute; top: 62148px; left: 242px;"><nobr>28</nobr></div>
<div style="position: absolute; top: 62148px; left: 288px;"><nobr>27</nobr></div>
<div style="position: absolute; top: 62148px; left: 334px;"><nobr>26</nobr></div>
<div style="position: absolute; top: 62148px; left: 380px;"><nobr>25</nobr></div>
<div style="position: absolute; top: 62148px; left: 426px;"><nobr>24</nobr></div>
<div style="position: absolute; top: 62148px; left: 473px;"><nobr>23</nobr></div>
<div style="position: absolute; top: 62148px; left: 520px;"><nobr>22</nobr></div>
<div style="position: absolute; top: 62148px; left: 567px;"><nobr>21</nobr></div>
<div style="position: absolute; top: 62148px; left: 613px;"><nobr>20</nobr></div>
<div style="position: absolute; top: 62148px; left: 660px;"><nobr>19</nobr></div>
<div style="position: absolute; top: 62148px; left: 707px;"><nobr>18</nobr></div>
<div style="position: absolute; top: 62148px; left: 753px;"><nobr>17</nobr></div>
<div style="position: absolute; top: 62148px; left: 799px;"><nobr>16</nobr></div>
<div style="position: absolute; top: 62175px; left: 106px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 62175px; left: 138px;"><nobr>WNB</nobr></div>
<div style="position: absolute; top: 62175px; left: 191px;"><nobr>IGN CS1- CS0- DA2 DA1</nobr></div>
<div style="position: absolute; top: 62175px; left: 421px;"><nobr>DA0 DD7 DD6</nobr></div>
<div style="position: absolute; top: 62175px; left: 560px;"><nobr>DD5 DD4</nobr></div>
<div style="position: absolute; top: 62175px; left: 654px;"><nobr>DD3 DD2 DD1</nobr></div>
<div style="position: absolute; top: 62175px; left: 793px;"><nobr>DD0</nobr></div>
<div style="position: absolute; top: 62204px; left: 101px;"><nobr>47</nobr></div>
<div style="position: absolute; top: 62204px; left: 149px;"><nobr>46</nobr></div>
<div style="position: absolute; top: 62204px; left: 196px;"><nobr>45</nobr></div>
<div style="position: absolute; top: 62204px; left: 242px;"><nobr>44</nobr></div>
<div style="position: absolute; top: 62204px; left: 288px;"><nobr>43</nobr></div>
<div style="position: absolute; top: 62204px; left: 334px;"><nobr>42</nobr></div>
<div style="position: absolute; top: 62204px; left: 380px;"><nobr>41</nobr></div>
<div style="position: absolute; top: 62204px; left: 426px;"><nobr>40</nobr></div>
<div style="position: absolute; top: 62204px; left: 473px;"><nobr>39</nobr></div>
<div style="position: absolute; top: 62204px; left: 520px;"><nobr>38</nobr></div>
<div style="position: absolute; top: 62204px; left: 567px;"><nobr>37</nobr></div>
<div style="position: absolute; top: 62204px; left: 613px;"><nobr>36</nobr></div>
<div style="position: absolute; top: 62204px; left: 660px;"><nobr>35</nobr></div>
<div style="position: absolute; top: 62204px; left: 707px;"><nobr>34</nobr></div>
<div style="position: absolute; top: 62204px; left: 753px;"><nobr>33</nobr></div>
<div style="position: absolute; top: 62204px; left: 799px;"><nobr>32</nobr></div>
<div style="position: absolute; top: 62233px; left: 106px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 62233px; left: 138px;"><nobr>WNB</nobr></div>
<div style="position: absolute; top: 62233px; left: 191px;"><nobr>IGN CS1- CS0- DA2 DA1</nobr></div>
<div style="position: absolute; top: 62233px; left: 421px;"><nobr>DA0 DD7 DD6</nobr></div>
<div style="position: absolute; top: 62233px; left: 560px;"><nobr>DD5 DD4</nobr></div>
<div style="position: absolute; top: 62233px; left: 654px;"><nobr>DD3 DD2 DD1</nobr></div>
<div style="position: absolute; top: 62233px; left: 793px;"><nobr>DD0</nobr></div>
<div style="position: absolute; top: 62262px; left: 101px;"><nobr>63</nobr></div>
<div style="position: absolute; top: 62262px; left: 149px;"><nobr>62</nobr></div>
<div style="position: absolute; top: 62262px; left: 196px;"><nobr>61</nobr></div>
<div style="position: absolute; top: 62262px; left: 242px;"><nobr>60</nobr></div>
<div style="position: absolute; top: 62262px; left: 288px;"><nobr>59</nobr></div>
<div style="position: absolute; top: 62262px; left: 334px;"><nobr>58</nobr></div>
<div style="position: absolute; top: 62262px; left: 380px;"><nobr>57</nobr></div>
<div style="position: absolute; top: 62262px; left: 426px;"><nobr>56</nobr></div>
<div style="position: absolute; top: 62262px; left: 473px;"><nobr>55</nobr></div>
<div style="position: absolute; top: 62262px; left: 520px;"><nobr>54</nobr></div>
<div style="position: absolute; top: 62262px; left: 567px;"><nobr>53</nobr></div>
<div style="position: absolute; top: 62262px; left: 613px;"><nobr>52</nobr></div>
<div style="position: absolute; top: 62262px; left: 660px;"><nobr>51</nobr></div>
<div style="position: absolute; top: 62262px; left: 707px;"><nobr>50</nobr></div>
<div style="position: absolute; top: 62262px; left: 753px;"><nobr>49</nobr></div>
<div style="position: absolute; top: 62262px; left: 799px;"><nobr>48</nobr></div>
<div style="position: absolute; top: 62289px; left: 95px;"><nobr>END WNB</nobr></div>
<div style="position: absolute; top: 62289px; left: 191px;"><nobr>IGN CS1- CS0- DA2 DA1</nobr></div>
<div style="position: absolute; top: 62289px; left: 421px;"><nobr>DA0 DD7 DD6</nobr></div>
<div style="position: absolute; top: 62289px; left: 560px;"><nobr>DD5 DD4</nobr></div>
<div style="position: absolute; top: 62289px; left: 654px;"><nobr>DD3 DD2 DD1</nobr></div>
<div style="position: absolute; top: 62289px; left: 793px;"><nobr>DD0</nobr></div>
<div style="position: absolute; top: 62324px; left: 87px;"><nobr>Each 16-bit entry consists of eight bits that define the register content to be written, five bits that define the </nobr></div>
<div style="position: absolute; top: 62341px; left: 87px;"><nobr>address of the register to be written, with three bits being used for control purposes.</nobr></div>
<div style="position: absolute; top: 62371px; left: 87px;"><nobr>The three control bits are Ignore (IGN), Wait-Not-Busy (WNB), and End (END).  IGN is used to indicate to the </nobr></div>
<div style="position: absolute; top: 62389px; left: 87px;"><nobr>ADMA that this entry is to be ignored, and to skip to the next entry.  WNB is used to indicate to the ADMA that it </nobr></div>
<div style="position: absolute; top: 62406px; left: 87px;"><nobr>shall wait for the device to become not busy before writing the data.  The END Bit (bit 63 of the last Qword) </nobr></div>
<div style="position: absolute; top: 62423px; left: 87px;"><nobr>indicates that the current entry is the last one to be processed, and shall be the last entry of a set.  The ADMA </nobr></div>
<div style="position: absolute; top: 62441px; left: 87px;"><nobr>reads the ATA register field entries.  When the ADMA detects the END Bit set, it stops reading.</nobr></div>
<div style="position: absolute; top: 62471px; left: 87px;"><nobr>The data (DD0-DD7) and address (DA0-DA2) bits are active high (Asserted = 1).  Bits CS0- and CS1- are active </nobr></div>
<div style="position: absolute; top: 62488px; left: 87px;"><nobr>low (Asserted = 0).</nobr></div>
<div style="position: absolute; top: 62519px; left: 87px;"><nobr>Each CPB shall contain a maximum of 1 ATA command.</nobr></div>
<div style="position: absolute; top: 62550px; left: 87px;"><nobr>If END is set to one, the host shall not set IGN to one.</nobr></div>
<div style="position: absolute; top: 62576px; left: 87px;"><nobr><b>7.6.1.7</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 62577px; left: 136px;"><nobr><b>APRD Chain</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 62602px; left: 87px;"><nobr>Each APRD Chain may contain a variable number of entries (APRDs).  The APRD entry shall be physically </nobr></div>
<div style="position: absolute; top: 62620px; left: 87px;"><nobr>continuous, locked in host memory, and Qword-aligned in physical address space.  Qword alignment is optional </nobr></div>
<div style="position: absolute; top: 62636px; left: 87px;"><nobr>in some implementations.  The information in the APRD entry is derived by the host, and describes the physical </nobr></div>
<div style="position: absolute; top: 62653px; left: 87px;"><nobr>addresses corresponding to the logical buffer address in the original I/O request.  There can be several APRDs </nobr></div>
<div style="position: absolute; top: 62671px; left: 87px;"><nobr>to describe a transfer buffer because some processors fragment physical memory by the use of paging </nobr></div>
<div style="position: absolute; top: 62688px; left: 87px;"><nobr>registers.</nobr></div>
<div style="position: absolute; top: 62719px; left: 87px;"><nobr>In the case of an ATAPI Packet Command, the first APRD is used to describe the packet itself.</nobr></div>
<div style="position: absolute; top: 62750px; left: 87px;"><nobr>In the case of Directed Interrupts, the APRD contains the target Memory or I/O address and the Data to be </nobr></div>
<div style="position: absolute; top: 62767px; left: 87px;"><nobr>written to the address.</nobr></div>
<div style="position: absolute; top: 62793px; left: 87px;"><nobr><b>7.6.1.8</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 62794px; left: 136px;"><nobr><b>ADMA Physical Region Descriptor</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 62819px; left: 87px;"><nobr>Each APRD, described in Table 24, is two Qwords in size and points to a region of host memory or an I/O </nobr></div>
<div style="position: absolute; top: 62837px; left: 87px;"><nobr>address.  The ADMA engine reads each APRD in turn, and transfers data to or from the APRD associated </nobr></div>
<div style="position: absolute; top: 62854px; left: 87px;"><nobr>memory block or I/O address, until the ATA device interrupts to indicate the end of the transfer.</nobr></div>
</span></font>

<div style="position: absolute; top: 63139px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="56"><b>Page 56</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 64278px; left: 681px;"><nobr>Page 42</nobr></div>
<div style="position: absolute; top: 63215px; left: 347px;"><nobr><b>Table 24 – APRD Data Structure</b></nobr></div>
<div style="position: absolute; top: 63250px; left: 71px;"><nobr>Qword Byte Bits Name</nobr></div>
<div style="position: absolute; top: 63250px; left: 521px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 63296px; left: 129px;"><nobr>3-0 31-0 pMAD</nobr></div>
<div style="position: absolute; top: 63279px; left: 261px;"><nobr>Physical address of the start of a physically contiguous host memory region.  Shall be </nobr></div>
<div style="position: absolute; top: 63296px; left: 261px;"><nobr>Qword-aligned in some implementations.  If an I/O transfer, the I/O address of the source </nobr></div>
<div style="position: absolute; top: 63314px; left: 261px;"><nobr>or destination of the data.</nobr></div>
<div style="position: absolute; top: 63334px; left: 88px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 63367px; left: 129px;"><nobr>7-4 31-0 pLEN</nobr></div>
<div style="position: absolute; top: 63341px; left: 261px;"><nobr>If pPKT is cleared to zero, pLEN indicates the length, in Qwords, of the transfer segment.  </nobr></div>
<div style="position: absolute; top: 63358px; left: 261px;"><nobr>If pPKT is set to one and pDINT is cleared to zero, pLEN indicates the length, in words, </nobr></div>
<div style="position: absolute; top: 63376px; left: 261px;"><nobr>of the total data transfer of all the subsequent APRDs (see pPKT).  If pPKT is set to one </nobr></div>
<div style="position: absolute; top: 63392px; left: 261px;"><nobr>and pDINT is set to one, pLEN contains a 32-bit message (see pDINT).</nobr></div>
<div style="position: absolute; top: 63419px; left: 177px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 63419px; left: 261px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 63473px; left: 177px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 63473px; left: 207px;"><nobr>pIGEX</nobr></div>
<div style="position: absolute; top: 63448px; left: 261px;"><nobr>Ignore Data Excess.  Set to one to indicate to the ADMA that data excess occurring in </nobr></div>
<div style="position: absolute; top: 63464px; left: 261px;"><nobr>this APRD is not an error.  This is primarily used when reading the results from certain </nobr></div>
<div style="position: absolute; top: 63481px; left: 261px;"><nobr>ATAPI packet commands that return unknown or odd lengths of data.  cPSEXC will be </nobr></div>
<div style="position: absolute; top: 63499px; left: 261px;"><nobr>set but no error interrupt will be generated and the ADMA continues execution.</nobr></div>
<div style="position: absolute; top: 63543px; left: 177px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 63543px; left: 209px;"><nobr>pPKT</nobr></div>
<div style="position: absolute; top: 63526px; left: 261px;"><nobr>Set to one to indicate that pMAD is a pointer to a Packet (pPKLW indicates the length of </nobr></div>
<div style="position: absolute; top: 63543px; left: 261px;"><nobr>the packet).  pLEN indicates the total length of the transfer found in subsequent APRDs.  </nobr></div>
<div style="position: absolute; top: 63561px; left: 261px;"><nobr>pDINT shall be cleared to zero when pPKT is set to one.</nobr></div>
<div style="position: absolute; top: 63623px; left: 177px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 63623px; left: 208px;"><nobr>pDINT</nobr></div>
<div style="position: absolute; top: 63588px; left: 261px;"><nobr>Set to one to indicate that a Directed Interrupt (DINT) is to be performed, if a non-error </nobr></div>
<div style="position: absolute; top: 63605px; left: 261px;"><nobr>interrupt event occurs.  pMAD is the host memory or I/O address into which to write a 32-</nobr></div>
<div style="position: absolute; top: 63623px; left: 261px;"><nobr>bit message contained within pLEN.  Note that the PCI interrupt signal is controlled by </nobr></div>
<div style="position: absolute; top: 63640px; left: 261px;"><nobr>cIEN only (both Directed Interrupts and the PCI interrupt signal may be enabled, </nobr></div>
<div style="position: absolute; top: 63657px; left: 261px;"><nobr>depending on the respective states of pDINT and cIEN).</nobr></div>
<div style="position: absolute; top: 63685px; left: 177px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 63685px; left: 208px;"><nobr>pORD Data Transfer method.  Set to one for Ultra DMA, cleared to zero for DMA- assisted PIO.</nobr></div>
<div style="position: absolute; top: 63721px; left: 177px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 63721px; left: 206px;"><nobr>pDIRO</nobr></div>
<div style="position: absolute; top: 63712px; left: 261px;"><nobr>Data Transfer Direction.  Shall be set to one for output from the ADMA to the ATA </nobr></div>
<div style="position: absolute; top: 63729px; left: 261px;"><nobr>device, cleared to zero for input from the ATA device to the ADMA.</nobr></div>
<div style="position: absolute; top: 63757px; left: 177px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 63757px; left: 210px;"><nobr>pIOM Set to one for I/O transfers, cleared to zero for memory transfer.</nobr></div>
<div style="position: absolute; top: 63587px; left: 136px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 63784px; left: 177px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 63784px; left: 208px;"><nobr>pEND In the last APRD of a APRD chain, pEND shall be set to one and pNXT cleared to zero.</nobr></div>
<div style="position: absolute; top: 63837px; left: 170px;"><nobr>3-0 pTMOD</nobr></div>
<div style="position: absolute; top: 63811px; left: 261px;"><nobr>PIO mode or Ultra DMA mode to use, depending on pORD.  PIO mode zero is not </nobr></div>
<div style="position: absolute; top: 63828px; left: 261px;"><nobr>supported, and PIO modes are decremented by one, meaning PIO mode one is </nobr></div>
<div style="position: absolute; top: 63846px; left: 261px;"><nobr>indicated by a zero in this field, PIO mode 2 by a 1, etc.  The Ultra DMA modes (0-5) are </nobr></div>
<div style="position: absolute; top: 63863px; left: 261px;"><nobr>fully supported (mode 0 = 0…mode 5 = 5).</nobr></div>
<div style="position: absolute; top: 63907px; left: 170px;"><nobr>6-4 pCRC</nobr></div>
<div style="position: absolute; top: 63890px; left: 261px;"><nobr>If pORD is set to one, this field shall define the burst size that the ADMA will use before </nobr></div>
<div style="position: absolute; top: 63908px; left: 261px;"><nobr>terminating and sending a CRC.  A value of 000b indicates that all data for this command </nobr></div>
<div style="position: absolute; top: 63925px; left: 261px;"><nobr>has been transferred.  Values 001b to 111b indicate the burst size in 512-Byte units.</nobr></div>
<div style="position: absolute; top: 63867px; left: 136px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 63952px; left: 177px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 63952px; left: 261px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 63980px; left: 136px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 63980px; left: 170px;"><nobr>7-0 pPKLW Packet length in words if pPKT is set to one.</nobr></div>
<div style="position: absolute; top: 64007px; left: 136px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 64007px; left: 170px;"><nobr>7-0</nobr></div>
<div style="position: absolute; top: 64007px; left: 261px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 63734px; left: 88px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 64043px; left: 129px;"><nobr>7-4 31-0 pNXT</nobr></div>
<div style="position: absolute; top: 64034px; left: 261px;"><nobr>Physical address of the next APRD.  In the last APRD of a APRD chain, pNXT is cleared </nobr></div>
<div style="position: absolute; top: 64052px; left: 261px;"><nobr>to zero.</nobr></div>
<div style="position: absolute; top: 64085px; left: 87px;"><nobr>If the ATA device attempts to transfer more data than is specified by the APRD chain, the ADMA sets cPSDEF </nobr></div>
<div style="position: absolute; top: 64102px; left: 87px;"><nobr>and cCPBERR to one, transitions to ATA Register Mode, and asserts the PCI interrupt signal. The ADMA </nobr></div>
<div style="position: absolute; top: 64120px; left: 87px;"><nobr>engine shall ensure that the device completes the command.</nobr></div>
<div style="position: absolute; top: 64151px; left: 87px;"><nobr>If the ATA device attempts to transfer less data than is specified by the APRD chain, when pIGEX is cleared to </nobr></div>
<div style="position: absolute; top: 64168px; left: 87px;"><nobr>zero the ADMA sets cPSEXC and cCPBERR to one, transitions to ATA Register Mode, and asserts the PCI </nobr></div>
<div style="position: absolute; top: 64186px; left: 87px;"><nobr>Interrupt signal.</nobr></div>
<div style="position: absolute; top: 64216px; left: 87px;"><nobr>If the device has completed the command and the last APRD space is not exhausted and pIGEX is set to one, </nobr></div>
<div style="position: absolute; top: 64233px; left: 87px;"><nobr>the ADMA transitions to ATA Register Mode after first setting cPSEXC and aCPBERR to one, and then asserts </nobr></div>
<div style="position: absolute; top: 64251px; left: 87px;"><nobr>the PCI Interrupt signal.</nobr></div>
</span></font>

<div style="position: absolute; top: 64327px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="57"><b>Page 57</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 64381px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 65466px; left: 87px;"><nobr>Page 43</nobr></div>
<div style="position: absolute; top: 64403px; left: 75px;"><nobr><b>7.6.2 CPB LookUp Table</b></nobr></div>
<div style="position: absolute; top: 64434px; left: 87px;"><nobr>If an overlapped or queued operation is required, the host shall construct a CPB Lookup Table (see Figure 2) </nobr></div>
<div style="position: absolute; top: 64451px; left: 87px;"><nobr>and writes the base address of the CPB Lookup table in CPBLAR prior to starting the ADMA.  The table shall be </nobr></div>
<div style="position: absolute; top: 64468px; left: 87px;"><nobr>physically contiguous, locked in host memory and Qword-aligned in physical address space.  Qword alignment </nobr></div>
<div style="position: absolute; top: 64486px; left: 87px;"><nobr>is only required in some implementations.  Each entry shall be a Qword with the low-order Dword containing the </nobr></div>
<div style="position: absolute; top: 64503px; left: 87px;"><nobr>physical address of the CPB, and the high-order Dword cleared to zero.  Note that, if the host modifies the CPB </nobr></div>
<div style="position: absolute; top: 64520px; left: 87px;"><nobr>chain while the ADMA is in the Paused State (see 7.7), this table shall be updated before restarting the ADMA.</nobr></div>
<div style="position: absolute; top: 64551px; left: 87px;"><nobr>The CPB Lookup Table is used to fetch the original CPB in order to access the APRD chain that controls the </nobr></div>
<div style="position: absolute; top: 64568px; left: 87px;"><nobr>transfer of the data.  In this case, when an ATA interrupt is received with the ATA SERV Bit set, the ADMA </nobr></div>
<div style="position: absolute; top: 64585px; left: 87px;"><nobr>retrieves the ATA TAG field from the device and uses it to construct an address within this table.  The address </nobr></div>
<div style="position: absolute; top: 64603px; left: 87px;"><nobr>calculation is:</nobr></div>
<div style="position: absolute; top: 64634px; left: 289px;"><nobr>Contents of CPBLAR + (DEV <font face="Symbol">? </font>100h) + (TAG <font face="Symbol">? </font>08h)</nobr></div>
<div style="position: absolute; top: 64665px; left: 87px;"><nobr>Where DEV is the ATA DEV Bit, and TAG is the ATA TAG.</nobr></div>
<div style="position: absolute; top: 64692px; left: 75px;"><nobr><b>7.6.3 CPB States</b></nobr></div>
<div style="position: absolute; top: 64722px; left: 87px;"><nobr>The CPB can be in one of four States: Not-Valid, Valid-Waiting, Valid-Processing, or Released (see Figure 4).  </nobr></div>
<div style="position: absolute; top: 64739px; left: 87px;"><nobr>These States are controlled by three bits in the CPB structure:  cDONE, cREL, and cVLD.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 10px; font-family: Times;">
<div style="position: absolute; top: 64985px; left: 335px;"><nobr>C1:C0</nobr></div>
<div style="position: absolute; top: 64965px; left: 249px;"><nobr>ADMA reads cVLD = 0</nobr></div>
<div style="position: absolute; top: 65066px; left: 539px;"><nobr>C2:C0</nobr></div>
<div style="position: absolute; top: 65046px; left: 467px;"><nobr>Command Complete</nobr></div>
<div style="position: absolute; top: 64945px; left: 605px;"><nobr>C2:C3</nobr></div>
<div style="position: absolute; top: 64910px; left: 609px;"><nobr>Overlapped/Queued</nobr></div>
<div style="position: absolute; top: 64925px; left: 608px;"><nobr>Command Released</nobr></div>
<div style="position: absolute; top: 65133px; left: 741px;"><nobr>C3:C0</nobr></div>
<div style="position: absolute; top: 65005px; left: 305px;"><nobr><i>cIGNRD = 1</i></nobr></div>
<div style="position: absolute; top: 65019px; left: 305px;"><nobr><i>cDONE =  1</i></nobr></div>
<div style="position: absolute; top: 65087px; left: 512px;"><nobr><i>cDONE = 1</i></nobr></div>
<div style="position: absolute; top: 64931px; left: 198px;"><nobr>C0:C1</nobr></div>
<div style="position: absolute; top: 64911px; left: 199px;"><nobr>cDONE = 0</nobr></div>
<div style="position: absolute; top: 64962px; left: 603px;"><nobr><i>cREL = 1</i></nobr></div>
<div style="position: absolute; top: 65114px; left: 669px;"><nobr>Command Complete</nobr></div>
<div style="position: absolute; top: 65154px; left: 714px;"><nobr><i>cDONE = 1</i></nobr></div>
<div style="position: absolute; top: 64931px; left: 403px;"><nobr>C1:C2</nobr></div>
<div style="position: absolute; top: 64911px; left: 399px;"><nobr>ADMA reads cVLD = 1</nobr></div>
<div style="position: absolute; top: 64930px; left: 138px;"><nobr>:C0</nobr></div>
<div style="position: absolute; top: 64911px; left: 104px;"><nobr>Initialization</nobr></div>
<div style="position: absolute; top: 64810px; left: 752px;"><nobr><b>C3 : Released</b></nobr></div>
<div style="position: absolute; top: 64825px; left: 761px;"><nobr>cDONE = 0</nobr></div>
<div style="position: absolute; top: 64839px; left: 766px;"><nobr>cREL = 1</nobr></div>
<div style="position: absolute; top: 64854px; left: 766px;"><nobr>cVLD = X</nobr></div>
<div style="position: absolute; top: 64868px; left: 764px;"><nobr>CCPB = X</nobr></div>
<div style="position: absolute; top: 64812px; left: 334px;"><nobr><b>C1 : Valid-Waiting</b></nobr></div>
<div style="position: absolute; top: 64827px; left: 354px;"><nobr>cDONE = 0</nobr></div>
<div style="position: absolute; top: 64841px; left: 361px;"><nobr>cREL = 0</nobr></div>
<div style="position: absolute; top: 64856px; left: 360px;"><nobr>cVLD = X</nobr></div>
<div style="position: absolute; top: 64870px; left: 329px;"><nobr>CCPB = not this CPB</nobr></div>
<div style="position: absolute; top: 64813px; left: 145px;"><nobr><b>C0: Not-Valid</b></nobr></div>
<div style="position: absolute; top: 64827px; left: 152px;"><nobr>cDONE = 1</nobr></div>
<div style="position: absolute; top: 64841px; left: 158px;"><nobr>cREL = X</nobr></div>
<div style="position: absolute; top: 64856px; left: 158px;"><nobr>cVLD = X</nobr></div>
<div style="position: absolute; top: 64871px; left: 155px;"><nobr>CCPB = X</nobr></div>
<div style="position: absolute; top: 64810px; left: 527px;"><nobr><b>C2 : Valid-Processing</b></nobr></div>
<div style="position: absolute; top: 64825px; left: 558px;"><nobr>cDONE = 0</nobr></div>
<div style="position: absolute; top: 64839px; left: 564px;"><nobr>cREL = 0</nobr></div>
<div style="position: absolute; top: 64854px; left: 563px;"><nobr>cVLD = X</nobr></div>
<div style="position: absolute; top: 64868px; left: 541px;"><nobr>CCPB = this CPB</nobr></div>
<div style="position: absolute; top: 65011px; left: 626px;"><nobr>C2:C2</nobr></div>
<div style="position: absolute; top: 65033px; left: 621px;"><nobr>cVLD=0</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 65205px; left: 381px;"><nobr><b>Figure 4 – CPB States</b></nobr></div>
<div style="position: absolute; top: 65235px; left: 87px;"><nobr><b>7.6.3.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 65236px; left: 136px;"><nobr><b>C0: Not-Valid State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 65261px; left: 87px;"><nobr>The host controls a CPB when it is in the Not-Valid State.  The ADMA does not initiate execution of a CPB that </nobr></div>
<div style="position: absolute; top: 65279px; left: 87px;"><nobr>is in this State.  </nobr></div>
<div style="position: absolute; top: 65309px; left: 87px;"><nobr><b>Transition Initialization:C0</b>: A CPB enters the Not-Valid State when cDONE is initialized to one by the host.</nobr></div>
<div style="position: absolute; top: 65340px; left: 87px;"><nobr><b>Transition C0:C1: </b>To execute a CPB, the host shall clear the Response Flags Byte to zero in the CPB.  This </nobr></div>
<div style="position: absolute; top: 65358px; left: 87px;"><nobr>shall transition the CPB to the Valid-Waiting State.</nobr></div>
<div style="position: absolute; top: 65384px; left: 87px;"><nobr><b>7.6.3.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 65385px; left: 140px;"><nobr><b>C1: Valid-Waiting State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 65410px; left: 87px;"><nobr>When in this state the CPB is waiting to be processed by the ADMA.</nobr></div>
<div style="position: absolute; top: 65441px; left: 87px;"><nobr><b>Transition C1:C0: </b>The ADMA detects cVLD equal to zero before it begins execution of the CPB.</nobr></div>
</span></font>

<div style="position: absolute; top: 65515px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="58"><b>Page 58</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 66654px; left: 681px;"><nobr>Page 44</nobr></div>
<div style="position: absolute; top: 65591px; left: 87px;"><nobr>The host may cause the CPB to be ignored by clearing cVLD to zero while in the Valid-Waiting State.</nobr></div>
<div style="position: absolute; top: 65622px; left: 87px;"><nobr>NOTE - the host is unable to differentiate between the Valid-Waiting and Valid-Processing States.  This means </nobr></div>
<div style="position: absolute; top: 65639px; left: 87px;"><nobr>that the host clearing cVLD to zero may or may not cause a CPB to be ignored.</nobr></div>
<div style="position: absolute; top: 65669px; left: 87px;"><nobr><b>Transition C1:C2:  </b>When the ADMA accesses a Valid-Waiting CPB, the CPB transitions to the Valid-</nobr></div>
<div style="position: absolute; top: 65687px; left: 87px;"><nobr>Processing State if cVLD = 1.</nobr></div>
<div style="position: absolute; top: 65713px; left: 87px;"><nobr><b>7.6.3.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 65714px; left: 140px;"><nobr><b>C2: Valid-Processing State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 65739px; left: 87px;"><nobr>In this State the ADMA delivers the ATA command contained within the CPB to the ATA device.  </nobr></div>
<div style="position: absolute; top: 65770px; left: 87px;"><nobr><b>Transition C2:C0: </b>Upon completion of the ATA command(s), the ADMA sets cDONE to one, transitioning the </nobr></div>
<div style="position: absolute; top: 65788px; left: 87px;"><nobr>CPB from the Valid-Processing State to the Not-Valid State.  </nobr></div>
<div style="position: absolute; top: 65818px; left: 87px;"><nobr><b>Transition C2:C3: </b>If the ATA device sets the ATA REL Bit to one, cREL is set to one, cDONE is not set, and </nobr></div>
<div style="position: absolute; top: 65835px; left: 87px;"><nobr>the CPB transitions to the Released State.  </nobr></div>
<div style="position: absolute; top: 65866px; left: 87px;"><nobr><b>Transition C2:C2: </b>If the host clears cVLD to zero while in the Valid-Processing State, the ADMA engine </nobr></div>
<div style="position: absolute; top: 65883px; left: 87px;"><nobr>continues processing the CPB.</nobr></div>
<div style="position: absolute; top: 65909px; left: 87px;"><nobr><b>7.6.3.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 65910px; left: 136px;"><nobr><b>C3: Released State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 65935px; left: 87px;"><nobr>The CPB is in this state when the ATA overlapped or queued command contained in a Valid-Processing CPB </nobr></div>
<div style="position: absolute; top: 65953px; left: 87px;"><nobr>has been loaded into the ATA device, and the device clears BSY to zero with the ATA REL Bit set to one.  </nobr></div>
<div style="position: absolute; top: 65983px; left: 87px;"><nobr><b>Transition C3:C0: </b>Upon completion of the released ATA command(s), the ADMA sets cDONE to one, </nobr></div>
<div style="position: absolute; top: 66000px; left: 87px;"><nobr>transitioning the CPB from the Released State to the Not-Valid State.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 66033px; left: 65px;"><nobr><b>7.7 ADMA Operation</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 66058px; left: 75px;"><nobr><b>7.7.1 Operational Modes and States</b></nobr></div>
<div style="position: absolute; top: 66088px; left: 87px;"><nobr>The ADMA engine is either in ATA Register or ADMA Mode.  The ADMA can be in one of four States:  Legacy </nobr></div>
<div style="position: absolute; top: 66106px; left: 87px;"><nobr>Idle, ADMA Idle, Run, or Paused.  When the ADMA is in the Legacy Idle State, the ADMA engine is in ATA </nobr></div>
<div style="position: absolute; top: 66123px; left: 87px;"><nobr>Register Mode.  When the ADMA is in any other State, the ADMA engine is in ADMA Mode.</nobr></div>
<div style="position: absolute; top: 66144px; left: 75px;"><nobr><b>7.7.2 ADMA States</b></nobr></div>
<div style="position: absolute; top: 66176px; left: 87px;"><nobr>The ADMA engine operates as a state machine (see </nobr></div>
<div style="position: absolute; top: 66202px; left: 87px;"><nobr>).  The host software controls the ADMA state via the aGO, and aPSE Bits in ADMCTL.  The host software may </nobr></div>
<div style="position: absolute; top: 66218px; left: 87px;"><nobr>check the state of the ADMA via the aPSD, aSTPD, and aLGCY Bits in ADMSTAT.</nobr></div>
<div style="position: absolute; top: 66245px; left: 87px;"><nobr>The ADMA is controlled by the values in ADMCTL, CCNTR, ATA ERR, and the ATA Service Interrupt.  The </nobr></div>
<div style="position: absolute; top: 66262px; left: 87px;"><nobr>ADMA reports its status in ADMSTAT.  </nobr></div>
<div style="position: absolute; top: 66288px; left: 91px;"><nobr>indicates the States and the transitions between them.</nobr></div>
</span></font>

<div style="position: absolute; top: 66703px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="59"><b>Page 59</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 66757px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 67842px; left: 87px;"><nobr>Page 45</nobr></div>
</span></font>
<font face="Times" size="2"><span style="font-size: 8px; font-family: Times;">
<div style="position: absolute; top: 66926px; left: 210px;"><nobr>:A0</nobr></div>
<div style="position: absolute; top: 66906px; left: 176px;"><nobr>Power-On, Reset</nobr></div>
<div style="position: absolute; top: 67034px; left: 307px;"><nobr>A0:A2</nobr></div>
<div style="position: absolute; top: 67054px; left: 312px;"><nobr>aSTPD = 0</nobr></div>
<div style="position: absolute; top: 67068px; left: 312px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 67083px; left: 296px;"><nobr>CCNTR = CCNT</nobr></div>
<div style="position: absolute; top: 67014px; left: 298px;"><nobr>aGO is written as 1</nobr></div>
<div style="position: absolute; top: 66906px; left: 606px;"><nobr>aGO is written as  1</nobr></div>
<div style="position: absolute; top: 66926px; left: 636px;"><nobr>A2:A2</nobr></div>
<div style="position: absolute; top: 67115px; left: 531px;"><nobr>A2:A0</nobr></div>
<div style="position: absolute; top: 67095px; left: 473px;"><nobr>aGO is written as  0</nobr></div>
<div style="position: absolute; top: 67134px; left: 467px;"><nobr>aLGCY = 1</nobr></div>
<div style="position: absolute; top: 67149px; left: 419px;"><nobr>Current CPB Status Unknown</nobr></div>
<div style="position: absolute; top: 67164px; left: 421px;"><nobr>ATA Device Status Unknown</nobr></div>
<div style="position: absolute; top: 67527px; left: 512px;"><nobr>CCNTR = 0</nobr></div>
<div style="position: absolute; top: 67567px; left: 521px;"><nobr>aSTPD = 1</nobr></div>
<div style="position: absolute; top: 67548px; left: 549px;"><nobr>A2:A1</nobr></div>
<div style="position: absolute; top: 67454px; left: 221px;"><nobr>A1:A0</nobr></div>
<div style="position: absolute; top: 67474px; left: 204px;"><nobr>aLGCY = 1</nobr></div>
<div style="position: absolute; top: 67399px; left: 289px;"><nobr>A1:A2</nobr></div>
<div style="position: absolute; top: 67378px; left: 298px;"><nobr>aGO is written as 1</nobr></div>
<div style="position: absolute; top: 67418px; left: 305px;"><nobr>aSTPD = 0</nobr></div>
<div style="position: absolute; top: 67432px; left: 289px;"><nobr>CCNTR = CCNT</nobr></div>
<div style="position: absolute; top: 67756px; left: 606px;"><nobr>CCNTR = CCNT</nobr></div>
<div style="position: absolute; top: 67771px; left: 626px;"><nobr>aPSD = 0</nobr></div>
<div style="position: absolute; top: 67426px; left: 618px;"><nobr>A2:A3</nobr></div>
<div style="position: absolute; top: 67392px; left: 610px;"><nobr>aPSE = 1, CPB Complete,</nobr></div>
<div style="position: absolute; top: 67407px; left: 647px;"><nobr>CCNTR &gt; 0</nobr></div>
<div style="position: absolute; top: 67446px; left: 605px;"><nobr>aPSD = 1</nobr></div>
<div style="position: absolute; top: 66906px; left: 296px;"><nobr>aGO is written as  0</nobr></div>
<div style="position: absolute; top: 66926px; left: 325px;"><nobr>A0:A0</nobr></div>
<div style="position: absolute; top: 67738px; left: 618px;"><nobr>A3:A2</nobr></div>
<div style="position: absolute; top: 67717px; left: 608px;"><nobr>aGO is written as  1</nobr></div>
<div style="position: absolute; top: 66946px; left: 204px;"><nobr>aLGCY = 1</nobr></div>
<div style="position: absolute; top: 66948px; left: 606px;"><nobr>CCNTR = CCNT</nobr></div>
<div style="position: absolute; top: 67737px; left: 530px;"><nobr>A3:A0</nobr></div>
<div style="position: absolute; top: 67756px; left: 518px;"><nobr>aPSD = 0</nobr></div>
<div style="position: absolute; top: 67771px; left: 514px;"><nobr>aLGCY = 1</nobr></div>
<div style="position: absolute; top: 67493px; left: 289px;"><nobr>A1:A2</nobr></div>
<div style="position: absolute; top: 67717px; left: 473px;"><nobr>aGO is written as  0</nobr></div>
<div style="position: absolute; top: 67473px; left: 293px;"><nobr>ATA Service Interrupt</nobr></div>
<div style="position: absolute; top: 67513px; left: 291px;"><nobr>aSTPD = 0</nobr></div>
<div style="position: absolute; top: 67432px; left: 162px;"><nobr>aGO is written as  0</nobr></div>
<div style="position: absolute; top: 66816px; left: 568px;"><nobr><b>A2: Run</b></nobr></div>
<div style="position: absolute; top: 66829px; left: 566px;"><nobr>aPSD = 0</nobr></div>
<div style="position: absolute; top: 66844px; left: 561px;"><nobr>aSTPD = 0</nobr></div>
<div style="position: absolute; top: 66859px; left: 561px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 67288px; left: 240px;"><nobr><b>A1: ADMA Idle</b></nobr></div>
<div style="position: absolute; top: 67303px; left: 255px;"><nobr>aPSD = 0</nobr></div>
<div style="position: absolute; top: 67318px; left: 251px;"><nobr>aSTPD = 1</nobr></div>
<div style="position: absolute; top: 67331px; left: 251px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 67602px; left: 559px;"><nobr><b>A3: Paused</b></nobr></div>
<div style="position: absolute; top: 67617px; left: 566px;"><nobr>aPSD = 1</nobr></div>
<div style="position: absolute; top: 67632px; left: 561px;"><nobr>aSTPD = 0</nobr></div>
<div style="position: absolute; top: 67646px; left: 561px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 66816px; left: 237px;"><nobr><b>A0: Legacy Idle</b></nobr></div>
<div style="position: absolute; top: 66829px; left: 254px;"><nobr>aPSD = X</nobr></div>
<div style="position: absolute; top: 66844px; left: 251px;"><nobr>aSTPD = X</nobr></div>
<div style="position: absolute; top: 66859px; left: 251px;"><nobr>aLGCY = 1</nobr></div>
<div style="position: absolute; top: 67034px; left: 636px;"><nobr>A2:A2</nobr></div>
<div style="position: absolute; top: 67014px; left: 605px;"><nobr>CPB Complete, aPSE = 0</nobr></div>
<div style="position: absolute; top: 67056px; left: 605px;"><nobr>CCNTR = CCNTR  - 1</nobr></div>
<div style="position: absolute; top: 67223px; left: 531px;"><nobr>A2:A0</nobr></div>
<div style="position: absolute; top: 67203px; left: 497px;"><nobr>Error Condition</nobr></div>
<div style="position: absolute; top: 67243px; left: 474px;"><nobr>aLGCY = 1</nobr></div>
<div style="position: absolute; top: 67258px; left: 434px;"><nobr>set error bits in ADMSTAT</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 67799px; left: 338px;"><nobr><b>Figure 5 – ADMA State Transitions</b></nobr></div>
</span></font>

<div style="position: absolute; top: 67891px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="60"><b>Page 60</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 69030px; left: 681px;"><nobr>Page 46</nobr></div>
<div style="position: absolute; top: 67967px; left: 87px;"><nobr><b>7.7.2.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 67968px; left: 136px;"><nobr><b>A0: Legacy Idle State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 67993px; left: 87px;"><nobr>The Legacy Idle State is the power-on default State.  In this State, the ADMA acts as an address decoder for the </nobr></div>
<div style="position: absolute; top: 68011px; left: 87px;"><nobr>host.  All reads and writes are performed using host I/O or host memory instructions.  The only function </nobr></div>
<div style="position: absolute; top: 68027px; left: 87px;"><nobr>performed by the ADMA is to control the signal timings of the ATA bus using the ATA core, and to respond to </nobr></div>
<div style="position: absolute; top: 68044px; left: 87px;"><nobr>PCI signals.  In the Legacy Idle State, all data transfers use the PIO protocols, and ATA bus interrupts are </nobr></div>
<div style="position: absolute; top: 68062px; left: 87px;"><nobr>directly mapped onto the PCI Interrupt signal.</nobr></div>
<div style="position: absolute; top: 68084px; left: 87px;"><nobr><b>Transition A0:A0: </b>Legacy Idle to Legacy Idle</nobr></div>
<div style="position: absolute; top: 68110px; left: 87px;"><nobr>The host's writing aGO as zero leaves the ADMA in the Legacy Idle State.</nobr></div>
<div style="position: absolute; top: 68132px; left: 87px;"><nobr><b>Transition A0:A2: </b>Legacy Idle to Run</nobr></div>
<div style="position: absolute; top: 68158px; left: 87px;"><nobr>The host's loading a value greater than zero into CCNT and setting aGO to one will transition the ADMA from </nobr></div>
<div style="position: absolute; top: 68175px; left: 87px;"><nobr>Legacy Idle to Run.  CCNTR will be initialized with the contents of CCNT.  The ADMA continues to execute </nobr></div>
<div style="position: absolute; top: 68193px; left: 87px;"><nobr>CPBs until the Run State is exited (because aGO is cleared to zero, aPSE is set to one, or CCNTR decrements </nobr></div>
<div style="position: absolute; top: 68210px; left: 87px;"><nobr>to zero).</nobr></div>
<div style="position: absolute; top: 68236px; left: 87px;"><nobr><b>7.7.2.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 68237px; left: 140px;"><nobr><b>A1: ADMA Idle State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 68261px; left: 87px;"><nobr>In this State, the ADMA takes no actions.</nobr></div>
<div style="position: absolute; top: 68284px; left: 87px;"><nobr><b>Transition A1:A2: </b>ADMA Idle to Run</nobr></div>
<div style="position: absolute; top: 68340px; left: 87px;"><nobr>When the host writes aGO as one, the ADMA engine transitions from ADMA Idle to Run, and CCNTR is </nobr></div>
<div style="position: absolute; top: 68358px; left: 87px;"><nobr>initialized with the contents of CCNT.  If aPSE = 1, a single CPB will be executed.  If aPSE = zero, the ADMA </nobr></div>
<div style="position: absolute; top: 68375px; left: 87px;"><nobr>engine executes CPBs continuously.</nobr></div>
<div style="position: absolute; top: 68405px; left: 87px;"><nobr>If the ADMA receives an ATA Service interrupt the ADMA transitions from ADMA Idle to Run automatically </nobr></div>
<div style="position: absolute; top: 68423px; left: 87px;"><nobr>without refreshing the value in CCNTR.</nobr></div>
<div style="position: absolute; top: 68445px; left: 87px;"><nobr><b>Transition A1:A0: </b>ADMA Idle to Legacy Idle</nobr></div>
<div style="position: absolute; top: 68471px; left: 87px;"><nobr>The host's clearing aGO to zero shall transition the ADMA to the Legacy Idle State.</nobr></div>
<div style="position: absolute; top: 68498px; left: 87px;"><nobr><b>7.7.2.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 68499px; left: 136px;"><nobr><b>A2: Run State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 68524px; left: 87px;"><nobr>In this State the ADMA reads and executes CPBs.</nobr></div>
<div style="position: absolute; top: 68545px; left: 87px;"><nobr><b>Transition A2:A2: </b>Run to Run</nobr></div>
<div style="position: absolute; top: 68571px; left: 87px;"><nobr>When the host writes aGO as one, CCNTR is refreshed with the contents of CCNT.  The CPB in process is not </nobr></div>
<div style="position: absolute; top: 68589px; left: 87px;"><nobr>affected.  CCNTR shall always refreshed when aGO is set.</nobr></div>
<div style="position: absolute; top: 68619px; left: 87px;"><nobr>When the current CPB is completed, CCNTR is decremented.</nobr></div>
<div style="position: absolute; top: 68641px; left: 87px;"><nobr><b>Transition A2:A0: </b>Run to Legacy Idle</nobr></div>
<div style="position: absolute; top: 68668px; left: 87px;"><nobr>When a transition from the Run to the Legacy Idle State occurs, the host shall take the necessary steps to bring </nobr></div>
<div style="position: absolute; top: 68684px; left: 87px;"><nobr>both the ATA device and the ADMA into a known state.  This may include resetting the ADMA and/or the device.</nobr></div>
<div style="position: absolute; top: 68715px; left: 87px;"><nobr>When the host clears aGO to zero, the ADMA transitions immediately from the Run State to the Legacy Idle </nobr></div>
<div style="position: absolute; top: 68733px; left: 87px;"><nobr>State.  This action is not recommended: the status of the current CPB and of the device is unknown.</nobr></div>
<div style="position: absolute; top: 68763px; left: 87px;"><nobr>When an error condition occurs, the ADMA transitions from the Run State to the Legacy Idle State.  This </nobr></div>
<div style="position: absolute; top: 68780px; left: 87px;"><nobr>transition indicates to the host that an ADMA recognized error has occurred.  See 7.7.4, for a complete </nobr></div>
<div style="position: absolute; top: 68798px; left: 87px;"><nobr>discussion of ADMA recognized error conditions.</nobr></div>
<div style="position: absolute; top: 68819px; left: 87px;"><nobr><b>Transition A2:A3: </b>Run to Paused</nobr></div>
<div style="position: absolute; top: 68845px; left: 87px;"><nobr>If aPSE and aGO are set to one when the current CPB is completed, the ADMA transitions to the Paused State.</nobr></div>
<div style="position: absolute; top: 68868px; left: 87px;"><nobr><b>Transition A2:A1: </b>Run to ADMA Idle</nobr></div>
<div style="position: absolute; top: 68894px; left: 87px;"><nobr>The ADMA transitions to the ADMA Idle State when CCNTR decrements to zero.  aGO is unchanged by the </nobr></div>
<div style="position: absolute; top: 68911px; left: 87px;"><nobr>ADMA as a result of this transition.  If a Valid-Processing CPB is completed at the same time, the ADMA sets </nobr></div>
<div style="position: absolute; top: 68929px; left: 87px;"><nobr>aDONE to one, and may assert the PCI Interrupt signal.</nobr></div>
<div style="position: absolute; top: 68954px; left: 87px;"><nobr><b>7.7.2.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 68955px; left: 136px;"><nobr><b>A3: Paused State</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 68980px; left: 87px;"><nobr>In this State, the ADMA takes no actions.</nobr></div>
<div style="position: absolute; top: 69002px; left: 87px;"><nobr><b>Transition A3:A0: </b>Paused to Legacy Idle</nobr></div>
</span></font>

<div style="position: absolute; top: 69079px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="61"><b>Page 61</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 69133px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 70218px; left: 87px;"><nobr>Page 47</nobr></div>
<div style="position: absolute; top: 69155px; left: 206px;"><nobr>If the host clears aGO to zero, the ADMA transitions to the Legacy Idle State.</nobr></div>
<div style="position: absolute; top: 69190px; left: 87px;"><nobr><b>Transition A3:A2</b>: Paused to Run</nobr></div>
<div style="position: absolute; top: 69215px; left: 87px;"><nobr>When the host sets aGO to one and clears aPSE to zero, the ADMA transitions to the Run State and </nobr></div>
<div style="position: absolute; top: 69233px; left: 87px;"><nobr>continuously executes CPBs.</nobr></div>
<div style="position: absolute; top: 69264px; left: 87px;"><nobr>When the host sets aGO to one and aPSE to one, the ADMA transitions to the Run State and executes one </nobr></div>
<div style="position: absolute; top: 69281px; left: 87px;"><nobr>CPB.  See A.7.</nobr></div>
<div style="position: absolute; top: 69312px; left: 87px;"><nobr>In the event that an ATA Service Interrupt has occurred while the ADMA was in the Paused State, the ADMA </nobr></div>
<div style="position: absolute; top: 69329px; left: 87px;"><nobr>may process the Service Request(s) before executing any non-Released CPB.</nobr></div>
<div style="position: absolute; top: 69373px; left: 75px;"><nobr><b>7.7.3 Interrupt Assertion</b></nobr></div>
<div style="position: absolute; top: 69403px; left: 87px;"><nobr>The ADMA asserts the PCI Interrupt signal when it sets a bit in ADMSTAT.  See aIEN in Table 20, and cIEN in </nobr></div>
<div style="position: absolute; top: 69420px; left: 87px;"><nobr>Table 22 for exceptions.</nobr></div>
<div style="position: absolute; top: 69447px; left: 87px;"><nobr>NOTE - if an error occurs, CCPB may not point to the CPB with the error.</nobr></div>
<div style="position: absolute; top: 69469px; left: 75px;"><nobr><b>7.7.4 Error Handling</b></nobr></div>
<div style="position: absolute; top: 69499px; left: 87px;"><nobr>The ADMA detects the following types of error condition:  ATA Error, ATA Spurious Interrupt, CPB Error, APRD </nobr></div>
<div style="position: absolute; top: 69517px; left: 87px;"><nobr>deficiency, and APRD excess.  Each of these errors are reported in the CPB Response Byte.</nobr></div>
<div style="position: absolute; top: 69543px; left: 87px;"><nobr>The ADMA also detects PCI errors.  A PCI Error is reported by aPERR being set to one in ADMSTAT.</nobr></div>
<div style="position: absolute; top: 69569px; left: 87px;"><nobr>In all instances of an error occurring, the ADMA transitions to the Legacy Idle State.  When an error has </nobr></div>
<div style="position: absolute; top: 69587px; left: 87px;"><nobr>occurred, the ADMA ignores a write of one to aGO until ADMSTAT is read, clearing aCPBERR.</nobr></div>
<div style="position: absolute; top: 69608px; left: 87px;"><nobr><b>7.7.4.1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 69609px; left: 136px;"><nobr><b>ATA Error</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 69634px; left: 87px;"><nobr>When the ADMA detects ATA ERR set to one, it sets cATERR and aCPBERR to one, transitions to the Legacy </nobr></div>
<div style="position: absolute; top: 69651px; left: 87px;"><nobr>Idle State, and asserts the PCI Interrupt Signal.  (The host software shall assume that the CPB did not complete </nobr></div>
<div style="position: absolute; top: 69669px; left: 87px;"><nobr>successfully.)  In ATA devices, this indicates that an error has occurred.  In ATAPI devices, this might indicate </nobr></div>
<div style="position: absolute; top: 69686px; left: 87px;"><nobr>an error or a check condition.</nobr></div>
<div style="position: absolute; top: 69712px; left: 87px;"><nobr><b>7.7.4.2</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 69713px; left: 136px;"><nobr><b>ATA Spurious Interrupt</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 69737px; left: 87px;"><nobr>If the ATA INTRQ signal is unexpectedly asserted while the ADMA is in the Run State, the ADMA shall  set </nobr></div>
<div style="position: absolute; top: 69755px; left: 87px;"><nobr>cSPNT to one,  shall set aCPBERR to one, shall transition to the Legacy Idle State, and shall assert the PCI </nobr></div>
<div style="position: absolute; top: 69772px; left: 87px;"><nobr>interrupt signal.</nobr></div>
<div style="position: absolute; top: 69803px; left: 87px;"><nobr>For example a spurious interrupt may indicate a faulty ATA channel or a device malfunctioning.  Data transfers </nobr></div>
<div style="position: absolute; top: 69821px; left: 87px;"><nobr>in progress are stopped.</nobr></div>
<div style="position: absolute; top: 69851px; left: 87px;"><nobr>When an ATA spurious interrupt occurs, the host regains control of the ATA channel by toggling aRSTADM </nobr></div>
<div style="position: absolute; top: 69868px; left: 87px;"><nobr>followed by aRSTA in ADMCTL.</nobr></div>
<div style="position: absolute; top: 69895px; left: 87px;"><nobr><b>7.7.4.3</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 69896px; left: 136px;"><nobr><b>CPB Error</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 69921px; left: 87px;"><nobr>This error occurs when a service interrupt points to a CPB that is not in the Released State.  The ADMA shall </nobr></div>
<div style="position: absolute; top: 69938px; left: 87px;"><nobr>set cCPBERR to one, sets aCPBERR to one, transitions to the Legacy Idle State, and asserts the PCI Interrupt </nobr></div>
<div style="position: absolute; top: 69955px; left: 87px;"><nobr>signal.  This indicates that  an ATA TAG, or an ADMA data structure, may have been corrupted.</nobr></div>
<div style="position: absolute; top: 69982px; left: 87px;"><nobr><b>7.7.4.4</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 69983px; left: 136px;"><nobr><b>APRD Deficiency</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 70007px; left: 87px;"><nobr>This error occurs when the APRD transfer lengths are insufficient to complete the command.  The ADMA sets </nobr></div>
<div style="position: absolute; top: 70024px; left: 87px;"><nobr>cPSDEF to one, sets aCPBERR to one, transitions to the Legacy Idle State, and asserts the PCI Interrupt </nobr></div>
<div style="position: absolute; top: 70041px; left: 87px;"><nobr>signal. The ADMA engine shall ensure that the device completes the command.</nobr></div>
<div style="position: absolute; top: 70068px; left: 87px;"><nobr><b>7.7.4.5</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 70069px; left: 136px;"><nobr><b>APRD Excess</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 70094px; left: 87px;"><nobr>This error occurs when the APRD transfer lengths are in excess of that required to complete the command.  The </nobr></div>
<div style="position: absolute; top: 70111px; left: 87px;"><nobr>ADMA sets cPSEXC to one irrespective of the state of pIGEX.  If pIGEX is cleared to zero in the APRD, the </nobr></div>
<div style="position: absolute; top: 70128px; left: 87px;"><nobr>ADMA sets aCPBERR to one in ADMSTAT, transitions to the Legacy Idle State, and asserts the PCI Interrupt </nobr></div>
<div style="position: absolute; top: 70146px; left: 87px;"><nobr>signal.</nobr></div>
</span></font>

<div style="position: absolute; top: 70267px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="62"><b>Page 62</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 71406px; left: 681px;"><nobr>Page 48</nobr></div>
<div style="position: absolute; top: 70343px; left: 87px;"><nobr><b>7.7.4.6</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 11px; font-family: Times;">
<div style="position: absolute; top: 70344px; left: 136px;"><nobr><b>PCI Error</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 70369px; left: 87px;"><nobr>The ADMA detects a PCI error whenever bits 8, 12, 13, or 15 of the PCI Status Register are set to one, </nobr></div>
<div style="position: absolute; top: 70387px; left: 87px;"><nobr>indicating a severe system problem.  See {PCI Spec}.  Any transfers across the PCI bus may result in </nobr></div>
<div style="position: absolute; top: 70403px; left: 87px;"><nobr>catastrophic failure.  The ADMA ceases all ATA operations, sets aPERR to one, transitions to the Legacy Idle </nobr></div>
<div style="position: absolute; top: 70420px; left: 87px;"><nobr>State, and asserts the PCI Interrupt signal.  The ADMA does not attempt to update the CPB, as this would </nobr></div>
<div style="position: absolute; top: 70438px; left: 87px;"><nobr>involve a complete master mode operation on the suspect PCI bus.  The host software shall take whatever </nobr></div>
<div style="position: absolute; top: 70455px; left: 87px;"><nobr>actions it can to determine the state of the bus, before attempting any accesses to the ADMA.</nobr></div>
<div style="position: absolute; top: 70486px; left: 87px;"><nobr>The PCI Interrupt interrupt signal will remain asserted until aPERR is cleared to zero by a read of ADMSTAT.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 70518px; left: 65px;"><nobr><b>7.8 Host Operation</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 70561px; left: 87px;"><nobr>Figure 6 illustrates the state that Host software or BIOS may adopt when controlling ATA devices through an </nobr></div>
<div style="position: absolute; top: 70579px; left: 87px;"><nobr>ADMA adapter.</nobr></div>
</span></font>
<font face="Times" size="2"><span style="font-size: 8px; font-family: Times;">
<div style="position: absolute; top: 70626px; left: 122px;"><nobr><b>H0 : Register Mode</b></nobr></div>
<div style="position: absolute; top: 70638px; left: 110px;"><nobr>aPSD = x and aSTPD = 1</nobr></div>
<div style="position: absolute; top: 70650px; left: 143px;"><nobr>aLGCY = 1</nobr></div>
<div style="position: absolute; top: 70663px; left: 107px;"><nobr>Chain state is full or not full</nobr></div>
<div style="position: absolute; top: 70626px; left: 294px;"><nobr><b>H1 : CPB Chain Inactive</b></nobr></div>
<div style="position: absolute; top: 70638px; left: 297px;"><nobr>aPSD = 1 or aSTPD = 1</nobr></div>
<div style="position: absolute; top: 70650px; left: 326px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 70663px; left: 303px;"><nobr>Chain is full or not full</nobr></div>
<div style="position: absolute; top: 70626px; left: 471px;"><nobr><b>H2 : CPB Chain Processing</b></nobr></div>
<div style="position: absolute; top: 70638px; left: 479px;"><nobr>aPSD = 0 and aSTPD = x</nobr></div>
<div style="position: absolute; top: 70650px; left: 512px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 70663px; left: 469px;"><nobr>Chain is not full and not empty</nobr></div>
<div style="position: absolute; top: 70626px; left: 671px;"><nobr><b>H3 : CPB Chain Full</b></nobr></div>
<div style="position: absolute; top: 70638px; left: 660px;"><nobr>aPSD = 0 and aSTPD = x</nobr></div>
<div style="position: absolute; top: 70650px; left: 693px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 70663px; left: 692px;"><nobr>Chain is full</nobr></div>
<div style="position: absolute; top: 70721px; left: 127px;"><nobr><b>:H0</b></nobr></div>
<div style="position: absolute; top: 70710px; left: 244px;"><nobr><b>H0 : H1</b></nobr></div>
<div style="position: absolute; top: 70721px; left: 428px;"><nobr><b>H1 : H2</b></nobr></div>
<div style="position: absolute; top: 70744px; left: 611px;"><nobr><b>H2 : H3</b></nobr></div>
<div style="position: absolute; top: 70702px; left: 113px;"><nobr>Power On</nobr></div>
<div style="position: absolute; top: 70695px; left: 218px;"><nobr>Enable ADMA mode</nobr></div>
<div style="position: absolute; top: 70782px; left: 370px;"><nobr><b>H1 : H1</b></nobr></div>
<div style="position: absolute; top: 70759px; left: 383px;"><nobr>Modify Chain</nobr></div>
<div style="position: absolute; top: 70772px; left: 392px;"><nobr>Structure</nobr></div>
<div style="position: absolute; top: 70695px; left: 402px;"><nobr>Request added to</nobr></div>
<div style="position: absolute; top: 70708px; left: 417px;"><nobr>CPB chain</nobr></div>
<div style="position: absolute; top: 70767px; left: 244px;"><nobr><b>H1 : H0</b></nobr></div>
<div style="position: absolute; top: 70736px; left: 209px;"><nobr>Host sets legacy mode</nobr></div>
<div style="position: absolute; top: 70748px; left: 223px;"><nobr>(Write aGO as 0)</nobr></div>
<div style="position: absolute; top: 70825px; left: 428px;"><nobr><b>H2 : H1</b></nobr></div>
<div style="position: absolute; top: 70799px; left: 390px;"><nobr>Request completed and</nobr></div>
<div style="position: absolute; top: 70811px; left: 405px;"><nobr>CPB chain empty</nobr></div>
<div style="position: absolute; top: 70719px; left: 563px;"><nobr>Request added to CPB chain</nobr></div>
<div style="position: absolute; top: 70730px; left: 569px;"><nobr>making the CPB chain full</nobr></div>
<div style="position: absolute; top: 70800px; left: 554px;"><nobr><b>H2 : H2</b></nobr></div>
<div style="position: absolute; top: 70762px; left: 545px;"><nobr>Request added to CPB chain</nobr></div>
<div style="position: absolute; top: 70774px; left: 555px;"><nobr>and CPB chain is not full</nobr></div>
<div style="position: absolute; top: 70869px; left: 554px;"><nobr><b>H2 : H2</b></nobr></div>
<div style="position: absolute; top: 70836px; left: 548px;"><nobr>CPB is complete and CPB</nobr></div>
<div style="position: absolute; top: 70848px; left: 567px;"><nobr>chain is not empty</nobr></div>
<div style="position: absolute; top: 70699px; left: 611px;"><nobr><b>H3 : H2</b></nobr></div>
<div style="position: absolute; top: 70686px; left: 591px;"><nobr>CPB is complete</nobr></div>
<div style="position: absolute; top: 70961px; left: 430px;"><nobr><b>H2 : H5</b></nobr></div>
<div style="position: absolute; top: 70952px; left: 414px;"><nobr>An error occurs</nobr></div>
<div style="position: absolute; top: 70865px; left: 335px;"><nobr><b>H0 : H2</b></nobr></div>
<div style="position: absolute; top: 70854px; left: 242px;"><nobr>CPB chain constructed with at least 1 active CPB</nobr></div>
<div style="position: absolute; top: 71098px; left: 428px;"><nobr><b>H0 : H3</b></nobr></div>
<div style="position: absolute; top: 71109px; left: 345px;"><nobr>CPB chain constructed with all CPB's active</nobr></div>
<div style="position: absolute; top: 70791px; left: 737px;"><nobr><b>H3 : H3</b></nobr></div>
<div style="position: absolute; top: 70755px; left: 731px;"><nobr>Request received &amp;</nobr></div>
<div style="position: absolute; top: 70767px; left: 757px;"><nobr>rejected</nobr></div>
<div style="position: absolute; top: 70891px; left: 597px;"><nobr><b>H4 : Timeout</b></nobr></div>
<div style="position: absolute; top: 70903px; left: 573px;"><nobr>aPSD = 0 and aSTD = x</nobr></div>
<div style="position: absolute; top: 70916px; left: 603px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 70927px; left: 585px;"><nobr>Chain is not empty</nobr></div>
<div style="position: absolute; top: 70890px; left: 336px;"><nobr><b>H5 : Error</b></nobr></div>
<div style="position: absolute; top: 70902px; left: 302px;"><nobr>aPSD = 0 and aSTPD = x</nobr></div>
<div style="position: absolute; top: 70915px; left: 335px;"><nobr>aLGCY = 0</nobr></div>
<div style="position: absolute; top: 70927px; left: 317px;"><nobr>Chain is not empty</nobr></div>
<div style="position: absolute; top: 71069px; left: 522px;"><nobr><b>H3 : H5</b></nobr></div>
<div style="position: absolute; top: 70978px; left: 248px;"><nobr><b>H5 : H0</b></nobr></div>
<div style="position: absolute; top: 71024px; left: 655px;"><nobr><b>H3 : H4</b></nobr></div>
<div style="position: absolute; top: 71024px; left: 564px;"><nobr><b>H4 : H2</b></nobr></div>
<div style="position: absolute; top: 70990px; left: 564px;"><nobr><b>H2 : H4</b></nobr></div>
<div style="position: absolute; top: 70991px; left: 656px;"><nobr><b>H4 : H3</b></nobr></div>
<div style="position: absolute; top: 70974px; left: 541px;"><nobr>A Timeout occurs</nobr></div>
<div style="position: absolute; top: 70952px; left: 219px;"><nobr>Host sets legacy mode</nobr></div>
<div style="position: absolute; top: 70964px; left: 233px;"><nobr>(Write aGO as 0)</nobr></div>
<div style="position: absolute; top: 70974px; left: 666px;"><nobr>Retry</nobr></div>
<div style="position: absolute; top: 71009px; left: 569px;"><nobr>Retry</nobr></div>
<div style="position: absolute; top: 71009px; left: 638px;"><nobr>A Timeout occurs</nobr></div>
<div style="position: absolute; top: 71055px; left: 506px;"><nobr>An error occurs</nobr></div>
<div style="position: absolute; top: 70955px; left: 581px;"><nobr><b>H4 : H1</b></nobr></div>
<div style="position: absolute; top: 70739px; left: 365px;"><nobr><b>H4 : H1</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 71176px; left: 348px;"><nobr><b>Figure 6 – Host Software States</b></nobr></div>
<div style="position: absolute; top: 71207px; left: 75px;"><nobr><b>7.8.1 Host Software States</b></nobr></div>
<div style="position: absolute; top: 71233px; left: 75px;"><nobr><b>7.8.2 H0 Register State</b></nobr></div>
<div style="position: absolute; top: 71264px; left: 87px;"><nobr>The host may initialize data structures and the ADMA and ATA device hardware while in this state. Error </nobr></div>
<div style="position: absolute; top: 71281px; left: 87px;"><nobr>conditions are also handled in this state.</nobr></div>
<div style="position: absolute; top: 71307px; left: 87px;"><nobr><b>Transition H0:H1: </b>Register to CPB Chain Inactive </nobr></div>
<div style="position: absolute; top: 71329px; left: 87px;"><nobr>The host writes a one to aGO with no valid CPBs in the CPB chain.</nobr></div>
<div style="position: absolute; top: 71355px; left: 87px;"><nobr><b>Transition H0:H2: </b>Register to CPB Chain Processing</nobr></div>
</span></font>

<div style="position: absolute; top: 71455px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="63"><b>Page 63</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 71509px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 72594px; left: 87px;"><nobr>Page 49</nobr></div>
<div style="position: absolute; top: 71531px; left: 87px;"><nobr>The host receives an I/O request.  The host constructs CPB and PRD structures and may update the CPB </nobr></div>
<div style="position: absolute; top: 71549px; left: 87px;"><nobr>lookup table if necessary.  Finally aGO is written as one to inform the ADMA that a request has been added on </nobr></div>
<div style="position: absolute; top: 71566px; left: 87px;"><nobr>the way to the chain.</nobr></div>
<div style="position: absolute; top: 71587px; left: 87px;"><nobr><b>Transition H0:H3: </b>Register to CPB Full </nobr></div>
<div style="position: absolute; top: 71614px; left: 87px;"><nobr>The host receives an I/O request. The host constructs CPB and PRD structures and may update the CPB </nobr></div>
<div style="position: absolute; top: 71631px; left: 87px;"><nobr>lookup table if necessary. The host then writes a one to aGO transitioning the host to the CPB full state.  This </nobr></div>
<div style="position: absolute; top: 71648px; left: 87px;"><nobr>CPB is the last one that can be added to the existing CPB structure.</nobr></div>
<div style="position: absolute; top: 71675px; left: 75px;"><nobr><b>7.8.3 H1: No CPB Chain Processing </b></nobr></div>
<div style="position: absolute; top: 71705px; left: 87px;"><nobr>The ADMA is in the paused or stopped state.</nobr></div>
<div style="position: absolute; top: 71731px; left: 87px;"><nobr><b>Transition H1:H1: </b>Modify Chain Structure</nobr></div>
<div style="position: absolute; top: 71762px; left: 87px;"><nobr>The modification of the data structures such as adding or deleting CPBs may be undertaken by the host.</nobr></div>
<div style="position: absolute; top: 71793px; left: 87px;"><nobr><b>Transition H1:H2: </b>CPB Chain Inactive Processing to CPB Processing</nobr></div>
<div style="position: absolute; top: 71823px; left: 87px;"><nobr>The host receives an I/O request. The host constructs CPB and PRD structures and may update the CPB </nobr></div>
<div style="position: absolute; top: 71841px; left: 87px;"><nobr>lookup table if necessary. Finally aGO is written as one to inform the ADMA that a request has been added to </nobr></div>
<div style="position: absolute; top: 71858px; left: 87px;"><nobr>the chain.</nobr></div>
<div style="position: absolute; top: 71888px; left: 87px;"><nobr><b>Transition H1:H0: </b>Host Sets Register State </nobr></div>
<div style="position: absolute; top: 71920px; left: 87px;"><nobr>The host writes a zero to aGO transitions the host to the Register state.</nobr></div>
<div style="position: absolute; top: 71946px; left: 75px;"><nobr><b>7.8.4 H2: Chain Processing State</b></nobr></div>
<div style="position: absolute; top: 71976px; left: 87px;"><nobr>In this state the host is able to satisfy new I/O requests and add them to the CPB structure as well as process </nobr></div>
<div style="position: absolute; top: 71994px; left: 87px;"><nobr>completed CPBs.</nobr></div>
<div style="position: absolute; top: 72020px; left: 87px;"><nobr><b>Transition H2:H3: </b>Chain Processing to Chain Full</nobr></div>
<div style="position: absolute; top: 72050px; left: 87px;"><nobr>The host receives an I/O request. The host constructs CPB and PRD structures and may update the CPB </nobr></div>
<div style="position: absolute; top: 72068px; left: 87px;"><nobr>lookup table if necessary. Finally aGO is written as one to inform the ADMA that a request has been added to </nobr></div>
<div style="position: absolute; top: 72085px; left: 87px;"><nobr>the chain. This CPB is the last one that can be added to the existing CPB structure.</nobr></div>
<div style="position: absolute; top: 72116px; left: 87px;"><nobr><b>Transition H2:H2: </b>Request Added</nobr></div>
<div style="position: absolute; top: 72147px; left: 87px;"><nobr>The host receives an I/O request. The host constructs CPB and PRD structures and may update the CPB </nobr></div>
<div style="position: absolute; top: 72164px; left: 87px;"><nobr>lookup table if necessary. Finally aGO is written as one to inform the ADMA that a request has been added to </nobr></div>
<div style="position: absolute; top: 72181px; left: 87px;"><nobr>the chain.</nobr></div>
<div style="position: absolute; top: 72211px; left: 87px;"><nobr><b>Transition H2:H2: </b>CPB Completed</nobr></div>
<div style="position: absolute; top: 72243px; left: 87px;"><nobr>The assertion of PCI interrupt and no error conditions exist in the ADMA Status register causes this transition. </nobr></div>
<div style="position: absolute; top: 72260px; left: 87px;"><nobr>The host examines the CPB chain to determine which CPB(s) have completed; the requester is informed of the </nobr></div>
<div style="position: absolute; top: 72277px; left: 87px;"><nobr>completion(s).</nobr></div>
<div style="position: absolute; top: 72308px; left: 87px;"><nobr><b>Transition H2:H1: </b>CPB Chain Processing to CPB Chain Inactive</nobr></div>
<div style="position: absolute; top: 72338px; left: 87px;"><nobr>When all requests have been completed and the CPB chain has no valid CPB’s the host shall transition to the </nobr></div>
<div style="position: absolute; top: 72355px; left: 87px;"><nobr>CPB Chain Inactive state</nobr></div>
<div style="position: absolute; top: 72387px; left: 87px;"><nobr><b>Transition H2:H4: </b>CPB Chain Processing to Timeout</nobr></div>
<div style="position: absolute; top: 72417px; left: 87px;"><nobr>A command timeout in the CPB list causes this transition.</nobr></div>
<div style="position: absolute; top: 72448px; left: 87px;"><nobr><b>Transition H2:H5: </b>Chain Processing to Error State</nobr></div>
<div style="position: absolute; top: 72479px; left: 87px;"><nobr>The assertion of PCI interrupt and aCPBERR being set to one transitions from the Processing to Error states.</nobr></div>
<div style="position: absolute; top: 72505px; left: 75px;"><nobr><b>7.8.5 H3: CPB Chain Full State</b></nobr></div>
<div style="position: absolute; top: 72535px; left: 87px;"><nobr><b>Transition H3:H2: </b>CPB Completed</nobr></div>
</span></font>

<div style="position: absolute; top: 72643px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="64"><b>Page 64</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 73782px; left: 681px;"><nobr>Page 50</nobr></div>
<div style="position: absolute; top: 72719px; left: 87px;"><nobr>The assertion of PCI interrupt and no error conditions exist in the ADMA Status register causes this transition. </nobr></div>
<div style="position: absolute; top: 72737px; left: 87px;"><nobr>The host examines the CPB chain to determine which CPB(s) have completed; the requester is informed of the </nobr></div>
<div style="position: absolute; top: 72754px; left: 87px;"><nobr>completion(s).</nobr></div>
<div style="position: absolute; top: 72784px; left: 87px;"><nobr><b>Transition H3:H3</b>: Request Rejected</nobr></div>
<div style="position: absolute; top: 72815px; left: 87px;"><nobr>The host may request the addition of an I/O request to the CPB chain. In this case the CPB chain is full and the </nobr></div>
<div style="position: absolute; top: 72832px; left: 87px;"><nobr>host rejects the request.</nobr></div>
<div style="position: absolute; top: 72863px; left: 87px;"><nobr><b>Transition H3:H4: </b>Timeout Occurred</nobr></div>
<div style="position: absolute; top: 72894px; left: 87px;"><nobr>A command timeout in the CPB list causes this transition.</nobr></div>
<div style="position: absolute; top: 72925px; left: 87px;"><nobr><b>Transition H3:H5: </b>Error Occurs</nobr></div>
<div style="position: absolute; top: 72955px; left: 87px;"><nobr>The assertion of PCI interrupt and aCPBERR being set to one transitions from the Chain Full to Error states.</nobr></div>
<div style="position: absolute; top: 72982px; left: 75px;"><nobr><b>7.8.6 H4: Timeout State</b></nobr></div>
<div style="position: absolute; top: 73012px; left: 87px;"><nobr>This state is entered when a timer causes an interrupt. The CPB chain is examined to determine which CPB(s) </nobr></div>
<div style="position: absolute; top: 73029px; left: 87px;"><nobr>has not been processed within a pre-determined time.</nobr></div>
<div style="position: absolute; top: 73056px; left: 87px;"><nobr><b>Transition H4:H3: </b>Retry</nobr></div>
<div style="position: absolute; top: 73087px; left: 87px;"><nobr>The host may determine that more time is needed for a CPB to complete. The timeout timer shall be reset and </nobr></div>
<div style="position: absolute; top: 73103px; left: 87px;"><nobr>the host returns to the CPB Chain Full State.</nobr></div>
<div style="position: absolute; top: 73135px; left: 87px;"><nobr><b>Transition H4:H2: </b>Retry</nobr></div>
<div style="position: absolute; top: 73165px; left: 87px;"><nobr>The host may determine that more time is needed for a CPB to complete. The timeout timer shall be reset and </nobr></div>
<div style="position: absolute; top: 73182px; left: 87px;"><nobr>the host returns to the CPB Chain Processing State.</nobr></div>
<div style="position: absolute; top: 73214px; left: 87px;"><nobr><b>Transition H4:H1: </b>Timeout to Inactive</nobr></div>
<div style="position: absolute; top: 73244px; left: 87px;"><nobr>The host may determine that it may need to reset or perform other diagnostic activities. To do this the it has to </nobr></div>
<div style="position: absolute; top: 73261px; left: 87px;"><nobr>return to the Register state. It would set aPSE to one and poll aPSD. If aPSD transitions to one the Inactive stae </nobr></div>
<div style="position: absolute; top: 73279px; left: 87px;"><nobr>is entered. If aPSD is not entered within a pre-determined period the ADMA is reset and Register state is </nobr></div>
<div style="position: absolute; top: 73296px; left: 87px;"><nobr>entered.</nobr></div>
<div style="position: absolute; top: 73322px; left: 75px;"><nobr><b>7.8.7 H5: Error State</b></nobr></div>
<div style="position: absolute; top: 73353px; left: 87px;"><nobr>This state is entered when PCI interrupt  is asserted and aCPBERR is set to one. The host may examine the </nobr></div>
<div style="position: absolute; top: 73370px; left: 87px;"><nobr>CPB chain to determine if any CPB’s have completed, at least one should indicate an error condition. Any </nobr></div>
<div style="position: absolute; top: 73387px; left: 87px;"><nobr>CPB’s that have completed but not finalized shall have their status notified to the requestor.</nobr></div>
<div style="position: absolute; top: 73413px; left: 87px;"><nobr><b>Transition H5:H0: </b>Error to Register State</nobr></div>
<div style="position: absolute; top: 73444px; left: 87px;"><nobr>The host shall write a zero to aGO transitioning to the Register state.</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 73476px; left: 65px;"><nobr><b>7.9 Resets</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 73502px; left: 75px;"><nobr><b>7.9.1 PCI Reset</b></nobr></div>
<div style="position: absolute; top: 73529px; left: 87px;"><nobr>PCI Reset resets the ADMA engine, and asserts the ATA RESET signal.</nobr></div>
<div style="position: absolute; top: 73551px; left: 75px;"><nobr><b>7.9.2 ADMA Reset (aRSTADM)</b></nobr></div>
<div style="position: absolute; top: 73578px; left: 87px;"><nobr>aRSTADM resets the ADMA engine but does not assert ATARESET; this is the same as power-on.  Asserting </nobr></div>
<div style="position: absolute; top: 73596px; left: 87px;"><nobr>aRSTADM sets ADMA engine reverts to the Legacy Idle State (see 7.7.2).  Registers and data transfers are in </nobr></div>
<div style="position: absolute; top: 73613px; left: 87px;"><nobr>an unknown state.  The host should reinitialize all ADMA register values (not PCI register values) for this </nobr></div>
<div style="position: absolute; top: 73630px; left: 87px;"><nobr>channel.  If the device(s) on the channel have commands outstanding the channel should then be reset and </nobr></div>
<div style="position: absolute; top: 73648px; left: 87px;"><nobr>reinitialized using aRSTA. Before resetting the ADMA engine using aRSTADM host software should attempt to </nobr></div>
<div style="position: absolute; top: 73665px; left: 87px;"><nobr>stop any outstanding transfers, see A.10.</nobr></div>
<div style="position: absolute; top: 73686px; left: 75px;"><nobr><b>7.9.3 ATA Channel Reset (aRSTA)</b></nobr></div>
<div style="position: absolute; top: 73714px; left: 87px;"><nobr>Setting aRSTA to one asserts the ATA reset signal, clearing aRSTA to zero de-asserts the ATA reset signal.  </nobr></div>
<div style="position: absolute; top: 73731px; left: 87px;"><nobr>The interval between the two should be at least the minimum specified in the relevant ATA standard.</nobr></div>
</span></font>

<div style="position: absolute; top: 73831px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="65"><b>Page 65</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 73885px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 74970px; left: 87px;"><nobr>Page 51</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 73914px; left: 87px;"><nobr><b>Annex AProgramming Guidelines (Informative)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 73939px; left: 87px;"><nobr><b>A.1 Introduction</b></nobr></div>
<div style="position: absolute; top: 73965px; left: 87px;"><nobr>This section is intended to review some aspects of programming in ADMA Mode that might not be immediately </nobr></div>
<div style="position: absolute; top: 73983px; left: 87px;"><nobr>obvious.  It makes the assumption that readers have familiarized themselves with the rest of the document.</nobr></div>
<div style="position: absolute; top: 74009px; left: 87px;"><nobr>In the past PC Compatible Legacy ATA Adapters have been accessed using specific I/O addresses (1Fxh, </nobr></div>
<div style="position: absolute; top: 74026px; left: 87px;"><nobr>17xh) and a specific set of IRQs (14, 15) where each ATA channel has a dedicated IRQ.  The ADMA adapter in </nobr></div>
<div style="position: absolute; top: 74044px; left: 87px;"><nobr>its ATA Register Mode uses a single interrupt for both channels.  Therefore, the host should not place the I/O </nobr></div>
<div style="position: absolute; top: 74061px; left: 87px;"><nobr>BARs at the Legacy I/O addresses as this may cause the host OS to confuse the ADMA adapter with an ATA </nobr></div>
<div style="position: absolute; top: 74078px; left: 87px;"><nobr>Legacy adapter.  This is why the ADMA uses a PCI sub-class code of 05h as opposed to 01h (see 7.4.1.6).</nobr></div>
<div style="position: absolute; top: 74100px; left: 87px;"><nobr><b>A.2 Programming the ADMA</b></nobr></div>
<div style="position: absolute; top: 74126px; left: 87px;"><nobr>The ADMA facilitates transfer of commands and data between the PCI bus and the ATA bus.  This is done by a </nobr></div>
<div style="position: absolute; top: 74143px; left: 87px;"><nobr>command chaining technique discussed in Section 7.2.  This command chain is dependant upon the ADMA </nobr></div>
<div style="position: absolute; top: 74161px; left: 87px;"><nobr>hardware, and data structures residing within host memory.  It is the responsibility of the host software to </nobr></div>
<div style="position: absolute; top: 74178px; left: 87px;"><nobr>allocate and initialize these structures before commencing data transfers via the ADMA.</nobr></div>
<div style="position: absolute; top: 74199px; left: 87px;"><nobr><b>A.2.1 PCI Configuration Header Registers</b></nobr></div>
<div style="position: absolute; top: 74223px; left: 87px;"><nobr>The PCI Configuration Header Registers, discussed in Section 7.4.1, are initialized by the host OS or BIOS at </nobr></div>
<div style="position: absolute; top: 74240px; left: 87px;"><nobr>system boot.  The ADMA Registers, discussed in Section 7.4.1.20.1, for both channels X and Y are addressed </nobr></div>
<div style="position: absolute; top: 74258px; left: 87px;"><nobr>through BAR 4 in the PCI configuration header registers.  The host software is not responsible for initializing the </nobr></div>
<div style="position: absolute; top: 74275px; left: 87px;"><nobr>PCI Configuration Header Registers.</nobr></div>
<div style="position: absolute; top: 74296px; left: 87px;"><nobr><b>A.2.2 CPB Chain</b></nobr></div>
<div style="position: absolute; top: 74320px; left: 87px;"><nobr>The CPB chain, discussed in Section 7.6.1, may be constructed as a circular linked-list of CPB structures.  A </nobr></div>
<div style="position: absolute; top: 74336px; left: 87px;"><nobr>CPB chain is constructed of one or more CPBs.  The CPB chain should be allocated and initialized by the host </nobr></div>
<div style="position: absolute; top: 74354px; left: 87px;"><nobr>software before entering ADMA Mode.</nobr></div>
<div style="position: absolute; top: 74377px; left: 87px;"><nobr>The ADMA CPB Next Address Register should be initialized with a pointer to a CPB in the chain.</nobr></div>
<div style="position: absolute; top: 74401px; left: 87px;"><nobr>ATA register fields are used by the ADMA to write to the ATA device’s Command and Control Registers.  The </nobr></div>
<div style="position: absolute; top: 74417px; left: 87px;"><nobr>Wait-Not-Busy (WNB) Bit set to one instructs the ADMA to read the ATA device’s Status Register, and wait until </nobr></div>
<div style="position: absolute; top: 74435px; left: 87px;"><nobr>the device is not busy before writing the ATA register.  WNB should be set to one on the first register write for </nobr></div>
<div style="position: absolute; top: 74452px; left: 87px;"><nobr>each ATA command, as the ADMA may not wait for the device to become not busy before writing the ATA </nobr></div>
<div style="position: absolute; top: 74469px; left: 87px;"><nobr>register.  If there are fewer than four valid entries in an ATA register field, the IGN Bit is used to indicate entries </nobr></div>
<div style="position: absolute; top: 74487px; left: 87px;"><nobr>to be ignored.  Note that IGN should not be set to one if END is set to one (see 7.6.1.6).</nobr></div>
<div style="position: absolute; top: 74510px; left: 87px;"><nobr>A CPB structure may contain a variable number of ATA register writes (see 7.6.1.6).  This number may be fixed, </nobr></div>
<div style="position: absolute; top: 74528px; left: 87px;"><nobr>or may vary dynamically from CPB to CPB.  A CPB contains up to one data transfer command.</nobr></div>
<div style="position: absolute; top: 74549px; left: 87px;"><nobr><b>A.2.3 APRD Chains</b></nobr></div>
<div style="position: absolute; top: 74572px; left: 87px;"><nobr>A APRD chain, discussed in Section 7.6.1.7, is a linked-list of APRD structures.  An APRD chain is constructed </nobr></div>
<div style="position: absolute; top: 74590px; left: 87px;"><nobr>of one or more APRDs.  Each CPB containing an ATA data transfer command or packet command points to a </nobr></div>
<div style="position: absolute; top: 74606px; left: 87px;"><nobr>valid APRD chain.  An ATA command that does not involve the transfer of data does not require an APRD.</nobr></div>
<div style="position: absolute; top: 74630px; left: 87px;"><nobr>APRD chains may be allocated before entering ADMA Mode or at run time.  The host software is responsible for </nobr></div>
<div style="position: absolute; top: 74647px; left: 87px;"><nobr>allocating and initializing one APRD chain for each CPB transferring data in the CPB chain before making the </nobr></div>
<div style="position: absolute; top: 74665px; left: 87px;"><nobr>CPB valid.</nobr></div>
<div style="position: absolute; top: 74687px; left: 87px;"><nobr>It is very important to ensure that the method, direction, and length of the transfer as indicated in the APRDs are </nobr></div>
<div style="position: absolute; top: 74705px; left: 87px;"><nobr>consistent with the ATA command within the CPB.  If this consistency is not maintained, the system may hang.</nobr></div>
<div style="position: absolute; top: 74727px; left: 87px;"><nobr><b>A.2.4 CPB Lookup Table</b></nobr></div>
<div style="position: absolute; top: 74749px; left: 87px;"><nobr>If overlapped or queued commands are to be used, the host software is responsible for allocating and initializing </nobr></div>
<div style="position: absolute; top: 74767px; left: 87px;"><nobr>a CPB Lookup Table, discussed in Section 7.6.2.  The CPB Lookup Table should be allocated and initialized </nobr></div>
<div style="position: absolute; top: 74784px; left: 87px;"><nobr>before entering ADMA Mode.  Each entry should be a Qword, with the low-order Dword containing the physical </nobr></div>
<div style="position: absolute; top: 74802px; left: 87px;"><nobr>address a CPB, and the high-order Dword cleared to zero.</nobr></div>
<div style="position: absolute; top: 74825px; left: 87px;"><nobr>The ADMA CPB Lookup Address Register should be initialized with a pointer to the CPB Lookup Table.</nobr></div>
<div style="position: absolute; top: 74848px; left: 87px;"><nobr>This table should be updated before restarting the ADMA if the host modifies CPB the chain (see A.9).</nobr></div>
<div style="position: absolute; top: 74870px; left: 87px;"><nobr><b>A.3 Asynchronous Operation</b></nobr></div>
<div style="position: absolute; top: 74897px; left: 87px;"><nobr>The ADMA operates asynchronously from the host.  This means that the ADMA may process more than one </nobr></div>
<div style="position: absolute; top: 74914px; left: 87px;"><nobr>command in between the host being able to service interrupts, or even as the host is servicing one.  When </nobr></div>
<div style="position: absolute; top: 74930px; left: 87px;"><nobr>servicing an interrupt, the host software should search the entire CPB chain to determine if more than one CPB </nobr></div>
<div style="position: absolute; top: 74948px; left: 87px;"><nobr>has been completed (with or without errors).</nobr></div>
</span></font>

<div style="position: absolute; top: 75019px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="66"><b>Page 66</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 76158px; left: 681px;"><nobr>Page 52</nobr></div>
<div style="position: absolute; top: 75095px; left: 87px;"><nobr>The host should be aware that any updates it may make to shared host memory (see Figure 2), including the </nobr></div>
<div style="position: absolute; top: 75113px; left: 87px;"><nobr>CPBs, APRDs, CPB Lookup Table, data buffer areas, and also the ADMA registers “CPB Next Address </nobr></div>
<div style="position: absolute; top: 75130px; left: 87px;"><nobr>Register”, and “CPB Lookup Table Address Register” must be undertaken such that they will not be accessed </nobr></div>
<div style="position: absolute; top: 75146px; left: 87px;"><nobr>by the ADMA at the same time (see A.9).</nobr></div>
<div style="position: absolute; top: 75169px; left: 87px;"><nobr><b>A.4 Memory Alignment</b></nobr></div>
<div style="position: absolute; top: 75195px; left: 87px;"><nobr>The ADMA engine may be designed to use Quad Word alignment.  Any transfer requests that the ADMA  </nobr></div>
<div style="position: absolute; top: 75212px; left: 87px;"><nobr>engine receives from the host should be aligned to a Quad Word boundary.  This may mean that the host </nobr></div>
<div style="position: absolute; top: 75230px; left: 87px;"><nobr>software has to copy the data to/from an internal Quad word aligned buffer before/after the ADMA transfer.</nobr></div>
<div style="position: absolute; top: 75251px; left: 87px;"><nobr><b>A.5 Register Usage</b></nobr></div>
<div style="position: absolute; top: 75277px; left: 87px;"><nobr>The ADMA provides a set of I/O and memory mapped registers.  The I/O mapped registers provide support for </nobr></div>
<div style="position: absolute; top: 75295px; left: 87px;"><nobr>ATA Register Mode operation only, and are intended for use during the initial boot process.  The memory </nobr></div>
<div style="position: absolute; top: 75312px; left: 87px;"><nobr>mapped registers provide a shadow of the I/O registers, as well as the registers needed to control ADMA </nobr></div>
<div style="position: absolute; top: 75329px; left: 87px;"><nobr>operation.  Host software writers are encouraged to use the memory mapped registers, as the I/O mapped </nobr></div>
<div style="position: absolute; top: 75347px; left: 87px;"><nobr>registers may be made obsolete in future versions of the ADMA.</nobr></div>
<div style="position: absolute; top: 75364px; left: 87px;"><nobr>ATA Register Mode</nobr></div>
<div style="position: absolute; top: 75389px; left: 87px;"><nobr>The ADMA defaults to ATA Register Mode at power up, system reset, and upon detecting an error.  In ATA </nobr></div>
<div style="position: absolute; top: 75407px; left: 87px;"><nobr>Register Mode the ADMA is acting as an address decoder and ATA bus timing device only.  The host reads and </nobr></div>
<div style="position: absolute; top: 75424px; left: 87px;"><nobr>writes an ATA device just as it would on a legacy ISA bus adapter.  The I/O mapped registers are initialized by </nobr></div>
<div style="position: absolute; top: 75441px; left: 87px;"><nobr>the host OS or BIOS, and usually will not be the legacy 1Fxh/3Fxh values.  The ADMA does not provide </nobr></div>
<div style="position: absolute; top: 75459px; left: 87px;"><nobr>separate interrupts for each channel, and thus host software in ATA Register Mode should use the PCI shared </nobr></div>
<div style="position: absolute; top: 75476px; left: 87px;"><nobr>interrupt architecture.  </nobr></div>
<div style="position: absolute; top: 75497px; left: 87px;"><nobr><b>A.6 Use of aGO</b></nobr></div>
<div style="position: absolute; top: 75524px; left: 87px;"><nobr>Writing a one to aGO can be thought of as a “door bell”.  The intent is to signal to the ADMA that the host has </nobr></div>
<div style="position: absolute; top: 75541px; left: 87px;"><nobr>changed something in the CPB chain, or in ADMCTL.  It does not matter that the value of aGO is already one, it </nobr></div>
<div style="position: absolute; top: 75558px; left: 87px;"><nobr>is the act of writing a one into aGO in ADMCTL that provides this indication to the ADMA.</nobr></div>
<div style="position: absolute; top: 75581px; left: 87px;"><nobr><b>A.7 Execute Single CPB</b></nobr></div>
<div style="position: absolute; top: 75607px; left: 87px;"><nobr>In a development environment, it is often useful to “single-step” through a CPB chain.  This is achieved by </nobr></div>
<div style="position: absolute; top: 75623px; left: 87px;"><nobr>setting aPSE to one and writing aGO as one for each CPB to be executed.</nobr></div>
<div style="position: absolute; top: 75649px; left: 87px;"><nobr>NOTE - if a service interrupt is pending, the CPB that is executed may not be the next one in the chain.</nobr></div>
<div style="position: absolute; top: 75672px; left: 87px;"><nobr><b>A.8 Determining the Current Status of the ADMA</b></nobr></div>
<div style="position: absolute; top: 75698px; left: 87px;"><nobr>The host determines the status of the ADMA by examining ADMSTAT.  </nobr></div>
<div style="position: absolute; top: 75724px; left: 91px;"><nobr>shows the expected outputs from the status register dependent on the ADMA’s current state.  It should be </nobr></div>
<div style="position: absolute; top: 75742px; left: 87px;"><nobr>noted that when the ADMA is in the ADMA Idle State, there might be outstanding Released CPBs.  This means </nobr></div>
<div style="position: absolute; top: 75758px; left: 87px;"><nobr>that the state of the ADMA may change without any action by the host.</nobr></div>
<div style="position: absolute; top: 75780px; left: 87px;"><nobr><b>A.9 Host Pausing of the ADMA Engine</b></nobr></div>
<div style="position: absolute; top: 75807px; left: 87px;"><nobr>The host may pause ADMA processing of an active chain, at any time, by setting aPSE to one.  Upon </nobr></div>
<div style="position: absolute; top: 75824px; left: 87px;"><nobr>completion of the current CPB, the ADMA sets aDONE to one, cDONE to one, transitions to the Paused State, </nobr></div>
<div style="position: absolute; top: 75841px; left: 87px;"><nobr>and may assert the PCI Interrupt signal.  If the ADMA is releasing a CPB it sets cREL to one and transitions to </nobr></div>
<div style="position: absolute; top: 75859px; left: 87px;"><nobr>the Paused State without asserting the PCI Interrupt signal.</nobr></div>
<div style="position: absolute; top: 75884px; left: 87px;"><nobr>The host may determine when the ADMA has transitioned into the Paused State by checking aPSD set to one.</nobr></div>
<div style="position: absolute; top: 75910px; left: 87px;"><nobr>The host may determine which CPB was just completed by reading the ADMA Current CPB Address register </nobr></div>
<div style="position: absolute; top: 75928px; left: 87px;"><nobr>(CCPB).  The host may then modify any of the non-Released CPB entries in the chain.  The host should take </nobr></div>
<div style="position: absolute; top: 75945px; left: 87px;"><nobr>care to ensure that any CPBs that are in the Released State are not invalidated by changes made to the chain </nobr></div>
<div style="position: absolute; top: 75962px; left: 87px;"><nobr>or to the CPB Lookup Table.</nobr></div>
<div style="position: absolute; top: 75989px; left: 87px;"><nobr>By leaving aPSE set to one, the host may execute the next valid CPB by writing a one to aGO.  See A.7.  The </nobr></div>
<div style="position: absolute; top: 76006px; left: 87px;"><nobr>host may continue completion of all valid CPBs in the chain by clearing aPSE and writing a one to aGO.</nobr></div>
<div style="position: absolute; top: 76027px; left: 87px;"><nobr><b>A.10 Host Stopping or Terminating an Active CPB</b></nobr></div>
<div style="position: absolute; top: 76054px; left: 87px;"><nobr>The host may force the ADMA into ATA Register Mode by clearing aGO regardless of the current state of the </nobr></div>
<div style="position: absolute; top: 76071px; left: 87px;"><nobr>ADMA engine.  This action immediately stops the processing of the CPB chain.  If a CPB is being processed, </nobr></div>
<div style="position: absolute; top: 76088px; left: 87px;"><nobr>the results will be indeterminate, and the state of the ATA device will be unknown.  By pausing the ADMA first, </nobr></div>
<div style="position: absolute; top: 76106px; left: 87px;"><nobr>the host may make an orderly transition to ATA Register Mode.  The host may then examine the CPB chain to </nobr></div>
</span></font>

<div style="position: absolute; top: 76207px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="67"><b>Page 67</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 76261px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 77346px; left: 87px;"><nobr>Page 53</nobr></div>
<div style="position: absolute; top: 76283px; left: 87px;"><nobr>determine if any Released CPBs exist, and if so, take appropriate action.  The host should issue an ATA </nobr></div>
<div style="position: absolute; top: 76301px; left: 87px;"><nobr>channel reset to bring the device(s) on the stopped channel to a known condition.</nobr></div>
<div style="position: absolute; top: 76322px; left: 87px;"><nobr><b>A.11 ADMA Interrupts</b></nobr></div>
<div style="position: absolute; top: 76348px; left: 87px;"><nobr>The host may determine if the ADMA caused an interrupt by examining ADMSTAT.  An interrupt has occurred </nobr></div>
<div style="position: absolute; top: 76366px; left: 87px;"><nobr>when aDONE and/or an error bit (aUIRQ, aCPBERR, aPERR) is set to one.  Reading ADMSTAT clears all error </nobr></div>
<div style="position: absolute; top: 76383px; left: 87px;"><nobr>bits and aDONE to zero and de-asserts the pending interrupt.</nobr></div>
<div style="position: absolute; top: 76404px; left: 87px;"><nobr><b>A.12 Chain Management</b></nobr></div>
<div style="position: absolute; top: 76431px; left: 87px;"><nobr>The host should ensure that there is a correctly initialized CPB chain, and if overlapped/queued operations are </nobr></div>
<div style="position: absolute; top: 76448px; left: 87px;"><nobr>required a correctly initialized CPB Lookup Table, before entering ADMA Mode.  A valid CPB chain should </nobr></div>
<div style="position: absolute; top: 76465px; left: 87px;"><nobr>consist of one or more CPB structures with the Next CPB fields pointing to the physical host memory address of </nobr></div>
<div style="position: absolute; top: 76483px; left: 87px;"><nobr>the next CPB in the chain (the Next CPB field in a chain of one CPB would point to itself).  cDONE should be set </nobr></div>
<div style="position: absolute; top: 76500px; left: 87px;"><nobr>to one and cREL should be cleared to zero in each CPB.  The host should write the address of the first CPB into </nobr></div>
<div style="position: absolute; top: 76517px; left: 87px;"><nobr>the ADMA Next CPB Address register, and the start of the contiguous CPB Lookup Table into the ADMA </nobr></div>
<div style="position: absolute; top: 76535px; left: 87px;"><nobr>Lookup Table Address register.</nobr></div>
<div style="position: absolute; top: 76561px; left: 87px;"><nobr>When a CPB is ready to be processed, the host should ensure that the cREL Bit is cleared and cVLD is set to </nobr></div>
<div style="position: absolute; top: 76577px; left: 87px;"><nobr>one before clearing cDONE to zero.  Once cDONE is cleared to zero the ADMA is in control of the CPB.  The </nobr></div>
<div style="position: absolute; top: 76595px; left: 87px;"><nobr>host should not modify any CPB with cDONE cleared to zero unless the ADMA is in the Legacy Idle or Paused </nobr></div>
<div style="position: absolute; top: 76612px; left: 87px;"><nobr>State.  If the ADMA is in the ADMA Idle State, the host should check any CPB before modification to ensure that </nobr></div>
<div style="position: absolute; top: 76629px; left: 87px;"><nobr>cREL has not been set to one.  Such a CPB is in the “Released” State, and should not be manipulated by the </nobr></div>
<div style="position: absolute; top: 76647px; left: 87px;"><nobr>host until cDONE has been set to one by the ADMA (see 7.6.3).</nobr></div>
<div style="position: absolute; top: 76673px; left: 87px;"><nobr>While cDONE is equal to zero, the host may attempt to stop a CPB from being processed by clearing cVLD to </nobr></div>
<div style="position: absolute; top: 76690px; left: 87px;"><nobr>zero.  The host should then wait to ensure that cDONE has been set to one before modifying the CPB.  If a CPB </nobr></div>
<div style="position: absolute; top: 76708px; left: 87px;"><nobr>is being processed when cVLD is cleared to zero, the CPB will continue to be processed to completion by the </nobr></div>
<div style="position: absolute; top: 76725px; left: 87px;"><nobr>ADMA, and cIGNRD will not be set (see 7.6.1.1.3).</nobr></div>
<div style="position: absolute; top: 76746px; left: 87px;"><nobr><b>A.13 Error Handling</b></nobr></div>
<div style="position: absolute; top: 76773px; left: 87px;"><nobr>If the ADMA detects that the ATA Error Bit has been set the ADMA sets the appropriate error bits in the CPB </nobr></div>
<div style="position: absolute; top: 76790px; left: 87px;"><nobr>and ADMSTAT, transitions to ATA Register Mode, and asserts an interrupt.</nobr></div>
<div style="position: absolute; top: 76816px; left: 87px;"><nobr>If the ADMA detects a PCI error, it is an indication of a severe system problem.  Any transfers across the PCI </nobr></div>
<div style="position: absolute; top: 76833px; left: 87px;"><nobr>bus are now suspect and may result in catastrophic failure.  The ADMA ceases all ATA operations, sets aPERR </nobr></div>
<div style="position: absolute; top: 76851px; left: 87px;"><nobr>in ADMSTAT to one, transitions to ATA Register Mode, and asserts the PCI Interrupt signal.  The ADMA does </nobr></div>
<div style="position: absolute; top: 76868px; left: 87px;"><nobr>not attempt to update the CPB, as this would involve a complete master mode operation on the suspect PCI </nobr></div>
<div style="position: absolute; top: 76885px; left: 87px;"><nobr>bus.  The host software should take whatever actions it can to determine the state of the bus before attempting </nobr></div>
<div style="position: absolute; top: 76903px; left: 87px;"><nobr>any more accesses to the ADMA.</nobr></div>
<div style="position: absolute; top: 76928px; left: 87px;"><nobr>Other errors indicate some kind of CPB inconsistency.  Data Insufficiency, Excess, and CPB error (bits </nobr></div>
<div style="position: absolute; top: 76945px; left: 87px;"><nobr>cPSDEF, cPSEXC, cCPBERR in the CPB Response Byte, see 7.7.4) usually mean that the CPB and APRD </nobr></div>
<div style="position: absolute; top: 76963px; left: 87px;"><nobr>were not correctly constructed, or that there has been some type of data transfer error. The one exception is </nobr></div>
<div style="position: absolute; top: 76980px; left: 87px;"><nobr>data excess during a Packet data transfer.  In some cases the transfer size is not known or is not an exact </nobr></div>
<div style="position: absolute; top: 76997px; left: 87px;"><nobr>Qword in length.  In such cases the APRD data transfer length should be rounded up to the nearest Qword and </nobr></div>
<div style="position: absolute; top: 77015px; left: 87px;"><nobr>pIGEX in the APRD set to one.  In this way, the ADMA does not stop on error (see 7.7.4.5.).</nobr></div>
<div style="position: absolute; top: 77036px; left: 87px;"><nobr><b>A.14 ATAPI Data Transfers</b></nobr></div>
<div style="position: absolute; top: 77062px; left: 87px;"><nobr>All ATAPI APRD chains associated with a data transfer should contain at least two APRDs.  The first APRD </nobr></div>
<div style="position: absolute; top: 77080px; left: 87px;"><nobr>points to the packet data and should have pDIRO set to one to indicate output to the ATA device, and pORD </nobr></div>
<div style="position: absolute; top: 77097px; left: 87px;"><nobr>cleared to zero to indicate use of the PIO protocol.  The subsequent APRDs should indicate the direction and </nobr></div>
<div style="position: absolute; top: 77114px; left: 87px;"><nobr>transfer mode for the associated data (see 7.6.1.7).</nobr></div>
<div style="position: absolute; top: 77137px; left: 87px;"><nobr><b>A.15 Queued Operation</b></nobr></div>
<div style="position: absolute; top: 77162px; left: 87px;"><nobr>For channels supporting two overlapped/queued devices the Auto-Poll Enable (aAUTEN) bit should be set to </nobr></div>
<div style="position: absolute; top: 77179px; left: 87px;"><nobr>one.  This causes the ADMA to alternately select each device when the ATA bus has been released, so that </nobr></div>
<div style="position: absolute; top: 77197px; left: 87px;"><nobr>either device that requires service has an opportunity to assert an interrupt.</nobr></div>
<div style="position: absolute; top: 77223px; left: 87px;"><nobr>The ATA Standard suggests that nIEN be toggled during the queued protocol.  This should not be done.  See </nobr></div>
<div style="position: absolute; top: 77240px; left: 87px;"><nobr>7.2.6.</nobr></div>
<div style="position: absolute; top: 77267px; left: 87px;"><nobr>During queued operation, an ATA error will abort the internal command queue in the ATA device.  All Released </nobr></div>
<div style="position: absolute; top: 77284px; left: 87px;"><nobr>CPBs for that device will need to be reissued. The host software should search the CPB chain and clear any </nobr></div>
<div style="position: absolute; top: 77301px; left: 87px;"><nobr>cREL bits it finds set to one and then write aGO as one. </nobr></div>
</span></font>

<div style="position: absolute; top: 77395px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="68"><b>Page 68</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 78534px; left: 681px;"><nobr>Page 54</nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 14px; font-family: Times;">
<div style="position: absolute; top: 77478px; left: 87px;"><nobr><b>Annex B PCI Compatibility and PCI-Native Mode Bus Master Adapter Configuration</b></nobr></div>
<div style="position: absolute; top: 77497px; left: 129px;"><nobr><b>(Informative)</b></nobr></div>
</span></font>
<font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 77522px; left: 87px;"><nobr><b>B.1 Introduction</b></nobr></div>
<div style="position: absolute; top: 77539px; left: 87px;"><nobr>The ATA adapters described in section 6 require configuration information to allow proper operation. Such </nobr></div>
<div style="position: absolute; top: 77557px; left: 87px;"><nobr>parameters as ATA timing values and operational options have to be set. There are a number of variations as to </nobr></div>
<div style="position: absolute; top: 77574px; left: 87px;"><nobr>how these parameters are set this annex sets out one method of setting these variables. Future revisions of this </nobr></div>
<div style="position: absolute; top: 77591px; left: 87px;"><nobr>standard may contain other methods.</nobr></div>
<div style="position: absolute; top: 77614px; left: 87px;"><nobr><b>B.2 ATA Controller PCI Configuration Registers</b></nobr></div>
<div style="position: absolute; top: 77630px; left: 87px;"><nobr>This section will list out the entire supported PCI configuration space registers and “Bus Master I/O” registers, </nobr></div>
<div style="position: absolute; top: 77647px; left: 87px;"><nobr>with details of individual bit definitions and their respective programming being left to the Register Programming </nobr></div>
<div style="position: absolute; top: 77665px; left: 87px;"><nobr>Specifics section that follows.</nobr></div>
<div style="position: absolute; top: 77687px; left: 87px;"><nobr><b>B.2.1 ATA Controller PCI Configuration Registers</b></nobr></div>
<div style="position: absolute; top: 77713px; left: 87px;"><nobr>The configuration registers used in this method of configuration uses the PCI configuration space starting at </nobr></div>
<div style="position: absolute; top: 77731px; left: 87px;"><nobr>offset 40h of the PCI configuration space, see Table 25.</nobr></div>
<div style="position: absolute; top: 77774px; left: 322px;"><nobr><b>Table 25 – PCI Configuration Registers</b></nobr></div>
<div style="position: absolute; top: 77808px; left: 114px;"><nobr>Offset</nobr></div>
<div style="position: absolute; top: 77808px; left: 182px;"><nobr>Register Name/Function</nobr></div>
<div style="position: absolute; top: 77808px; left: 621px;"><nobr>Register Type</nobr></div>
<div style="position: absolute; top: 77839px; left: 114px;"><nobr>40-41</nobr></div>
<div style="position: absolute; top: 77839px; left: 182px;"><nobr>ATA TIMING (Primary)</nobr></div>
<div style="position: absolute; top: 77839px; left: 621px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 77866px; left: 114px;"><nobr>42-43</nobr></div>
<div style="position: absolute; top: 77866px; left: 182px;"><nobr>ATA TIMING (Secondary)</nobr></div>
<div style="position: absolute; top: 77866px; left: 621px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 77893px; left: 114px;"><nobr>44</nobr></div>
<div style="position: absolute; top: 77893px; left: 182px;"><nobr>Device 1 ATA Timing (Primary and Secondary)</nobr></div>
<div style="position: absolute; top: 77893px; left: 621px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 77921px; left: 114px;"><nobr>45:47</nobr></div>
<div style="position: absolute; top: 77921px; left: 182px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 77921px; left: 621px;"><nobr>RO</nobr></div>
<div style="position: absolute; top: 77948px; left: 114px;"><nobr>48</nobr></div>
<div style="position: absolute; top: 77948px; left: 182px;"><nobr>Ultra DMA Control Register</nobr></div>
<div style="position: absolute; top: 77948px; left: 621px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 77975px; left: 114px;"><nobr>49</nobr></div>
<div style="position: absolute; top: 77975px; left: 182px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 77975px; left: 621px;"><nobr>RO</nobr></div>
<div style="position: absolute; top: 78003px; left: 114px;"><nobr>4A:4B</nobr></div>
<div style="position: absolute; top: 78003px; left: 182px;"><nobr>Ultra DMA Timing Register</nobr></div>
<div style="position: absolute; top: 78003px; left: 621px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 78030px; left: 114px;"><nobr>4C-53</nobr></div>
<div style="position: absolute; top: 78030px; left: 182px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 78030px; left: 621px;"><nobr>RO</nobr></div>
<div style="position: absolute; top: 78057px; left: 114px;"><nobr>54:55</nobr></div>
<div style="position: absolute; top: 78057px; left: 182px;"><nobr>IDE I/O Configuration</nobr></div>
<div style="position: absolute; top: 78057px; left: 621px;"><nobr>R/W</nobr></div>
<div style="position: absolute; top: 78085px; left: 114px;"><nobr>56-F7</nobr></div>
<div style="position: absolute; top: 78085px; left: 182px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 78085px; left: 621px;"><nobr>RO</nobr></div>
<div style="position: absolute; top: 78112px; left: 114px;"><nobr>F8-FB</nobr></div>
<div style="position: absolute; top: 78112px; left: 182px;"><nobr>Manufacture's ID</nobr></div>
<div style="position: absolute; top: 78112px; left: 621px;"><nobr>RO</nobr></div>
<div style="position: absolute; top: 78139px; left: 114px;"><nobr>FC-FF</nobr></div>
<div style="position: absolute; top: 78139px; left: 182px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 78139px; left: 621px;"><nobr>RO</nobr></div>
<div style="position: absolute; top: 78186px; left: 87px;"><nobr><b>B.3 ATA PIO and DMA Mode Timing and Control Registers</b></nobr></div>
<div style="position: absolute; top: 78212px; left: 87px;"><nobr>The following register bit layout maps define the specific ATA controller device timing and mode configuration registers.  </nobr></div>
<div style="position: absolute; top: 78230px; left: 87px;"><nobr>These registers control PIO timings as well as Single and Multi-Word DMA timings for device 0 on the primary and </nobr></div>
<div style="position: absolute; top: 78247px; left: 87px;"><nobr>secondary controllers.</nobr></div>
<div style="position: absolute; top: 78268px; left: 87px;"><nobr><b>B.3.1 IDETIMx — ATA Timing Register</b></nobr></div>
<div style="position: absolute; top: 78295px; left: 87px;"><nobr>Address Offset: ATATIM1, Primary Channel—PCI Config. Offset 40-41h </nobr></div>
<div style="position: absolute; top: 78321px; left: 87px;"><nobr>ATATIM2, Secondary Channel—PCI Config. Offset 42-43h</nobr></div>
<div style="position: absolute; top: 78347px; left: 87px;"><nobr>Default Value: 00h</nobr></div>
<div style="position: absolute; top: 78374px; left: 87px;"><nobr>Attribute: Read/Write</nobr></div>
<div style="position: absolute; top: 78400px; left: 87px;"><nobr>This register controls timing and enable of the PIO and DMA enables/disables bus master capability for the ATA </nobr></div>
<div style="position: absolute; top: 78417px; left: 87px;"><nobr>function and provides direction control for the ATA DMA transfers. This register also provides bits that software </nobr></div>
<div style="position: absolute; top: 78435px; left: 87px;"><nobr>uses to indicate DMA capability of the ATA device, see Table 26.</nobr></div>
</span></font>

<div style="position: absolute; top: 78583px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="69"><b>Page 69</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 78637px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 79722px; left: 87px;"><nobr>Page 55</nobr></div>
<div style="position: absolute; top: 78659px; left: 347px;"><nobr><b>Table 26 – ATA Timing Register</b></nobr></div>
<div style="position: absolute; top: 78710px; left: 136px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 78710px; left: 458px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 78740px; left: 137px;"><nobr>15</nobr></div>
<div style="position: absolute; top: 78740px; left: 195px;"><nobr>ATA Decode Enable (R/W).  This bit enables (when set to 1) or disables (when cleared to </nobr></div>
<div style="position: absolute; top: 78758px; left: 195px;"><nobr>0) decoding of the I/O addressing ranges assigned to this controller.</nobr></div>
<div style="position: absolute; top: 78785px; left: 137px;"><nobr>14</nobr></div>
<div style="position: absolute; top: 78785px; left: 195px;"><nobr>Device 1 ATA Timing Register Enable (R/W).  This bit enables (when set to 1) or disables </nobr></div>
<div style="position: absolute; top: 78802px; left: 195px;"><nobr>(when cleared to 0) the Device 1 ATA Timing Register.</nobr></div>
<div style="position: absolute; top: 78830px; left: 127px;"><nobr>13:12</nobr></div>
<div style="position: absolute; top: 78830px; left: 195px;"><nobr>IORDY Sample Mode (R/W). Sets the setup time before IORDY is sampled.  The bit </nobr></div>
<div style="position: absolute; top: 78847px; left: 195px;"><nobr>mappings are:</nobr></div>
<div style="position: absolute; top: 78872px; left: 276px;"><nobr>00: PIO-0</nobr></div>
<div style="position: absolute; top: 78899px; left: 276px;"><nobr>01: PIO-2, SW-2</nobr></div>
<div style="position: absolute; top: 78925px; left: 276px;"><nobr>10: PIO-3, PIO-4, MW-1, MW-2</nobr></div>
<div style="position: absolute; top: 78951px; left: 276px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 78979px; left: 127px;"><nobr>11:10</nobr></div>
<div style="position: absolute; top: 78979px; left: 195px;"><nobr>Reserved.</nobr></div>
<div style="position: absolute; top: 79006px; left: 135px;"><nobr>9:8</nobr></div>
<div style="position: absolute; top: 79006px; left: 195px;"><nobr>Recovery Mode (R/W). Sets the hold time after IORDY is sampled.   The bit mappings </nobr></div>
<div style="position: absolute; top: 79023px; left: 195px;"><nobr>are:</nobr></div>
<div style="position: absolute; top: 79050px; left: 276px;"><nobr>00: PIO-0, PIO-2, SW-2</nobr></div>
<div style="position: absolute; top: 79076px; left: 276px;"><nobr>01: PIO-3, MW-1</nobr></div>
<div style="position: absolute; top: 79102px; left: 276px;"><nobr>10: Reserved</nobr></div>
<div style="position: absolute; top: 79129px; left: 276px;"><nobr>11: PIO-4, MW-2</nobr></div>
<div style="position: absolute; top: 79156px; left: 142px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 79156px; left: 195px;"><nobr>DMA Timing Enable Only Select 1.  This bit enables (when set to 1) or disables (when </nobr></div>
<div style="position: absolute; top: 79173px; left: 195px;"><nobr>cleared to 0) the device timings for DMA operation for device 1.</nobr></div>
<div style="position: absolute; top: 79201px; left: 142px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 79201px; left: 195px;"><nobr>ATA/ATAPI Device Indicator 1.  This bit indicates presence of an ATA device (when set to </nobr></div>
<div style="position: absolute; top: 79218px; left: 195px;"><nobr>1) or presence of an ATAPI device (when cleared to 0) for device 1.</nobr></div>
<div style="position: absolute; top: 79245px; left: 142px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 79245px; left: 195px;"><nobr>IORDY Sample Point Enabled Select 1.  This bit enables (when set to 1) or disables </nobr></div>
<div style="position: absolute; top: 79263px; left: 195px;"><nobr>(when cleared to 0) the IORDY sample point capabilities for PIO transfers for device 1.  </nobr></div>
<div style="position: absolute; top: 79280px; left: 195px;"><nobr>IORDY is always enabled for PIO4 and PIO3, and when a PIO2 device indicates IORDY </nobr></div>
<div style="position: absolute; top: 79297px; left: 195px;"><nobr>capabilities. </nobr></div>
<div style="position: absolute; top: 79324px; left: 142px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 79324px; left: 195px;"><nobr>Fast Drive Timing Select 1.  This bit enables (when set to 1) or disables (when cleared to </nobr></div>
<div style="position: absolute; top: 79342px; left: 195px;"><nobr>0) the Fast Drive Timing capabilities for PIO transfers, which enables faster than PIO-0 </nobr></div>
<div style="position: absolute; top: 79358px; left: 195px;"><nobr>timing modes for device 1.</nobr></div>
<div style="position: absolute; top: 79385px; left: 142px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 79385px; left: 195px;"><nobr>DMA Timing Enable Only Select 0.  This bit enables (when set to 1) or disables (when </nobr></div>
<div style="position: absolute; top: 79403px; left: 195px;"><nobr>cleared to 0) the device timings for DMA operation for device 0.</nobr></div>
<div style="position: absolute; top: 79430px; left: 142px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 79430px; left: 195px;"><nobr>ATA/ATAPI Device Indicator 0.  This bit indicates presence of an ATA device (when set to </nobr></div>
<div style="position: absolute; top: 79447px; left: 195px;"><nobr>1) or presence of an ATAPI device (when cleared to 0) for device 0.</nobr></div>
<div style="position: absolute; top: 79475px; left: 142px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 79475px; left: 195px;"><nobr>IORDY Sample Point Enabled Select 0.  This bit enables (when set to 1) or disables </nobr></div>
<div style="position: absolute; top: 79492px; left: 195px;"><nobr>(when cleared to 0) the IORDY sample point capabilities for PIO transfers for device 0.  </nobr></div>
<div style="position: absolute; top: 79509px; left: 195px;"><nobr>IORDY is always enabled for PIO4 and PIO3, and when a PIO2 device indicates IORDY </nobr></div>
<div style="position: absolute; top: 79527px; left: 195px;"><nobr>capabilities. </nobr></div>
<div style="position: absolute; top: 79554px; left: 142px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 79554px; left: 195px;"><nobr>Fast Drive Timing Select 0.  This bit enables (when set to 1) or disables (when cleared to </nobr></div>
<div style="position: absolute; top: 79571px; left: 195px;"><nobr>0) the Fast Drive Timing capabilities for PIO transfers, which enables faster than PIO-0 </nobr></div>
<div style="position: absolute; top: 79589px; left: 195px;"><nobr>timing modes for device 0.</nobr></div>
<div style="position: absolute; top: 79631px; left: 87px;"><nobr>The IORDY Sample Point Enable Select bit  is enabled (set to one) depending on the  current mode, capabilities </nobr></div>
<div style="position: absolute; top: 79649px; left: 87px;"><nobr>of the device, and the device’s capabilities for PIO Mode 2.  This bit is always enabled for IORDY Modes (PIO3 </nobr></div>
<div style="position: absolute; top: 79666px; left: 87px;"><nobr>and greater).  The value of this bit has no effect when Fast Timing Bank Select is Disabled.</nobr></div>
</span></font>

<div style="position: absolute; top: 79771px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="70"><b>Page 70</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 80910px; left: 681px;"><nobr>Page 56</nobr></div>
<div style="position: absolute; top: 79847px; left: 87px;"><nobr>The DMA Timing Enable Only Select bit is enabled (set to one) if and only if the device’s PIO capability is much </nobr></div>
<div style="position: absolute; top: 79865px; left: 87px;"><nobr>slower than it’s DMA capability.</nobr></div>
<div style="position: absolute; top: 79882px; left: 87px;"><nobr>The Pre-fetch and Posting Enable Select bit  is enabled (set to one) if and only if the device is a fixed disk and </nobr></div>
<div style="position: absolute; top: 79898px; left: 87px;"><nobr>the device supports Mode 2 or greater.</nobr></div>
<div style="position: absolute; top: 79936px; left: 87px;"><nobr><b>B.3.2 SATR — Device 1 ATA Timing Register</b></nobr></div>
<div style="position: absolute; top: 79963px; left: 87px;"><nobr>Address Offset: Primary and Secondary Channel—PCI Config. Offset 44h </nobr></div>
<div style="position: absolute; top: 79988px; left: 87px;"><nobr>Default Value: 00h</nobr></div>
<div style="position: absolute; top: 80014px; left: 87px;"><nobr>Attribute: Read/Write</nobr></div>
<div style="position: absolute; top: 80041px; left: 87px;"><nobr>This register controls timing of the PIO and DMA capability for device 1 on the ATA function, see Table 27.</nobr></div>
<div style="position: absolute; top: 80076px; left: 314px;"><nobr><b>Table 27 – Device 1 ATA Timing Register</b></nobr></div>
<div style="position: absolute; top: 80110px; left: 164px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 80110px; left: 449px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 80140px; left: 163px;"><nobr>6-7 Secondary Device 1 IORDY Sample Mode (R/W). Sets the setup time before IORDY </nobr></div>
<div style="position: absolute; top: 80157px; left: 201px;"><nobr>is sampled.  The bit mappings are:</nobr></div>
<div style="position: absolute; top: 80183px; left: 276px;"><nobr>00: PIO-0</nobr></div>
<div style="position: absolute; top: 80201px; left: 276px;"><nobr>01: PIO-2, SW-2</nobr></div>
<div style="position: absolute; top: 80218px; left: 276px;"><nobr>10: PIO-3, PIO-4, MW-1, MW-2</nobr></div>
<div style="position: absolute; top: 80235px; left: 276px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 80263px; left: 163px;"><nobr>4-5 Secondary Device 1 Recovery Mode (R/W). Sets the hold time after IORDY is </nobr></div>
<div style="position: absolute; top: 80280px; left: 201px;"><nobr>sampled.  The bit mappings are:</nobr></div>
<div style="position: absolute; top: 80306px; left: 276px;"><nobr>00: PIO-0, PIO-2, SW-2</nobr></div>
<div style="position: absolute; top: 80324px; left: 276px;"><nobr>01: PIO-3, MW-1</nobr></div>
<div style="position: absolute; top: 80341px; left: 276px;"><nobr>10: Reserved</nobr></div>
<div style="position: absolute; top: 80357px; left: 276px;"><nobr>11: PIO-4, MW-2</nobr></div>
<div style="position: absolute; top: 80386px; left: 163px;"><nobr>2-3 Primary Device 1 IORDY Sample Mode (R/W). Sets the setup time before IORDY is </nobr></div>
<div style="position: absolute; top: 80402px; left: 201px;"><nobr>sampled.  The bit mappings are:</nobr></div>
<div style="position: absolute; top: 80428px; left: 276px;"><nobr>00: PIO-0</nobr></div>
<div style="position: absolute; top: 80446px; left: 276px;"><nobr>01: PIO-2, SW-2</nobr></div>
<div style="position: absolute; top: 80463px; left: 276px;"><nobr>10: PIO-3, PIO-4, MW-1, MW-2</nobr></div>
<div style="position: absolute; top: 80480px; left: 276px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 80508px; left: 163px;"><nobr>0-7 Primary Device 1 Recovery Mode (R/W). Sets the hold time after IORDY is sampled.  </nobr></div>
<div style="position: absolute; top: 80525px; left: 201px;"><nobr>The bit mappings are:</nobr></div>
<div style="position: absolute; top: 80551px; left: 276px;"><nobr>00: PIO-0, PIO-2, SW-2</nobr></div>
<div style="position: absolute; top: 80569px; left: 276px;"><nobr>01: PIO-3, MW-1</nobr></div>
<div style="position: absolute; top: 80586px; left: 276px;"><nobr>10: Reserved</nobr></div>
<div style="position: absolute; top: 80603px; left: 276px;"><nobr>11: PIO-4, MW-2</nobr></div>
<div style="position: absolute; top: 80645px; left: 87px;"><nobr>The ATA Decode Enable field determines whether the cable or not is enabled:</nobr></div>
<div style="position: absolute; top: 80662px; left: 87px;"><nobr>Primary Controller:  ICH Function 1 PCI Config. Offset 40h, bit 15</nobr></div>
<div style="position: absolute; top: 80680px; left: 87px;"><nobr>Secondary Controller:  ICH Function 1 PCI Config. Offset 42h, bit 15</nobr></div>
<div style="position: absolute; top: 80697px; left: 87px;"><nobr>The IORDY Sample Mode and Recovery Mode fields select the current device timing cycle times. </nobr></div>
<div style="position: absolute; top: 80714px; left: 87px;"><nobr>The Device 1 ATA Timing Register bit is:</nobr></div>
<div style="position: absolute; top: 80741px; left: 87px;"><nobr>This bit is disabled by default.  This bit needs to be enabled to take advantage of the independent device 1 </nobr></div>
<div style="position: absolute; top: 80758px; left: 87px;"><nobr>timing register when a device 1 is attached to the cable.  When this field is disabled, the Device 1 ATA Timing </nobr></div>
<div style="position: absolute; top: 80775px; left: 87px;"><nobr>Register is disabled</nobr></div>
<div style="position: absolute; top: 80797px; left: 87px;"><nobr><b>B.4 Ultra DMA Configuration of Timing and Control Registers</b></nobr></div>
<div style="position: absolute; top: 80823px; left: 87px;"><nobr>The following register bit layout maps define the specific ATA controller device timing and mode configuration registers </nobr></div>
<div style="position: absolute; top: 80840px; left: 87px;"><nobr>for Ultra DMA operation on all devices.  These registers are programmed in systems that contain devices that implement </nobr></div>
<div style="position: absolute; top: 80858px; left: 87px;"><nobr>the Ultra DMA Protocol.  These registers allow Ultra DMA to be used when DMA operation is initiated by the host </nobr></div>
<div style="position: absolute; top: 80875px; left: 87px;"><nobr>software.</nobr></div>
</span></font>

<div style="position: absolute; top: 80959px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="71"><b>Page 71</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 81013px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 82098px; left: 87px;"><nobr>Page 57</nobr></div>
<div style="position: absolute; top: 81035px; left: 87px;"><nobr><b>B.4.1 UDMAC — UDMA Control Register</b></nobr></div>
<div style="position: absolute; top: 81062px; left: 87px;"><nobr>Address Offset: Primary and Secondary Channel—PCI Config. Offset 48h </nobr></div>
<div style="position: absolute; top: 81088px; left: 87px;"><nobr>Default Value: 00h</nobr></div>
<div style="position: absolute; top: 81113px; left: 87px;"><nobr>Attribute: Read/Write</nobr></div>
<div style="position: absolute; top: 81140px; left: 87px;"><nobr>This register controls enable for UDMA on each device.  When a bit is turned on, the associated device will run </nobr></div>
<div style="position: absolute; top: 81157px; left: 87px;"><nobr>in UDMA when DMA transfers are invoked, and when cleared the device will run in DMA, see Table 28.</nobr></div>
<div style="position: absolute; top: 81192px; left: 339px;"><nobr><b>Table 28 – UDMA Control Register</b></nobr></div>
<div style="position: absolute; top: 81244px; left: 236px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 81244px; left: 451px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 81273px; left: 235px;"><nobr>4-7</nobr></div>
<div style="position: absolute; top: 81273px; left: 287px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 81301px; left: 242px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 81301px; left: 287px;"><nobr>Secondary Drive one (Device 1) Ultra DMA Mode Enable.</nobr></div>
<div style="position: absolute; top: 81328px; left: 242px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 81328px; left: 287px;"><nobr>Secondary Drive zero (Device 0) Ultra DMA Mode Enable.</nobr></div>
<div style="position: absolute; top: 81355px; left: 242px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 81355px; left: 287px;"><nobr>Primary Drive one (Device 1) Ultra DMA Mode Enable.</nobr></div>
<div style="position: absolute; top: 81383px; left: 242px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 81383px; left: 287px;"><nobr>Primary Drive zero (Device 0) Ultra DMA Mode Enable.</nobr></div>
<div style="position: absolute; top: 81425px; left: 87px;"><nobr>The Ultra DMA Enable bit specifies the current Ultra DMA enabled status.  Ultra DMA mode is disabled by </nobr></div>
<div style="position: absolute; top: 81443px; left: 87px;"><nobr>default and shall be enabled in order to take advantage of the Ultra DMA timings.  When this field is disabled, </nobr></div>
<div style="position: absolute; top: 81460px; left: 87px;"><nobr>the Ultra DMA Timing Register is disabled.</nobr></div>
<div style="position: absolute; top: 81481px; left: 87px;"><nobr><b>B.4.2 UDMATIM — UDMA Timing Register</b></nobr></div>
<div style="position: absolute; top: 81508px; left: 87px;"><nobr>Address Offset: Primary and Secondary Channel—PCI Config. Offset 4A-4Bh </nobr></div>
<div style="position: absolute; top: 81534px; left: 87px;"><nobr>Default Value: 00h</nobr></div>
<div style="position: absolute; top: 81560px; left: 87px;"><nobr>Attribute: Read/Write</nobr></div>
<div style="position: absolute; top: 81587px; left: 87px;"><nobr>This register controls enable for UDMA on each device.  When a bit is turned on, the associated device will run </nobr></div>
<div style="position: absolute; top: 81604px; left: 87px;"><nobr>in UDMA when DMA transfers are invoked, and when cleared the device will run in DMA, see Table 29.</nobr></div>
</span></font>

<div style="position: absolute; top: 82147px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="72"><b>Page 72</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 83286px; left: 681px;"><nobr>Page 58</nobr></div>
<div style="position: absolute; top: 82223px; left: 340px;"><nobr><b>Table 29 – UDMA Timing Register</b></nobr></div>
<div style="position: absolute; top: 82254px; left: 164px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 82254px; left: 455px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 82278px; left: 155px;"><nobr>14-15</nobr></div>
<div style="position: absolute; top: 82278px; left: 213px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 82299px; left: 155px;"><nobr>12-13</nobr></div>
<div style="position: absolute; top: 82299px; left: 213px;"><nobr>Secondary Drive one (Device 1) Ultra DMA Cycle Time (SCT1):</nobr></div>
<div style="position: absolute; top: 82340px; left: 213px;"><nobr>SCB1-66 = 0  (and)</nobr></div>
<div style="position: absolute; top: 82340px; left: 375px;"><nobr>SCB1-66 = 1 (and)</nobr></div>
<div style="position: absolute; top: 82340px; left: 525px;"><nobr>SCB1-66 = X (and)</nobr></div>
<div style="position: absolute; top: 82360px; left: 213px;"><nobr>SCB1-100 = 0</nobr></div>
<div style="position: absolute; top: 82360px; left: 375px;"><nobr>SCB1-100 = 0</nobr></div>
<div style="position: absolute; top: 82360px; left: 525px;"><nobr>SCB1-100 = 1</nobr></div>
<div style="position: absolute; top: 82380px; left: 213px;"><nobr>(33MHz base clock)</nobr></div>
<div style="position: absolute; top: 82380px; left: 375px;"><nobr>(66MHz base clock)</nobr></div>
<div style="position: absolute; top: 82380px; left: 525px;"><nobr>(100MHz base clock)</nobr></div>
<div style="position: absolute; top: 82400px; left: 213px;"><nobr>00: UDMA mode 0</nobr></div>
<div style="position: absolute; top: 82400px; left: 375px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 82400px; left: 525px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 82421px; left: 213px;"><nobr>01: UDMA mode 1</nobr></div>
<div style="position: absolute; top: 82421px; left: 375px;"><nobr>01: UDMA mode 3</nobr></div>
<div style="position: absolute; top: 82421px; left: 525px;"><nobr>01: UDMA mode 5</nobr></div>
<div style="position: absolute; top: 82441px; left: 213px;"><nobr>10: UDMA mode 2</nobr></div>
<div style="position: absolute; top: 82441px; left: 375px;"><nobr>10: UDMA mode 4</nobr></div>
<div style="position: absolute; top: 82441px; left: 525px;"><nobr>10: Reserved</nobr></div>
<div style="position: absolute; top: 82461px; left: 213px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82461px; left: 375px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82461px; left: 525px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82503px; left: 155px;"><nobr>10-11</nobr></div>
<div style="position: absolute; top: 82503px; left: 213px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 82524px; left: 163px;"><nobr>8-9</nobr></div>
<div style="position: absolute; top: 82524px; left: 213px;"><nobr>Secondary Drive zero (Device 0) Ultra DMA Cycle Time (SCT0):</nobr></div>
<div style="position: absolute; top: 82565px; left: 213px;"><nobr>SCB0-66 = 0  (and)</nobr></div>
<div style="position: absolute; top: 82565px; left: 375px;"><nobr>SCB0-66 = 1 (and)</nobr></div>
<div style="position: absolute; top: 82565px; left: 525px;"><nobr>SCB0-66 = X (and)</nobr></div>
<div style="position: absolute; top: 82585px; left: 213px;"><nobr>SCB0-100 = 0</nobr></div>
<div style="position: absolute; top: 82585px; left: 375px;"><nobr>SCB0-100 = 0</nobr></div>
<div style="position: absolute; top: 82585px; left: 525px;"><nobr>SCB0-100 = 1</nobr></div>
<div style="position: absolute; top: 82605px; left: 213px;"><nobr>(33MHz base clock)</nobr></div>
<div style="position: absolute; top: 82605px; left: 375px;"><nobr>(66MHz base clock)</nobr></div>
<div style="position: absolute; top: 82605px; left: 525px;"><nobr>(100MHz base clock)</nobr></div>
<div style="position: absolute; top: 82625px; left: 213px;"><nobr>00: UDMA mode 0</nobr></div>
<div style="position: absolute; top: 82625px; left: 375px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 82625px; left: 525px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 82646px; left: 213px;"><nobr>01: UDMA mode 1</nobr></div>
<div style="position: absolute; top: 82646px; left: 375px;"><nobr>01: UDMA mode 3</nobr></div>
<div style="position: absolute; top: 82646px; left: 525px;"><nobr>01: UDMA mode 5</nobr></div>
<div style="position: absolute; top: 82666px; left: 213px;"><nobr>10: UDMA mode 2</nobr></div>
<div style="position: absolute; top: 82666px; left: 375px;"><nobr>10: UDMA mode 4</nobr></div>
<div style="position: absolute; top: 82666px; left: 525px;"><nobr>10: Reserved</nobr></div>
<div style="position: absolute; top: 82686px; left: 213px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82686px; left: 375px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82686px; left: 525px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82728px; left: 163px;"><nobr>6-7</nobr></div>
<div style="position: absolute; top: 82728px; left: 213px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 82749px; left: 163px;"><nobr>4-5</nobr></div>
<div style="position: absolute; top: 82749px; left: 213px;"><nobr>Primary Drive one (Device 1) Ultra DMA Cycle Time (PCT1):</nobr></div>
<div style="position: absolute; top: 82789px; left: 213px;"><nobr>PCB1-66 = 0  (and)</nobr></div>
<div style="position: absolute; top: 82789px; left: 375px;"><nobr>PCB1-66 = 1 (and)</nobr></div>
<div style="position: absolute; top: 82789px; left: 525px;"><nobr>PCB1-66 = X (and)</nobr></div>
<div style="position: absolute; top: 82809px; left: 213px;"><nobr>PCB1-100 = 0</nobr></div>
<div style="position: absolute; top: 82809px; left: 375px;"><nobr>PCB1-100 = 0</nobr></div>
<div style="position: absolute; top: 82809px; left: 525px;"><nobr>PCB1-100 = 1</nobr></div>
<div style="position: absolute; top: 82829px; left: 213px;"><nobr>(33MHz base clock)</nobr></div>
<div style="position: absolute; top: 82829px; left: 375px;"><nobr>(66MHz base clock)</nobr></div>
<div style="position: absolute; top: 82829px; left: 525px;"><nobr>(100MHz base clock)</nobr></div>
<div style="position: absolute; top: 82849px; left: 213px;"><nobr>00: UDMA mode 0</nobr></div>
<div style="position: absolute; top: 82849px; left: 375px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 82849px; left: 525px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 82870px; left: 213px;"><nobr>01: UDMA mode 1</nobr></div>
<div style="position: absolute; top: 82870px; left: 375px;"><nobr>01: UDMA mode 3</nobr></div>
<div style="position: absolute; top: 82870px; left: 525px;"><nobr>01: UDMA mode 5</nobr></div>
<div style="position: absolute; top: 82890px; left: 213px;"><nobr>10: UDMA mode 2</nobr></div>
<div style="position: absolute; top: 82890px; left: 375px;"><nobr>10: UDMA mode 4</nobr></div>
<div style="position: absolute; top: 82890px; left: 525px;"><nobr>10: Reserved</nobr></div>
<div style="position: absolute; top: 82910px; left: 213px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82910px; left: 375px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82910px; left: 525px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 82952px; left: 163px;"><nobr>2-3</nobr></div>
<div style="position: absolute; top: 82952px; left: 213px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 82973px; left: 163px;"><nobr>0-1</nobr></div>
<div style="position: absolute; top: 82973px; left: 213px;"><nobr>Primary Drive zero (Device 0) Ultra DMA Cycle Time (PCT0):</nobr></div>
<div style="position: absolute; top: 83014px; left: 213px;"><nobr>PCB0-66 = 0  (and)</nobr></div>
<div style="position: absolute; top: 83014px; left: 375px;"><nobr>PCB0-66 = 1 (and)</nobr></div>
<div style="position: absolute; top: 83014px; left: 525px;"><nobr>PCB0-66 = X (and)</nobr></div>
<div style="position: absolute; top: 83034px; left: 213px;"><nobr>PCB0-100 = 0</nobr></div>
<div style="position: absolute; top: 83034px; left: 375px;"><nobr>PCB0-100 = 0</nobr></div>
<div style="position: absolute; top: 83034px; left: 525px;"><nobr>PCB0-100 = 1</nobr></div>
<div style="position: absolute; top: 83054px; left: 213px;"><nobr>(33MHz base clock)</nobr></div>
<div style="position: absolute; top: 83054px; left: 375px;"><nobr>(66MHz base clock)</nobr></div>
<div style="position: absolute; top: 83054px; left: 525px;"><nobr>(100MHz base clock)</nobr></div>
<div style="position: absolute; top: 83074px; left: 213px;"><nobr>00: UDMA mode 0</nobr></div>
<div style="position: absolute; top: 83074px; left: 375px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 83074px; left: 525px;"><nobr>00: Reserved</nobr></div>
<div style="position: absolute; top: 83095px; left: 213px;"><nobr>01: UDMA mode 1</nobr></div>
<div style="position: absolute; top: 83095px; left: 375px;"><nobr>01: UDMA mode 3</nobr></div>
<div style="position: absolute; top: 83095px; left: 525px;"><nobr>01: UDMA mode 5</nobr></div>
<div style="position: absolute; top: 83115px; left: 213px;"><nobr>10: UDMA mode 2</nobr></div>
<div style="position: absolute; top: 83115px; left: 375px;"><nobr>10: UDMA mode 4</nobr></div>
<div style="position: absolute; top: 83115px; left: 525px;"><nobr>10: Reserved</nobr></div>
<div style="position: absolute; top: 83135px; left: 213px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 83135px; left: 375px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 83135px; left: 525px;"><nobr>11: Reserved</nobr></div>
<div style="position: absolute; top: 83196px; left: 87px;"><nobr>The  Ultra  DMA  Cycle  Time  Field  specifies  the  current  Ultra  DMA  timing  mode.  This  field  only  applies if the </nobr></div>
<div style="position: absolute; top: 83213px; left: 87px;"><nobr>corresponding Ultra DMA Enable field is set.</nobr></div>
<div style="position: absolute; top: 83234px; left: 87px;"><nobr><b>B.4.3 ATAIOCFG — ATA I/O Configuration Control Register</b></nobr></div>
<div style="position: absolute; top: 83261px; left: 87px;"><nobr>Address Offset: Primary and Secondary Channel—PCI Config. Offset 54-55h </nobr></div>
</span></font>

<div style="position: absolute; top: 83335px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="73"><b>Page 73</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 83389px; left: 696px;"><nobr>T13/1510D revision 1</nobr></div>
<div style="position: absolute; top: 84474px; left: 87px;"><nobr>Page 59</nobr></div>
<div style="position: absolute; top: 83411px; left: 87px;"><nobr>Default Value: 00h</nobr></div>
<div style="position: absolute; top: 83438px; left: 87px;"><nobr>Attribute: Read/Write</nobr></div>
<div style="position: absolute; top: 83464px; left: 87px;"><nobr>This register control clock selection and cable reporting for UDMA on each device.  Included are tri-state control </nobr></div>
<div style="position: absolute; top: 83480px; left: 87px;"><nobr>and miscellaneous PIO functionality enabling.</nobr></div>
<div style="position: absolute; top: 83516px; left: 339px;"><nobr><b>Table 30 – UDMA Control Register</b></nobr></div>
<div style="position: absolute; top: 83547px; left: 114px;"><nobr>Bit</nobr></div>
<div style="position: absolute; top: 83547px; left: 446px;"><nobr>Description</nobr></div>
<div style="position: absolute; top: 83570px; left: 106px;"><nobr>20-32 Reserved</nobr></div>
<div style="position: absolute; top: 83592px; left: 106px;"><nobr>18-19 Secondary ATA Signal Mode (SEC_SIG_MODE).  These bits are used to control mode of the </nobr></div>
<div style="position: absolute; top: 83610px; left: 159px;"><nobr>Secondary ATA signal pins for mobile swap bay support in mobile implementations.  These bits </nobr></div>
<div style="position: absolute; top: 83627px; left: 159px;"><nobr>should always be set to 00b for desktop implementations.</nobr></div>
<div style="position: absolute; top: 83647px; left: 181px;"><nobr>00 = Normal (Enabled)</nobr></div>
<div style="position: absolute; top: 83667px; left: 181px;"><nobr>01 = Tri-state (Disabled)</nobr></div>
<div style="position: absolute; top: 83687px; left: 181px;"><nobr>10 = Drive Low (Disabled)</nobr></div>
<div style="position: absolute; top: 83708px; left: 181px;"><nobr>11 = Reserved</nobr></div>
<div style="position: absolute; top: 83729px; left: 106px;"><nobr>16-17 Primary ATA Signal Mode (PRIM_SIG_MODE).  These bits are used to control mode of the </nobr></div>
<div style="position: absolute; top: 83746px; left: 159px;"><nobr>Primary ATA signal pins for mobile swap bay support in mobile implementations.  These bits </nobr></div>
<div style="position: absolute; top: 83764px; left: 159px;"><nobr>should always be set to 00b for desktop implementations.</nobr></div>
<div style="position: absolute; top: 83783px; left: 181px;"><nobr>00 = Normal (Enabled)</nobr></div>
<div style="position: absolute; top: 83803px; left: 181px;"><nobr>01 = Tri-state (Disabled)</nobr></div>
<div style="position: absolute; top: 83824px; left: 181px;"><nobr>10 = Drive Low (Disabled)</nobr></div>
<div style="position: absolute; top: 83844px; left: 181px;"><nobr>11 = Reserved</nobr></div>
<div style="position: absolute; top: 83865px; left: 116px;"><nobr>15</nobr></div>
<div style="position: absolute; top: 83865px; left: 159px;"><nobr>Secondary Drive 1, 100MHz Base Clock (SCB1-100) .  Selects the 100MHz clock for UDMA on </nobr></div>
<div style="position: absolute; top: 83883px; left: 159px;"><nobr>the secondary device 1 when set to 1.  Selects the 66/33MHz clock for UDMA when cleared to 0.</nobr></div>
<div style="position: absolute; top: 83905px; left: 116px;"><nobr>14</nobr></div>
<div style="position: absolute; top: 83905px; left: 159px;"><nobr>Secondary Drive 0, 100MHz Base Clock (SCB0-100) .  Selects the 100MHz clock for UDMA on </nobr></div>
<div style="position: absolute; top: 83921px; left: 159px;"><nobr>the secondary device 0 when set to 1.  Selects the 66/33MHz clock for UDMA when cleared to 0.</nobr></div>
<div style="position: absolute; top: 83943px; left: 116px;"><nobr>13</nobr></div>
<div style="position: absolute; top: 83943px; left: 159px;"><nobr>Primary Drive 1, 100MHz Base Clock (PCB1-100) .  Selects the 100MHz clock for UDMA on the </nobr></div>
<div style="position: absolute; top: 83960px; left: 159px;"><nobr>primary device 1 when set to 1.  Selects the 66/33MHz clock for UDMA when cleared to 0.</nobr></div>
<div style="position: absolute; top: 83981px; left: 116px;"><nobr>12</nobr></div>
<div style="position: absolute; top: 83981px; left: 159px;"><nobr>Primary Drive 0, 100MHz Base Clock (PCB0-100) .  Selects the 100MHz clock for UDMA on the </nobr></div>
<div style="position: absolute; top: 83999px; left: 159px;"><nobr>primary device 0 when set to 1.  Selects the 66/33MHz clock for UDMA when cleared to 0.</nobr></div>
<div style="position: absolute; top: 84019px; left: 116px;"><nobr>11</nobr></div>
<div style="position: absolute; top: 84019px; left: 159px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 84041px; left: 116px;"><nobr>10</nobr></div>
<div style="position: absolute; top: 84041px; left: 159px;"><nobr>Vendor Specific.  (May be set to either a one or zero based on vendor-specific recommendation).</nobr></div>
<div style="position: absolute; top: 84062px; left: 114px;"><nobr>8-9</nobr></div>
<div style="position: absolute; top: 84062px; left: 159px;"><nobr>Reserved</nobr></div>
<div style="position: absolute; top: 84083px; left: 119px;"><nobr>7</nobr></div>
<div style="position: absolute; top: 84083px; left: 159px;"><nobr>Secondary Drive one Cable Report (SCR1).  BIOS indication flag for reporting the cable type to </nobr></div>
<div style="position: absolute; top: 84101px; left: 159px;"><nobr>host software.  When set to 1, an 80-conductor cable is present for the device.  When cleared to </nobr></div>
<div style="position: absolute; top: 84118px; left: 159px;"><nobr>0, a 40-conductor cable is present for the device.</nobr></div>
<div style="position: absolute; top: 84140px; left: 119px;"><nobr>6</nobr></div>
<div style="position: absolute; top: 84140px; left: 159px;"><nobr>Secondary Drive zero Cable Report (SCR1).  BIOS indication flag for reporting the cable type to </nobr></div>
<div style="position: absolute; top: 84158px; left: 159px;"><nobr>host software.  When set to 1, an 80-conductor cable is present for the device.  When cleared to </nobr></div>
<div style="position: absolute; top: 84175px; left: 159px;"><nobr>0, a 40-conductor cable is present for the device.</nobr></div>
<div style="position: absolute; top: 84196px; left: 119px;"><nobr>5</nobr></div>
<div style="position: absolute; top: 84196px; left: 159px;"><nobr>Primary Drive one Cable Report (SCR1).  BIOS indication flag for reporting the cable type to host </nobr></div>
<div style="position: absolute; top: 84213px; left: 159px;"><nobr>software.  When set to 1, an 80-conductor cable is present for the device.  When cleared to 0, a </nobr></div>
<div style="position: absolute; top: 84231px; left: 159px;"><nobr>40-conductor cable is present for the device.</nobr></div>
<div style="position: absolute; top: 84251px; left: 119px;"><nobr>4</nobr></div>
<div style="position: absolute; top: 84251px; left: 159px;"><nobr>Primary Drive zero Cable Report (SCR1).  BIOS indication flag for reporting the cable type to </nobr></div>
<div style="position: absolute; top: 84269px; left: 159px;"><nobr>host software.  When set to 1, an 80-conductor cable is present for the device.  When cleared to </nobr></div>
<div style="position: absolute; top: 84286px; left: 159px;"><nobr>0, a 40-conductor cable is present for the device.</nobr></div>
<div style="position: absolute; top: 84307px; left: 119px;"><nobr>3</nobr></div>
<div style="position: absolute; top: 84307px; left: 159px;"><nobr>Secondary Drive 1, 66MHz Base Clock (SCB1-66) .  Selects the 66MHz clock for UDMA on the </nobr></div>
<div style="position: absolute; top: 84325px; left: 159px;"><nobr>secondary device 1 when set to 1.  Selects the 33MHz clock for UDMA when cleared to 0.</nobr></div>
<div style="position: absolute; top: 84346px; left: 119px;"><nobr>2</nobr></div>
<div style="position: absolute; top: 84346px; left: 159px;"><nobr>Secondary Drive 0, 66MHz Base Clock (SCB0-66) .  Selects the 66MHz clock for UDMA on the </nobr></div>
<div style="position: absolute; top: 84364px; left: 159px;"><nobr>secondary device 0 when set to 1.  Selects the 33MHz clock for UDMA when cleared to 0.</nobr></div>
<div style="position: absolute; top: 84385px; left: 119px;"><nobr>1</nobr></div>
<div style="position: absolute; top: 84385px; left: 159px;"><nobr>Primary Drive 1, 66MHz Base Clock (PCB1-66) .  Selects the 66MHz clock for UDMA on the </nobr></div>
<div style="position: absolute; top: 84402px; left: 159px;"><nobr>primary device 1 when set to 1.  Selects the 33MHz clock for U6DMA when cleared to 0.</nobr></div>
<div style="position: absolute; top: 84423px; left: 119px;"><nobr>0</nobr></div>
<div style="position: absolute; top: 84423px; left: 159px;"><nobr>Primary Drive 0, 66MHz Base Clock (PCB0-66) .  Selects the 66MHz clock for UDMA on the </nobr></div>
<div style="position: absolute; top: 84441px; left: 159px;"><nobr>primary device 0 when set to 1.  Selects the 33MHz clock for UDMA when cleared to 0.</nobr></div>
</span></font>

<div style="position: absolute; top: 84523px; left: 0pt;"><hr><table border="0" width="100%"><tbody><tr><td align="right" bgcolor="#eeeeee"><font face="arial,sans-serif"><a name="74"><b>Page 74</b></a></font></td></tr></tbody></table></div><font face="Times" size="3"><span style="font-size: 12px; font-family: Times;">
<div style="position: absolute; top: 85662px; left: 681px;"><nobr>Page 60</nobr></div>
<div style="position: absolute; top: 84617px; left: 87px;"><nobr>Base Clock bit(s) specify if the UDMATIM register indicates Ultra DMA 100, Ultra DMA 66 or Ultra DMA/33 </nobr></div>
<div style="position: absolute; top: 84634px; left: 87px;"><nobr>timings. </nobr></div>
<div style="position: absolute; top: 84659px; left: 87px;"><nobr>Cable Reporting bit(s) specifies the presence of an 80-conductor cable (set to “1”) or 40-conductor cable </nobr></div>
<div style="position: absolute; top: 84677px; left: 87px;"><nobr>(cleared to “0”).  This information is to be filled in by system BIOS, and interpreted by both BIOS and host </nobr></div>
<div style="position: absolute; top: 84694px; left: 87px;"><nobr>software.  No drive is to be programmed to Ultra DMA modes 3, 4 or 5 unless an 80-conductor cable is present.  </nobr></div>
<div style="position: absolute; top: 84711px; left: 87px;"><nobr>In the presence of a 40-conductor cable, all devices shall be limited to Ultra DMA mode 2 or less.</nobr></div>
</span></font>

</body></html>